2023-01-31 22:11:45 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'json', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1234, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': True, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://g3020:14237', 'distributed_port': 14237, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': True, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 2, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid_c4_small/C4_small', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 8, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 10000, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [4], 'lr': [2e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': '/gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'finetune_from_opt': False, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 250, 'save_interval_updates': 250, 'keep_interval_updates': 1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': True, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': 10000, 'checkpoint_suffix': '-rank-0', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': True, 's3_upload_path': None, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': 100}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'transformer_lm_gpt3_xl', 'activation_fn': 'relu', 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.0, 'relu_dropout': 0.0, 'decoder_embed_dim': 2048, 'decoder_output_dim': 2048, 'decoder_input_dim': 2048, 'decoder_ffn_embed_dim': 8192, 'decoder_layers': 24, 'decoder_attention_heads': 32, 'decoder_normalize_before': True, 'no_decoder_final_norm': False, 'adaptive_softmax_cutoff': None, 'adaptive_softmax_dropout': 0.0, 'adaptive_softmax_factor': 4.0, 'no_token_positional_embeddings': False, 'share_decoder_input_output_embed': True, 'character_embeddings': False, 'character_filters': '[(1, 64), (2, 128), (3, 192), (4, 256), (5, 256), (6, 256), (7, 256)]', 'character_embedding_dim': 4, 'char_embedder_highway_layers': 2, 'adaptive_input': False, 'adaptive_input_factor': 4.0, 'adaptive_input_cutoff': None, 'tie_adaptive_weights': False, 'tie_adaptive_proj': False, 'decoder_learned_pos': True, 'layernorm_embedding': False, 'no_scale_embedding': True, 'checkpoint_activations': True, 'offload_activations': False, 'decoder_layerdrop': 0.0, 'decoder_layers_to_keep': None, 'quant_noise_pq': 0.0, 'quant_noise_pq_block_size': 8, 'quant_noise_scalar': 0.0, 'min_params_to_wrap': 100000000, 'alternate_decoder_ffn_embed_dim': 0, 'moe_freq': 2, 'moe_expert_count': 16, 'moe_gating_use_fp32': True, 'moe_initialize_from_opt': True, 'moe_second_expert_policy': 'all', 'moe_normalize_gate_prob_before_dropping': False, 'moe_expert_ffn_dim': None, 'moe_top1_expert': False, 'moe_eval_capacity_token_fraction': -1.0, 'moe_normalize_expert_grad': 'sqrt_world_size', 'use_moe_pad_mask': False, 'record_a2a_perf_stats': False, 'dummy_a2a': False, 'moe_batch_prioritized_routing': False, 'use_stable_embedding': False, 'base_layers': 0, 'base_sublayers': 1, 'base_shuffle': 0, 'add_bos_token': False, 'tokens_per_sample': 2048, 'max_target_positions': None, 'tpu': False, 'memory_efficient_fp16': True, 'fp16': True, 'fp16_no_flatten_grads': False, 'ddp_backend': 'fully_sharded', 'world_size': 16, 'distributed_rank': 0, 'batch_size': 2, 'batch_size_valid': 8}, 'task': {'_name': 'streaming_finetune_language_modeling', 'data': '/gscratch/zlab/sg01/data/c4/', 'vocab_filename': '/gscratch/zlab/sg01/opt/vocab/gpt2-vocab.json', 'merges_filename': '/gscratch/zlab/sg01/opt/vocab/gpt2-merges.txt', 'end_of_document_symbol': '</s>', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'max_source_positions': None, 'max_target_positions': None, 'final_vocab_size': None, 'path_to_clusters_dir': None, 'train_cluster': None, 'random_clusters': False, 'num_clusters': None, 'multicorpus_sampling_alpha': 1.0, 'multicorpus_sampling_maximum': -1.0, 'compute_data_pruning_metrics': None, 'compute_data_pruning_metrics_savedir': None, 'use_data_pruning_metrics': False, 'use_data_pruning_metrics_filepath': None, 'use_data_pruning_metrics_frac_data': 1.0, 'seed': 1234, 'batch_size': 2, 'batch_size_valid': 8, 'data_buffer_size': 10, 'update_freq': [4], 'log_file': None}, 'criterion': {'_name': 'moe_cross_entropy', 'moe_gate_loss_wt': 0.01, 'moe_gate_loss_combine_method': 'sum', 'moe_gate_loss_transform': 'none', 'sentence_avg': False}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.95)', 'adam_eps': 1e-06, 'weight_decay': 0.1, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [2e-05], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 10000.0, 'lr': [2e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'simul_type': None}
2023-01-31 22:13:04 | INFO | fairseq.trainer | Loaded checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 49 @ 0 updates)
2023-01-31 22:13:04 | INFO | fairseq.trainer | loading train data for epoch 1
2023-01-31 22:13:04 | INFO | fairseq.trainer | begin training epoch 1
2023-01-31 22:15:25 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'json', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1234, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': True, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://g3020:11742', 'distributed_port': 11742, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'fully_sharded', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': True, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 2, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid_c4_small/C4_small', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 8, 'max_valid_steps': 100, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 10000, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [4], 'lr': [2e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': '/gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'finetune_from_opt': False, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 250, 'save_interval_updates': 250, 'keep_interval_updates': 1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': True, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': 10000, 'checkpoint_suffix': '-rank-0', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': True, 's3_upload_path': None, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': 100}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'transformer_lm_gpt3_xl', 'activation_fn': 'relu', 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.0, 'relu_dropout': 0.0, 'decoder_embed_dim': 2048, 'decoder_output_dim': 2048, 'decoder_input_dim': 2048, 'decoder_ffn_embed_dim': 8192, 'decoder_layers': 24, 'decoder_attention_heads': 32, 'decoder_normalize_before': True, 'no_decoder_final_norm': False, 'adaptive_softmax_cutoff': None, 'adaptive_softmax_dropout': 0.0, 'adaptive_softmax_factor': 4.0, 'no_token_positional_embeddings': False, 'share_decoder_input_output_embed': True, 'character_embeddings': False, 'character_filters': '[(1, 64), (2, 128), (3, 192), (4, 256), (5, 256), (6, 256), (7, 256)]', 'character_embedding_dim': 4, 'char_embedder_highway_layers': 2, 'adaptive_input': False, 'adaptive_input_factor': 4.0, 'adaptive_input_cutoff': None, 'tie_adaptive_weights': False, 'tie_adaptive_proj': False, 'decoder_learned_pos': True, 'layernorm_embedding': False, 'no_scale_embedding': True, 'checkpoint_activations': True, 'offload_activations': False, 'decoder_layerdrop': 0.0, 'decoder_layers_to_keep': None, 'quant_noise_pq': 0.0, 'quant_noise_pq_block_size': 8, 'quant_noise_scalar': 0.0, 'min_params_to_wrap': 100000000, 'alternate_decoder_ffn_embed_dim': 0, 'moe_freq': 2, 'moe_expert_count': 16, 'moe_gating_use_fp32': True, 'moe_initialize_from_opt': True, 'moe_second_expert_policy': 'all', 'moe_normalize_gate_prob_before_dropping': False, 'moe_expert_ffn_dim': None, 'moe_top1_expert': False, 'moe_eval_capacity_token_fraction': -1.0, 'moe_normalize_expert_grad': 'sqrt_world_size', 'use_moe_pad_mask': False, 'record_a2a_perf_stats': False, 'dummy_a2a': False, 'moe_batch_prioritized_routing': False, 'use_stable_embedding': False, 'base_layers': 0, 'base_sublayers': 1, 'base_shuffle': 0, 'add_bos_token': False, 'tokens_per_sample': 2048, 'max_target_positions': None, 'tpu': False, 'memory_efficient_fp16': True, 'fp16': True, 'fp16_no_flatten_grads': False, 'ddp_backend': 'fully_sharded', 'world_size': 16, 'distributed_rank': 0, 'batch_size': 2, 'batch_size_valid': 8}, 'task': {'_name': 'streaming_finetune_language_modeling', 'data': '/gscratch/zlab/sg01/data/c4/', 'vocab_filename': '/gscratch/zlab/sg01/opt/vocab/gpt2-vocab.json', 'merges_filename': '/gscratch/zlab/sg01/opt/vocab/gpt2-merges.txt', 'end_of_document_symbol': '</s>', 'sample_break_mode': 'none', 'tokens_per_sample': 2048, 'max_source_positions': None, 'max_target_positions': None, 'final_vocab_size': None, 'path_to_clusters_dir': None, 'train_cluster': None, 'random_clusters': False, 'num_clusters': None, 'multicorpus_sampling_alpha': 1.0, 'multicorpus_sampling_maximum': -1.0, 'compute_data_pruning_metrics': None, 'compute_data_pruning_metrics_savedir': None, 'use_data_pruning_metrics': False, 'use_data_pruning_metrics_filepath': None, 'use_data_pruning_metrics_frac_data': 1.0, 'seed': 1234, 'batch_size': 2, 'batch_size_valid': 8, 'data_buffer_size': 10, 'update_freq': [4], 'log_file': None}, 'criterion': {'_name': 'moe_cross_entropy', 'moe_gate_loss_wt': 0.01, 'moe_gate_loss_combine_method': 'sum', 'moe_gate_loss_transform': 'none', 'sentence_avg': False}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.95)', 'adam_eps': 1e-06, 'weight_decay': 0.1, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [2e-05], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 10000.0, 'lr': [2e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'simul_type': None}
2023-01-31 22:15:56 | INFO | fairseq.trainer | Loaded checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 49 @ 0 updates)
2023-01-31 22:15:56 | INFO | fairseq.trainer | loading train data for epoch 1
2023-01-31 22:15:56 | INFO | fairseq.trainer | begin training epoch 1
2023-01-31 22:21:27 | INFO | train_inner | {"epoch": 1, "loss": "4.691", "moe_gate_loss": "29.2132", "overflow_expert1": "17.055", "overflow_expert2": "56.672", "entropy_gating": "0.293", "expert1_balance_top": "60.59", "expert1_balance_bottom": "4.265", "unused_expert1_count": "1.182", "expert2_balance_top": "54.304", "expert2_balance_bottom": "5.644", "unused_expert2_count": "0.683", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.27", "ppl": "19.29", "wps": "15291.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "10", "lr": "1.998e-05", "gnorm": "6.984", "clip": "100", "loss_scale": "0.25", "train_wall": "320", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "346"}
2023-01-31 22:24:18 | INFO | train_inner | {"epoch": 1, "loss": "4.438", "moe_gate_loss": "18.1571", "overflow_expert1": "4.577", "overflow_expert2": "46.855", "entropy_gating": "0.336", "expert1_balance_top": "46.423", "expert1_balance_bottom": "6.899", "unused_expert1_count": "0.898", "expert2_balance_top": "42.975", "expert2_balance_bottom": "8.277", "unused_expert2_count": "0.571", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.176", "ppl": "18.07", "wps": "15287.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "20", "lr": "1.996e-05", "gnorm": "1.596", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "518"}
2023-01-31 22:27:10 | INFO | train_inner | {"epoch": 1, "loss": "4.371", "moe_gate_loss": "16.1676", "overflow_expert1": "1.574", "overflow_expert2": "41.061", "entropy_gating": "0.358", "expert1_balance_top": "41.403", "expert1_balance_bottom": "8.448", "unused_expert1_count": "0.952", "expert2_balance_top": "38.966", "expert2_balance_bottom": "9.778", "unused_expert2_count": "0.615", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.138", "ppl": "17.6", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "30", "lr": "1.994e-05", "gnorm": "1.294", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "689"}
2023-01-31 22:30:01 | INFO | train_inner | {"epoch": 1, "loss": "4.358", "moe_gate_loss": "15.5044", "overflow_expert1": "0.845", "overflow_expert2": "37.648", "entropy_gating": "0.364", "expert1_balance_top": "39.347", "expert1_balance_bottom": "9.797", "unused_expert1_count": "0.957", "expert2_balance_top": "37.652", "expert2_balance_bottom": "11.023", "unused_expert2_count": "0.649", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.135", "ppl": "17.56", "wps": "15284.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "40", "lr": "1.992e-05", "gnorm": "1.141", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "861"}
2023-01-31 22:32:53 | INFO | train_inner | {"epoch": 1, "loss": "4.335", "moe_gate_loss": "15.1845", "overflow_expert1": "0.559", "overflow_expert2": "35.948", "entropy_gating": "0.366", "expert1_balance_top": "38.269", "expert1_balance_bottom": "10.43", "unused_expert1_count": "0.918", "expert2_balance_top": "37.102", "expert2_balance_bottom": "11.489", "unused_expert2_count": "0.638", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.116", "ppl": "17.34", "wps": "15282.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "50", "lr": "1.99e-05", "gnorm": "1.118", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "1032"}
2023-01-31 22:35:44 | INFO | train_inner | {"epoch": 1, "loss": "4.34", "moe_gate_loss": "14.8891", "overflow_expert1": "0.314", "overflow_expert2": "34.207", "entropy_gating": "0.369", "expert1_balance_top": "37.417", "expert1_balance_bottom": "10.959", "unused_expert1_count": "0.892", "expert2_balance_top": "36.547", "expert2_balance_bottom": "12.016", "unused_expert2_count": "0.626", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.125", "ppl": "17.45", "wps": "15274.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "60", "lr": "1.988e-05", "gnorm": "1.084", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "1204"}
2023-01-31 22:38:36 | INFO | train_inner | {"epoch": 1, "loss": "4.381", "moe_gate_loss": "14.666", "overflow_expert1": "0.236", "overflow_expert2": "32.74", "entropy_gating": "0.376", "expert1_balance_top": "36.979", "expert1_balance_bottom": "11.453", "unused_expert1_count": "0.876", "expert2_balance_top": "36.24", "expert2_balance_bottom": "12.485", "unused_expert2_count": "0.626", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.169", "ppl": "17.99", "wps": "15283.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "70", "lr": "1.986e-05", "gnorm": "1.073", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "1376"}
2023-01-31 22:41:27 | INFO | train_inner | {"epoch": 1, "loss": "4.352", "moe_gate_loss": "14.3523", "overflow_expert1": "0.178", "overflow_expert2": "30.27", "entropy_gating": "0.379", "expert1_balance_top": "36.208", "expert1_balance_bottom": "12.171", "unused_expert1_count": "0.85", "expert2_balance_top": "35.249", "expert2_balance_bottom": "13.184", "unused_expert2_count": "0.614", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.145", "ppl": "17.69", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "80", "lr": "1.984e-05", "gnorm": "1.087", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "1547"}
2023-01-31 22:44:19 | INFO | train_inner | {"epoch": 1, "loss": "4.352", "moe_gate_loss": "14.2124", "overflow_expert1": "0.131", "overflow_expert2": "29.316", "entropy_gating": "0.384", "expert1_balance_top": "35.945", "expert1_balance_bottom": "12.655", "unused_expert1_count": "0.843", "expert2_balance_top": "35.064", "expert2_balance_bottom": "13.597", "unused_expert2_count": "0.613", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.147", "ppl": "17.72", "wps": "15286.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "90", "lr": "1.982e-05", "gnorm": "1.092", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "1719"}
2023-01-31 22:47:10 | INFO | train_inner | {"epoch": 1, "loss": "4.317", "moe_gate_loss": "14.0819", "overflow_expert1": "0.118", "overflow_expert2": "28.135", "entropy_gating": "0.386", "expert1_balance_top": "35.441", "expert1_balance_bottom": "13.196", "unused_expert1_count": "0.824", "expert2_balance_top": "34.645", "expert2_balance_bottom": "14.078", "unused_expert2_count": "0.599", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.113", "ppl": "17.31", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "100", "lr": "1.98e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "1890"}
2023-01-31 22:50:02 | INFO | train_inner | {"epoch": 1, "loss": "4.346", "moe_gate_loss": "14.0134", "overflow_expert1": "0.088", "overflow_expert2": "27.741", "entropy_gating": "0.388", "expert1_balance_top": "35.198", "expert1_balance_bottom": "13.461", "unused_expert1_count": "0.81", "expert2_balance_top": "34.576", "expert2_balance_bottom": "14.285", "unused_expert2_count": "0.611", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.144", "ppl": "17.68", "wps": "15290.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "110", "lr": "1.978e-05", "gnorm": "1.111", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "2061"}
2023-01-31 22:52:53 | INFO | train_inner | {"epoch": 1, "loss": "4.343", "moe_gate_loss": "13.9667", "overflow_expert1": "0.098", "overflow_expert2": "27.167", "entropy_gating": "0.389", "expert1_balance_top": "35.053", "expert1_balance_bottom": "13.717", "unused_expert1_count": "0.792", "expert2_balance_top": "34.384", "expert2_balance_bottom": "14.52", "unused_expert2_count": "0.59", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.141", "ppl": "17.65", "wps": "15287.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "120", "lr": "1.976e-05", "gnorm": "1.085", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "2233"}
2023-01-31 22:55:45 | INFO | train_inner | {"epoch": 1, "loss": "4.327", "moe_gate_loss": "13.9183", "overflow_expert1": "0.086", "overflow_expert2": "26.902", "entropy_gating": "0.39", "expert1_balance_top": "34.937", "expert1_balance_bottom": "13.807", "unused_expert1_count": "0.783", "expert2_balance_top": "34.383", "expert2_balance_bottom": "14.581", "unused_expert2_count": "0.584", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.126", "ppl": "17.46", "wps": "15282.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "130", "lr": "1.974e-05", "gnorm": "1.079", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "2404"}
2023-01-31 22:58:36 | INFO | train_inner | {"epoch": 1, "loss": "4.361", "moe_gate_loss": "13.7999", "overflow_expert1": "0.097", "overflow_expert2": "25.633", "entropy_gating": "0.39", "expert1_balance_top": "34.59", "expert1_balance_bottom": "14.039", "unused_expert1_count": "0.79", "expert2_balance_top": "34.047", "expert2_balance_bottom": "14.827", "unused_expert2_count": "0.59", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.162", "ppl": "17.9", "wps": "15284.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "140", "lr": "1.972e-05", "gnorm": "1.105", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "2576"}
2023-01-31 23:01:28 | INFO | train_inner | {"epoch": 1, "loss": "4.331", "moe_gate_loss": "13.7613", "overflow_expert1": "0.085", "overflow_expert2": "25.625", "entropy_gating": "0.392", "expert1_balance_top": "34.624", "expert1_balance_bottom": "14.132", "unused_expert1_count": "0.793", "expert2_balance_top": "34.151", "expert2_balance_bottom": "14.867", "unused_expert2_count": "0.576", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.133", "ppl": "17.54", "wps": "15281", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "150", "lr": "1.97e-05", "gnorm": "1.079", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "2748"}
2023-01-31 23:04:19 | INFO | train_inner | {"epoch": 1, "loss": "4.383", "moe_gate_loss": "13.6939", "overflow_expert1": "0.118", "overflow_expert2": "24.806", "entropy_gating": "0.394", "expert1_balance_top": "34.436", "expert1_balance_bottom": "14.584", "unused_expert1_count": "0.782", "expert2_balance_top": "33.915", "expert2_balance_bottom": "15.18", "unused_expert2_count": "0.573", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.186", "ppl": "18.2", "wps": "15285.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "160", "lr": "1.968e-05", "gnorm": "1.17", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "2919"}
2023-01-31 23:07:11 | INFO | train_inner | {"epoch": 1, "loss": "4.344", "moe_gate_loss": "13.6544", "overflow_expert1": "0.09", "overflow_expert2": "24.554", "entropy_gating": "0.395", "expert1_balance_top": "34.367", "expert1_balance_bottom": "14.747", "unused_expert1_count": "0.778", "expert2_balance_top": "33.904", "expert2_balance_bottom": "15.289", "unused_expert2_count": "0.572", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.147", "ppl": "17.72", "wps": "15291.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "170", "lr": "1.966e-05", "gnorm": "1.116", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "3090"}
2023-01-31 23:10:02 | INFO | train_inner | {"epoch": 1, "loss": "4.339", "moe_gate_loss": "13.5708", "overflow_expert1": "0.068", "overflow_expert2": "23.834", "entropy_gating": "0.395", "expert1_balance_top": "33.951", "expert1_balance_bottom": "15.086", "unused_expert1_count": "0.779", "expert2_balance_top": "33.708", "expert2_balance_bottom": "15.563", "unused_expert2_count": "0.566", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.143", "ppl": "17.67", "wps": "15274.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "180", "lr": "1.964e-05", "gnorm": "1.061", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "3262"}
2023-01-31 23:12:54 | INFO | train_inner | {"epoch": 1, "loss": "4.356", "moe_gate_loss": "13.5676", "overflow_expert1": "0.067", "overflow_expert2": "23.863", "entropy_gating": "0.397", "expert1_balance_top": "33.959", "expert1_balance_bottom": "15.151", "unused_expert1_count": "0.776", "expert2_balance_top": "33.74", "expert2_balance_bottom": "15.574", "unused_expert2_count": "0.564", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.16", "ppl": "17.88", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "190", "lr": "1.962e-05", "gnorm": "1.09", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "3434"}
2023-01-31 23:15:45 | INFO | train_inner | {"epoch": 1, "loss": "4.302", "moe_gate_loss": "13.5853", "overflow_expert1": "0.086", "overflow_expert2": "23.853", "entropy_gating": "0.396", "expert1_balance_top": "34.058", "expert1_balance_bottom": "15.083", "unused_expert1_count": "0.779", "expert2_balance_top": "33.703", "expert2_balance_bottom": "15.569", "unused_expert2_count": "0.567", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.106", "ppl": "17.22", "wps": "15280.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "200", "lr": "1.96e-05", "gnorm": "1.093", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "3605"}
2023-01-31 23:18:37 | INFO | train_inner | {"epoch": 1, "loss": "4.373", "moe_gate_loss": "13.5402", "overflow_expert1": "0.061", "overflow_expert2": "23.531", "entropy_gating": "0.397", "expert1_balance_top": "33.806", "expert1_balance_bottom": "15.26", "unused_expert1_count": "0.762", "expert2_balance_top": "33.605", "expert2_balance_bottom": "15.673", "unused_expert2_count": "0.552", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.178", "ppl": "18.1", "wps": "15275.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "210", "lr": "1.958e-05", "gnorm": "1.088", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "3777"}
2023-01-31 23:21:28 | INFO | train_inner | {"epoch": 1, "loss": "4.321", "moe_gate_loss": "13.5362", "overflow_expert1": "0.067", "overflow_expert2": "23.384", "entropy_gating": "0.397", "expert1_balance_top": "33.789", "expert1_balance_bottom": "15.304", "unused_expert1_count": "0.768", "expert2_balance_top": "33.607", "expert2_balance_bottom": "15.711", "unused_expert2_count": "0.542", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.125", "ppl": "17.45", "wps": "15277.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "220", "lr": "1.956e-05", "gnorm": "1.098", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "3948"}
2023-01-31 23:24:20 | INFO | train_inner | {"epoch": 1, "loss": "4.322", "moe_gate_loss": "13.5241", "overflow_expert1": "0.057", "overflow_expert2": "23.39", "entropy_gating": "0.398", "expert1_balance_top": "33.706", "expert1_balance_bottom": "15.313", "unused_expert1_count": "0.754", "expert2_balance_top": "33.568", "expert2_balance_bottom": "15.69", "unused_expert2_count": "0.549", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.127", "ppl": "17.47", "wps": "15282.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "230", "lr": "1.954e-05", "gnorm": "1.069", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "4120"}
2023-01-31 23:27:11 | INFO | train_inner | {"epoch": 1, "loss": "4.336", "moe_gate_loss": "13.5285", "overflow_expert1": "0.062", "overflow_expert2": "23.37", "entropy_gating": "0.4", "expert1_balance_top": "33.723", "expert1_balance_bottom": "15.343", "unused_expert1_count": "0.747", "expert2_balance_top": "33.571", "expert2_balance_bottom": "15.696", "unused_expert2_count": "0.545", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.14", "ppl": "17.64", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "240", "lr": "1.952e-05", "gnorm": "1.121", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "4291"}
2023-01-31 23:30:03 | INFO | train_inner | {"epoch": 1, "loss": "4.324", "moe_gate_loss": "13.5034", "overflow_expert1": "0.055", "overflow_expert2": "23.052", "entropy_gating": "0.398", "expert1_balance_top": "33.583", "expert1_balance_bottom": "15.425", "unused_expert1_count": "0.737", "expert2_balance_top": "33.5", "expert2_balance_bottom": "15.782", "unused_expert2_count": "0.538", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.129", "ppl": "17.5", "wps": "15287.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "250", "lr": "1.95e-05", "gnorm": "1.062", "clip": "100", "loss_scale": "0.25", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "13.7", "cuda_gb_free": "15", "wall": "4463"}
2023-01-31 23:31:53 | INFO | valid_c4_small/C4_small | {"epoch": 1, "valid_c4_small/C4_small_loss": "4.235", "valid_c4_small/C4_small_moe_gate_loss": "13.0642", "valid_c4_small/C4_small_overflow_expert1": "0.032", "valid_c4_small/C4_small_overflow_expert2": "18.004", "valid_c4_small/C4_small_entropy_gating": "0.433", "valid_c4_small/C4_small_expert1_balance_top": "32.725", "valid_c4_small/C4_small_expert1_balance_bottom": "16.939", "valid_c4_small/C4_small_unused_expert1_count": "0.603", "valid_c4_small/C4_small_expert2_balance_top": "32.817", "valid_c4_small/C4_small_expert2_balance_bottom": "16.75", "valid_c4_small/C4_small_unused_expert2_count": "0.421", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.046", "valid_c4_small/C4_small_ppl": "16.52", "valid_c4_small/C4_small_wps": "51918.2", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "250"}
2023-01-31 23:31:53 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 250 updates
2023-01-31 23:32:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 1 @ 250 updates, score 4.235) (writing took 8.031147401314229 seconds)
2023-01-31 23:34:53 | INFO | train_inner | {"epoch": 1, "loss": "4.345", "moe_gate_loss": "13.507", "overflow_expert1": "0.053", "overflow_expert2": "23.2", "entropy_gating": "0.399", "expert1_balance_top": "33.61", "expert1_balance_bottom": "15.417", "unused_expert1_count": "0.713", "expert2_balance_top": "33.53", "expert2_balance_bottom": "15.753", "unused_expert2_count": "0.547", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.151", "ppl": "17.76", "wps": "9025.9", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "260", "lr": "1.948e-05", "gnorm": "1.068", "clip": "100", "loss_scale": "0.5", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "4753"}
2023-01-31 23:37:45 | INFO | train_inner | {"epoch": 1, "loss": "4.335", "moe_gate_loss": "13.4798", "overflow_expert1": "0.031", "overflow_expert2": "22.894", "entropy_gating": "0.399", "expert1_balance_top": "33.48", "expert1_balance_bottom": "15.498", "unused_expert1_count": "0.714", "expert2_balance_top": "33.436", "expert2_balance_bottom": "15.818", "unused_expert2_count": "0.533", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.141", "ppl": "17.64", "wps": "15282.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "270", "lr": "1.946e-05", "gnorm": "1.063", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "4925"}
2023-01-31 23:40:36 | INFO | train_inner | {"epoch": 1, "loss": "4.315", "moe_gate_loss": "13.5288", "overflow_expert1": "0.087", "overflow_expert2": "23.246", "entropy_gating": "0.399", "expert1_balance_top": "33.701", "expert1_balance_bottom": "15.349", "unused_expert1_count": "0.69", "expert2_balance_top": "33.593", "expert2_balance_bottom": "15.686", "unused_expert2_count": "0.536", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.12", "ppl": "17.39", "wps": "15285.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "280", "lr": "1.944e-05", "gnorm": "1.052", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "5096"}
2023-01-31 23:43:28 | INFO | train_inner | {"epoch": 1, "loss": "4.329", "moe_gate_loss": "13.4429", "overflow_expert1": "0.065", "overflow_expert2": "22.589", "entropy_gating": "0.402", "expert1_balance_top": "33.486", "expert1_balance_bottom": "15.491", "unused_expert1_count": "0.669", "expert2_balance_top": "33.412", "expert2_balance_bottom": "15.788", "unused_expert2_count": "0.528", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.135", "ppl": "17.57", "wps": "15284.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "290", "lr": "1.942e-05", "gnorm": "1.078", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "5268"}
2023-01-31 23:46:19 | INFO | train_inner | {"epoch": 1, "loss": "4.366", "moe_gate_loss": "13.389", "overflow_expert1": "0.074", "overflow_expert2": "22.012", "entropy_gating": "0.4", "expert1_balance_top": "33.479", "expert1_balance_bottom": "15.41", "unused_expert1_count": "0.671", "expert2_balance_top": "33.29", "expert2_balance_bottom": "15.79", "unused_expert2_count": "0.508", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.173", "ppl": "18.04", "wps": "15287.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "300", "lr": "1.94e-05", "gnorm": "1.099", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "5439"}
2023-01-31 23:49:11 | INFO | train_inner | {"epoch": 1, "loss": "4.342", "moe_gate_loss": "13.3559", "overflow_expert1": "0.057", "overflow_expert2": "22.009", "entropy_gating": "0.4", "expert1_balance_top": "33.256", "expert1_balance_bottom": "15.51", "unused_expert1_count": "0.672", "expert2_balance_top": "33.249", "expert2_balance_bottom": "15.783", "unused_expert2_count": "0.516", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.149", "ppl": "17.75", "wps": "15287.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "310", "lr": "1.938e-05", "gnorm": "1.058", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "5611"}
2023-01-31 23:52:02 | INFO | train_inner | {"epoch": 1, "loss": "4.276", "moe_gate_loss": "13.3583", "overflow_expert1": "0.056", "overflow_expert2": "21.946", "entropy_gating": "0.402", "expert1_balance_top": "33.275", "expert1_balance_bottom": "15.477", "unused_expert1_count": "0.666", "expert2_balance_top": "33.217", "expert2_balance_bottom": "15.811", "unused_expert2_count": "0.523", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.083", "ppl": "16.95", "wps": "15286.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "320", "lr": "1.936e-05", "gnorm": "1.056", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "5782"}
2023-01-31 23:54:54 | INFO | train_inner | {"epoch": 1, "loss": "4.334", "moe_gate_loss": "13.3164", "overflow_expert1": "0.041", "overflow_expert2": "21.62", "entropy_gating": "0.402", "expert1_balance_top": "33.015", "expert1_balance_bottom": "15.642", "unused_expert1_count": "0.67", "expert2_balance_top": "33.125", "expert2_balance_bottom": "15.861", "unused_expert2_count": "0.515", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.142", "ppl": "17.65", "wps": "15282.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "330", "lr": "1.934e-05", "gnorm": "1.067", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "5954"}
2023-01-31 23:57:45 | INFO | train_inner | {"epoch": 1, "loss": "4.318", "moe_gate_loss": "13.3308", "overflow_expert1": "0.043", "overflow_expert2": "21.703", "entropy_gating": "0.401", "expert1_balance_top": "33.096", "expert1_balance_bottom": "15.587", "unused_expert1_count": "0.665", "expert2_balance_top": "33.144", "expert2_balance_bottom": "15.856", "unused_expert2_count": "0.52", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.126", "ppl": "17.46", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "340", "lr": "1.932e-05", "gnorm": "1.05", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "6125"}
2023-02-01 00:00:37 | INFO | train_inner | {"epoch": 1, "loss": "4.351", "moe_gate_loss": "13.3392", "overflow_expert1": "0.072", "overflow_expert2": "21.793", "entropy_gating": "0.403", "expert1_balance_top": "33.049", "expert1_balance_bottom": "15.602", "unused_expert1_count": "0.663", "expert2_balance_top": "33.256", "expert2_balance_bottom": "15.778", "unused_expert2_count": "0.515", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.158", "ppl": "17.85", "wps": "15282.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "350", "lr": "1.93e-05", "gnorm": "1.054", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "6297"}
2023-02-01 00:03:29 | INFO | train_inner | {"epoch": 1, "loss": "4.312", "moe_gate_loss": "13.3144", "overflow_expert1": "0.036", "overflow_expert2": "21.591", "entropy_gating": "0.404", "expert1_balance_top": "33.003", "expert1_balance_bottom": "15.634", "unused_expert1_count": "0.652", "expert2_balance_top": "33.098", "expert2_balance_bottom": "15.887", "unused_expert2_count": "0.514", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.12", "ppl": "17.38", "wps": "15277.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "360", "lr": "1.928e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "6468"}
2023-02-01 00:06:20 | INFO | train_inner | {"epoch": 1, "loss": "4.31", "moe_gate_loss": "13.3318", "overflow_expert1": "0.048", "overflow_expert2": "21.721", "entropy_gating": "0.404", "expert1_balance_top": "33.107", "expert1_balance_bottom": "15.589", "unused_expert1_count": "0.653", "expert2_balance_top": "33.211", "expert2_balance_bottom": "15.858", "unused_expert2_count": "0.514", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.118", "ppl": "17.37", "wps": "15282.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "370", "lr": "1.926e-05", "gnorm": "1.096", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "6640"}
2023-02-01 00:09:12 | INFO | train_inner | {"epoch": 1, "loss": "4.329", "moe_gate_loss": "13.306", "overflow_expert1": "0.029", "overflow_expert2": "21.591", "entropy_gating": "0.403", "expert1_balance_top": "32.981", "expert1_balance_bottom": "15.674", "unused_expert1_count": "0.652", "expert2_balance_top": "33.14", "expert2_balance_bottom": "15.894", "unused_expert2_count": "0.511", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.137", "ppl": "17.6", "wps": "15281.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "380", "lr": "1.924e-05", "gnorm": "1.064", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "6812"}
2023-02-01 00:12:03 | INFO | train_inner | {"epoch": 1, "loss": "4.274", "moe_gate_loss": "13.3192", "overflow_expert1": "0.046", "overflow_expert2": "21.717", "entropy_gating": "0.402", "expert1_balance_top": "33.005", "expert1_balance_bottom": "15.641", "unused_expert1_count": "0.648", "expert2_balance_top": "33.206", "expert2_balance_bottom": "15.814", "unused_expert2_count": "0.508", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.082", "ppl": "16.93", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "390", "lr": "1.922e-05", "gnorm": "1.047", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "6983"}
2023-02-01 00:14:55 | INFO | train_inner | {"epoch": 1, "loss": "4.332", "moe_gate_loss": "13.3195", "overflow_expert1": "0.046", "overflow_expert2": "21.591", "entropy_gating": "0.402", "expert1_balance_top": "33.023", "expert1_balance_bottom": "15.631", "unused_expert1_count": "0.639", "expert2_balance_top": "33.181", "expert2_balance_bottom": "15.86", "unused_expert2_count": "0.506", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.14", "ppl": "17.63", "wps": "15282.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "400", "lr": "1.92e-05", "gnorm": "1.061", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "7155"}
2023-02-01 00:17:46 | INFO | train_inner | {"epoch": 1, "loss": "4.315", "moe_gate_loss": "13.3507", "overflow_expert1": "0.062", "overflow_expert2": "22.022", "entropy_gating": "0.403", "expert1_balance_top": "33.184", "expert1_balance_bottom": "15.522", "unused_expert1_count": "0.639", "expert2_balance_top": "33.33", "expert2_balance_bottom": "15.718", "unused_expert2_count": "0.505", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.123", "ppl": "17.42", "wps": "15281.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "410", "lr": "1.918e-05", "gnorm": "1.124", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "7326"}
2023-02-01 00:20:38 | INFO | train_inner | {"epoch": 1, "loss": "4.301", "moe_gate_loss": "13.2976", "overflow_expert1": "0.035", "overflow_expert2": "21.329", "entropy_gating": "0.403", "expert1_balance_top": "32.893", "expert1_balance_bottom": "15.732", "unused_expert1_count": "0.631", "expert2_balance_top": "33.048", "expert2_balance_bottom": "15.951", "unused_expert2_count": "0.5", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.109", "ppl": "17.26", "wps": "15294.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "420", "lr": "1.916e-05", "gnorm": "1.059", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "7498"}
2023-02-01 00:23:29 | INFO | train_inner | {"epoch": 1, "loss": "4.345", "moe_gate_loss": "13.2935", "overflow_expert1": "0.042", "overflow_expert2": "21.456", "entropy_gating": "0.404", "expert1_balance_top": "32.857", "expert1_balance_bottom": "15.725", "unused_expert1_count": "0.63", "expert2_balance_top": "33.067", "expert2_balance_bottom": "15.885", "unused_expert2_count": "0.499", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.153", "ppl": "17.79", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "430", "lr": "1.914e-05", "gnorm": "1.065", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "7669"}
2023-02-01 00:26:21 | INFO | train_inner | {"epoch": 1, "loss": "4.377", "moe_gate_loss": "13.3113", "overflow_expert1": "0.035", "overflow_expert2": "21.762", "entropy_gating": "0.404", "expert1_balance_top": "32.978", "expert1_balance_bottom": "15.621", "unused_expert1_count": "0.629", "expert2_balance_top": "33.266", "expert2_balance_bottom": "15.778", "unused_expert2_count": "0.497", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.185", "ppl": "18.18", "wps": "15276", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "440", "lr": "1.912e-05", "gnorm": "1.088", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "7841"}
2023-02-01 00:29:12 | INFO | train_inner | {"epoch": 1, "loss": "4.336", "moe_gate_loss": "13.2887", "overflow_expert1": "0.044", "overflow_expert2": "21.36", "entropy_gating": "0.404", "expert1_balance_top": "32.85", "expert1_balance_bottom": "15.764", "unused_expert1_count": "0.625", "expert2_balance_top": "33.122", "expert2_balance_bottom": "15.914", "unused_expert2_count": "0.484", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.144", "ppl": "17.68", "wps": "15285", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "450", "lr": "1.91e-05", "gnorm": "1.059", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "8012"}
2023-02-01 00:32:04 | INFO | train_inner | {"epoch": 1, "loss": "4.32", "moe_gate_loss": "13.2869", "overflow_expert1": "0.033", "overflow_expert2": "21.393", "entropy_gating": "0.403", "expert1_balance_top": "32.853", "expert1_balance_bottom": "15.742", "unused_expert1_count": "0.61", "expert2_balance_top": "33.084", "expert2_balance_bottom": "15.927", "unused_expert2_count": "0.495", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.128", "ppl": "17.49", "wps": "15278.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "460", "lr": "1.908e-05", "gnorm": "1.068", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "8184"}
2023-02-01 00:34:55 | INFO | train_inner | {"epoch": 1, "loss": "4.299", "moe_gate_loss": "13.3139", "overflow_expert1": "0.091", "overflow_expert2": "21.277", "entropy_gating": "0.405", "expert1_balance_top": "32.932", "expert1_balance_bottom": "15.787", "unused_expert1_count": "0.618", "expert2_balance_top": "33.106", "expert2_balance_bottom": "15.972", "unused_expert2_count": "0.51", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.107", "ppl": "17.23", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "470", "lr": "1.906e-05", "gnorm": "1.055", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "8355"}
2023-02-01 00:37:47 | INFO | train_inner | {"epoch": 1, "loss": "4.311", "moe_gate_loss": "13.2476", "overflow_expert1": "0.027", "overflow_expert2": "21.06", "entropy_gating": "0.406", "expert1_balance_top": "32.701", "expert1_balance_bottom": "15.946", "unused_expert1_count": "0.612", "expert2_balance_top": "33.08", "expert2_balance_bottom": "16.036", "unused_expert2_count": "0.503", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.12", "ppl": "17.38", "wps": "15283.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "480", "lr": "1.904e-05", "gnorm": "1.05", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "8527"}
2023-02-01 00:40:38 | INFO | train_inner | {"epoch": 1, "loss": "4.298", "moe_gate_loss": "13.2177", "overflow_expert1": "0.033", "overflow_expert2": "20.773", "entropy_gating": "0.407", "expert1_balance_top": "32.62", "expert1_balance_bottom": "16.109", "unused_expert1_count": "0.607", "expert2_balance_top": "32.919", "expert2_balance_bottom": "16.234", "unused_expert2_count": "0.506", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.107", "ppl": "17.23", "wps": "15282.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "490", "lr": "1.902e-05", "gnorm": "1.047", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "8698"}
2023-02-01 00:43:30 | INFO | train_inner | {"epoch": 1, "loss": "4.259", "moe_gate_loss": "13.283", "overflow_expert1": "0.068", "overflow_expert2": "21.229", "entropy_gating": "0.404", "expert1_balance_top": "32.92", "expert1_balance_bottom": "15.946", "unused_expert1_count": "0.597", "expert2_balance_top": "33.156", "expert2_balance_bottom": "16.087", "unused_expert2_count": "0.49", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.067", "ppl": "16.77", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "500", "lr": "1.9e-05", "gnorm": "1.135", "clip": "100", "loss_scale": "0.5", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "8870"}
2023-02-01 00:45:20 | INFO | valid_c4_small/C4_small | {"epoch": 1, "valid_c4_small/C4_small_loss": "4.224", "valid_c4_small/C4_small_moe_gate_loss": "12.8349", "valid_c4_small/C4_small_overflow_expert1": "0.003", "valid_c4_small/C4_small_overflow_expert2": "15.922", "valid_c4_small/C4_small_entropy_gating": "0.441", "valid_c4_small/C4_small_expert1_balance_top": "32.115", "valid_c4_small/C4_small_expert1_balance_bottom": "17.605", "valid_c4_small/C4_small_unused_expert1_count": "0.526", "valid_c4_small/C4_small_expert2_balance_top": "32.574", "valid_c4_small/C4_small_expert2_balance_bottom": "17.211", "valid_c4_small/C4_small_unused_expert2_count": "0.384", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.039", "valid_c4_small/C4_small_ppl": "16.44", "valid_c4_small/C4_small_wps": "51801.9", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "500", "valid_c4_small/C4_small_best_loss": "4.224"}
2023-02-01 00:45:20 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 500 updates
2023-02-01 00:45:28 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 1 @ 500 updates, score 4.224) (writing took 7.848600185941905 seconds)
2023-02-01 00:48:20 | INFO | train_inner | {"epoch": 1, "loss": "4.335", "moe_gate_loss": "13.2259", "overflow_expert1": "0.033", "overflow_expert2": "20.92", "entropy_gating": "0.407", "expert1_balance_top": "32.719", "expert1_balance_bottom": "16.085", "unused_expert1_count": "0.597", "expert2_balance_top": "33.021", "expert2_balance_bottom": "16.218", "unused_expert2_count": "0.493", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.144", "ppl": "17.68", "wps": "9032.1", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "510", "lr": "1.898e-05", "gnorm": "1.075", "clip": "100", "loss_scale": "0.5", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "9160"}
2023-02-01 00:51:12 | INFO | train_inner | {"epoch": 1, "loss": "4.316", "moe_gate_loss": "13.1999", "overflow_expert1": "0.024", "overflow_expert2": "20.526", "entropy_gating": "0.406", "expert1_balance_top": "32.568", "expert1_balance_bottom": "16.205", "unused_expert1_count": "0.595", "expert2_balance_top": "32.831", "expert2_balance_bottom": "16.35", "unused_expert2_count": "0.489", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.126", "ppl": "17.46", "wps": "15278.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "520", "lr": "1.896e-05", "gnorm": "1.048", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "9332"}
2023-02-01 00:54:03 | INFO | train_inner | {"epoch": 1, "loss": "4.302", "moe_gate_loss": "13.2072", "overflow_expert1": "0.034", "overflow_expert2": "20.602", "entropy_gating": "0.405", "expert1_balance_top": "32.613", "expert1_balance_bottom": "16.181", "unused_expert1_count": "0.592", "expert2_balance_top": "32.886", "expert2_balance_bottom": "16.35", "unused_expert2_count": "0.491", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.111", "ppl": "17.28", "wps": "15284.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "530", "lr": "1.894e-05", "gnorm": "1.046", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "9503"}
2023-02-01 00:56:55 | INFO | train_inner | {"epoch": 1, "loss": "4.272", "moe_gate_loss": "13.1872", "overflow_expert1": "0.034", "overflow_expert2": "20.557", "entropy_gating": "0.407", "expert1_balance_top": "32.53", "expert1_balance_bottom": "16.23", "unused_expert1_count": "0.585", "expert2_balance_top": "32.866", "expert2_balance_bottom": "16.347", "unused_expert2_count": "0.482", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.082", "ppl": "16.93", "wps": "15285.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "540", "lr": "1.892e-05", "gnorm": "1.043", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "9675"}
2023-02-01 00:59:46 | INFO | train_inner | {"epoch": 1, "loss": "4.255", "moe_gate_loss": "13.2206", "overflow_expert1": "0.077", "overflow_expert2": "20.549", "entropy_gating": "0.407", "expert1_balance_top": "32.801", "expert1_balance_bottom": "16.223", "unused_expert1_count": "0.583", "expert2_balance_top": "32.893", "expert2_balance_bottom": "16.484", "unused_expert2_count": "0.486", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.064", "ppl": "16.73", "wps": "15294.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "550", "lr": "1.89e-05", "gnorm": "1.095", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "9846"}
2023-02-01 01:02:38 | INFO | train_inner | {"epoch": 1, "loss": "4.282", "moe_gate_loss": "13.1333", "overflow_expert1": "0.024", "overflow_expert2": "19.762", "entropy_gating": "0.408", "expert1_balance_top": "32.512", "expert1_balance_bottom": "16.526", "unused_expert1_count": "0.578", "expert2_balance_top": "32.636", "expert2_balance_bottom": "16.72", "unused_expert2_count": "0.483", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.093", "ppl": "17.07", "wps": "15282.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "560", "lr": "1.888e-05", "gnorm": "1.054", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "10017"}
2023-02-01 01:05:29 | INFO | train_inner | {"epoch": 1, "loss": "4.286", "moe_gate_loss": "13.1254", "overflow_expert1": "0.027", "overflow_expert2": "19.787", "entropy_gating": "0.409", "expert1_balance_top": "32.454", "expert1_balance_bottom": "16.585", "unused_expert1_count": "0.58", "expert2_balance_top": "32.654", "expert2_balance_bottom": "16.662", "unused_expert2_count": "0.477", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.097", "ppl": "17.11", "wps": "15282.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "570", "lr": "1.886e-05", "gnorm": "1.042", "clip": "90", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "10189"}
2023-02-01 01:08:21 | INFO | train_inner | {"epoch": 1, "loss": "4.25", "moe_gate_loss": "13.1283", "overflow_expert1": "0.031", "overflow_expert2": "19.719", "entropy_gating": "0.407", "expert1_balance_top": "32.409", "expert1_balance_bottom": "16.611", "unused_expert1_count": "0.581", "expert2_balance_top": "32.647", "expert2_balance_bottom": "16.676", "unused_expert2_count": "0.479", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.06", "ppl": "16.68", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "580", "lr": "1.884e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "10360"}
2023-02-01 01:11:12 | INFO | train_inner | {"epoch": 1, "loss": "4.29", "moe_gate_loss": "13.1252", "overflow_expert1": "0.028", "overflow_expert2": "19.527", "entropy_gating": "0.409", "expert1_balance_top": "32.432", "expert1_balance_bottom": "16.631", "unused_expert1_count": "0.578", "expert2_balance_top": "32.602", "expert2_balance_bottom": "16.774", "unused_expert2_count": "0.48", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.1", "ppl": "17.15", "wps": "15281.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "590", "lr": "1.882e-05", "gnorm": "1.066", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "10532"}
2023-02-01 01:14:04 | INFO | train_inner | {"epoch": 1, "loss": "4.307", "moe_gate_loss": "13.0925", "overflow_expert1": "0.019", "overflow_expert2": "19.494", "entropy_gating": "0.409", "expert1_balance_top": "32.244", "expert1_balance_bottom": "16.736", "unused_expert1_count": "0.581", "expert2_balance_top": "32.571", "expert2_balance_bottom": "16.705", "unused_expert2_count": "0.477", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.118", "ppl": "17.37", "wps": "15285.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "600", "lr": "1.88e-05", "gnorm": "1.05", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "10703"}
2023-02-01 01:16:55 | INFO | train_inner | {"epoch": 1, "loss": "4.321", "moe_gate_loss": "13.0945", "overflow_expert1": "0.022", "overflow_expert2": "19.417", "entropy_gating": "0.408", "expert1_balance_top": "32.23", "expert1_balance_bottom": "16.735", "unused_expert1_count": "0.58", "expert2_balance_top": "32.541", "expert2_balance_bottom": "16.743", "unused_expert2_count": "0.479", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.132", "ppl": "17.54", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "610", "lr": "1.878e-05", "gnorm": "1.093", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "10875"}
2023-02-01 01:19:46 | INFO | train_inner | {"epoch": 1, "loss": "4.341", "moe_gate_loss": "13.1189", "overflow_expert1": "0.037", "overflow_expert2": "19.555", "entropy_gating": "0.409", "expert1_balance_top": "32.365", "expert1_balance_bottom": "16.678", "unused_expert1_count": "0.577", "expert2_balance_top": "32.608", "expert2_balance_bottom": "16.716", "unused_expert2_count": "0.474", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.152", "ppl": "17.78", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "620", "lr": "1.876e-05", "gnorm": "1.061", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "11046"}
2023-02-01 01:22:38 | INFO | train_inner | {"epoch": 1, "loss": "4.312", "moe_gate_loss": "13.0827", "overflow_expert1": "0.017", "overflow_expert2": "19.41", "entropy_gating": "0.41", "expert1_balance_top": "32.166", "expert1_balance_bottom": "16.796", "unused_expert1_count": "0.577", "expert2_balance_top": "32.568", "expert2_balance_bottom": "16.727", "unused_expert2_count": "0.479", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.123", "ppl": "17.42", "wps": "15289", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "630", "lr": "1.874e-05", "gnorm": "1.044", "clip": "90", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "11218"}
2023-02-01 01:25:29 | INFO | train_inner | {"epoch": 1, "loss": "4.353", "moe_gate_loss": "13.1088", "overflow_expert1": "0.027", "overflow_expert2": "19.471", "entropy_gating": "0.409", "expert1_balance_top": "32.321", "expert1_balance_bottom": "16.712", "unused_expert1_count": "0.575", "expert2_balance_top": "32.589", "expert2_balance_bottom": "16.737", "unused_expert2_count": "0.472", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.164", "ppl": "17.93", "wps": "15283.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "640", "lr": "1.872e-05", "gnorm": "1.058", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "11389"}
2023-02-01 01:28:21 | INFO | train_inner | {"epoch": 1, "loss": "4.324", "moe_gate_loss": "13.0813", "overflow_expert1": "0.017", "overflow_expert2": "19.288", "entropy_gating": "0.408", "expert1_balance_top": "32.177", "expert1_balance_bottom": "16.799", "unused_expert1_count": "0.57", "expert2_balance_top": "32.529", "expert2_balance_bottom": "16.768", "unused_expert2_count": "0.473", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.135", "ppl": "17.57", "wps": "15290.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "650", "lr": "1.87e-05", "gnorm": "1.041", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "11561"}
2023-02-01 01:31:12 | INFO | train_inner | {"epoch": 1, "loss": "4.349", "moe_gate_loss": "13.0787", "overflow_expert1": "0.019", "overflow_expert2": "19.221", "entropy_gating": "0.409", "expert1_balance_top": "32.119", "expert1_balance_bottom": "16.827", "unused_expert1_count": "0.574", "expert2_balance_top": "32.526", "expert2_balance_bottom": "16.801", "unused_expert2_count": "0.477", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.16", "ppl": "17.88", "wps": "15293.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "660", "lr": "1.868e-05", "gnorm": "1.034", "clip": "90", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "11732"}
2023-02-01 01:34:04 | INFO | train_inner | {"epoch": 1, "loss": "4.305", "moe_gate_loss": "13.0851", "overflow_expert1": "0.027", "overflow_expert2": "19.261", "entropy_gating": "0.409", "expert1_balance_top": "32.16", "expert1_balance_bottom": "16.82", "unused_expert1_count": "0.57", "expert2_balance_top": "32.529", "expert2_balance_bottom": "16.757", "unused_expert2_count": "0.476", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.117", "ppl": "17.35", "wps": "15286.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "670", "lr": "1.866e-05", "gnorm": "1.022", "clip": "90", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "11904"}
2023-02-01 01:36:55 | INFO | train_inner | {"epoch": 1, "loss": "4.322", "moe_gate_loss": "13.0977", "overflow_expert1": "0.032", "overflow_expert2": "19.409", "entropy_gating": "0.408", "expert1_balance_top": "32.234", "expert1_balance_bottom": "16.77", "unused_expert1_count": "0.571", "expert2_balance_top": "32.556", "expert2_balance_bottom": "16.776", "unused_expert2_count": "0.468", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.133", "ppl": "17.54", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "680", "lr": "1.864e-05", "gnorm": "1.042", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "12075"}
2023-02-01 01:39:47 | INFO | train_inner | {"epoch": 1, "loss": "4.291", "moe_gate_loss": "13.092", "overflow_expert1": "0.035", "overflow_expert2": "19.273", "entropy_gating": "0.41", "expert1_balance_top": "32.185", "expert1_balance_bottom": "16.825", "unused_expert1_count": "0.563", "expert2_balance_top": "32.552", "expert2_balance_bottom": "16.76", "unused_expert2_count": "0.467", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.102", "ppl": "17.17", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "690", "lr": "1.862e-05", "gnorm": "1.119", "clip": "90", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "12247"}
2023-02-01 01:42:38 | INFO | train_inner | {"epoch": 1, "loss": "4.299", "moe_gate_loss": "13.0949", "overflow_expert1": "0.025", "overflow_expert2": "19.345", "entropy_gating": "0.409", "expert1_balance_top": "32.237", "expert1_balance_bottom": "16.772", "unused_expert1_count": "0.562", "expert2_balance_top": "32.557", "expert2_balance_bottom": "16.756", "unused_expert2_count": "0.468", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.11", "ppl": "17.27", "wps": "15288.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "700", "lr": "1.86e-05", "gnorm": "1.049", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "12418"}
2023-02-01 01:45:30 | INFO | train_inner | {"epoch": 1, "loss": "4.297", "moe_gate_loss": "13.0748", "overflow_expert1": "0.015", "overflow_expert2": "19.243", "entropy_gating": "0.409", "expert1_balance_top": "32.123", "expert1_balance_bottom": "16.837", "unused_expert1_count": "0.554", "expert2_balance_top": "32.511", "expert2_balance_bottom": "16.779", "unused_expert2_count": "0.46", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.109", "ppl": "17.25", "wps": "15288.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "710", "lr": "1.858e-05", "gnorm": "1.029", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "12590"}
2023-02-01 01:48:21 | INFO | train_inner | {"epoch": 1, "loss": "4.336", "moe_gate_loss": "13.0694", "overflow_expert1": "0.019", "overflow_expert2": "19.139", "entropy_gating": "0.41", "expert1_balance_top": "32.067", "expert1_balance_bottom": "16.891", "unused_expert1_count": "0.543", "expert2_balance_top": "32.486", "expert2_balance_bottom": "16.809", "unused_expert2_count": "0.46", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.147", "ppl": "17.72", "wps": "15288.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "720", "lr": "1.856e-05", "gnorm": "1.079", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "12761"}
2023-02-01 01:51:13 | INFO | train_inner | {"epoch": 1, "loss": "4.306", "moe_gate_loss": "13.0809", "overflow_expert1": "0.021", "overflow_expert2": "19.155", "entropy_gating": "0.409", "expert1_balance_top": "32.128", "expert1_balance_bottom": "16.847", "unused_expert1_count": "0.539", "expert2_balance_top": "32.522", "expert2_balance_bottom": "16.785", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.117", "ppl": "17.35", "wps": "15287.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "730", "lr": "1.854e-05", "gnorm": "1.04", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "12933"}
2023-02-01 01:54:04 | INFO | train_inner | {"epoch": 1, "loss": "4.325", "moe_gate_loss": "13.0981", "overflow_expert1": "0.026", "overflow_expert2": "19.428", "entropy_gating": "0.411", "expert1_balance_top": "32.234", "expert1_balance_bottom": "16.798", "unused_expert1_count": "0.532", "expert2_balance_top": "32.631", "expert2_balance_bottom": "16.721", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.136", "ppl": "17.58", "wps": "15282.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "740", "lr": "1.852e-05", "gnorm": "1.047", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "13104"}
2023-02-01 01:56:56 | INFO | train_inner | {"epoch": 1, "loss": "4.289", "moe_gate_loss": "13.0763", "overflow_expert1": "0.023", "overflow_expert2": "19.09", "entropy_gating": "0.41", "expert1_balance_top": "32.12", "expert1_balance_bottom": "16.875", "unused_expert1_count": "0.521", "expert2_balance_top": "32.481", "expert2_balance_bottom": "16.815", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.101", "ppl": "17.16", "wps": "15295.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "750", "lr": "1.85e-05", "gnorm": "1.061", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "13276"}
2023-02-01 01:58:46 | INFO | valid_c4_small/C4_small | {"epoch": 1, "valid_c4_small/C4_small_loss": "4.218", "valid_c4_small/C4_small_moe_gate_loss": "12.7403", "valid_c4_small/C4_small_overflow_expert1": "0.004", "valid_c4_small/C4_small_overflow_expert2": "14.418", "valid_c4_small/C4_small_entropy_gating": "0.444", "valid_c4_small/C4_small_expert1_balance_top": "31.894", "valid_c4_small/C4_small_expert1_balance_bottom": "18.181", "valid_c4_small/C4_small_unused_expert1_count": "0.448", "valid_c4_small/C4_small_expert2_balance_top": "32.004", "valid_c4_small/C4_small_expert2_balance_bottom": "17.756", "valid_c4_small/C4_small_unused_expert2_count": "0.369", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.034", "valid_c4_small/C4_small_ppl": "16.38", "valid_c4_small/C4_small_wps": "51838.6", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "750", "valid_c4_small/C4_small_best_loss": "4.218"}
2023-02-01 01:58:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 750 updates
2023-02-01 01:58:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 1 @ 750 updates, score 4.218) (writing took 7.889693925157189 seconds)
2023-02-01 02:01:46 | INFO | train_inner | {"epoch": 1, "loss": "4.283", "moe_gate_loss": "13.0904", "overflow_expert1": "0.023", "overflow_expert2": "19.371", "entropy_gating": "0.411", "expert1_balance_top": "32.194", "expert1_balance_bottom": "16.772", "unused_expert1_count": "0.521", "expert2_balance_top": "32.581", "expert2_balance_bottom": "16.7", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.094", "ppl": "17.08", "wps": "9032.4", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "760", "lr": "1.848e-05", "gnorm": "1.062", "clip": "100", "loss_scale": "1", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "13566"}
2023-02-01 02:04:37 | INFO | train_inner | {"epoch": 1, "loss": "4.307", "moe_gate_loss": "13.1137", "overflow_expert1": "0.03", "overflow_expert2": "19.54", "entropy_gating": "0.41", "expert1_balance_top": "32.348", "expert1_balance_bottom": "16.692", "unused_expert1_count": "0.518", "expert2_balance_top": "32.676", "expert2_balance_bottom": "16.69", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.118", "ppl": "17.37", "wps": "15289.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "770", "lr": "1.846e-05", "gnorm": "1.09", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "13737"}
2023-02-01 02:07:29 | INFO | train_inner | {"epoch": 1, "loss": "4.311", "moe_gate_loss": "13.059", "overflow_expert1": "0.016", "overflow_expert2": "18.983", "entropy_gating": "0.411", "expert1_balance_top": "32.037", "expert1_balance_bottom": "16.927", "unused_expert1_count": "0.509", "expert2_balance_top": "32.394", "expert2_balance_bottom": "16.831", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.123", "ppl": "17.42", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "780", "lr": "1.844e-05", "gnorm": "1.042", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "13909"}
2023-02-01 02:10:20 | INFO | train_inner | {"epoch": 1, "loss": "4.316", "moe_gate_loss": "13.0649", "overflow_expert1": "0.026", "overflow_expert2": "19.104", "entropy_gating": "0.411", "expert1_balance_top": "32.087", "expert1_balance_bottom": "16.897", "unused_expert1_count": "0.514", "expert2_balance_top": "32.547", "expert2_balance_bottom": "16.761", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.127", "ppl": "17.48", "wps": "15287.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "790", "lr": "1.842e-05", "gnorm": "1.041", "clip": "90", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "14080"}
2023-02-01 02:13:12 | INFO | train_inner | {"epoch": 1, "loss": "4.327", "moe_gate_loss": "13.0207", "overflow_expert1": "0.02", "overflow_expert2": "18.571", "entropy_gating": "0.411", "expert1_balance_top": "31.939", "expert1_balance_bottom": "16.984", "unused_expert1_count": "0.509", "expert2_balance_top": "32.376", "expert2_balance_bottom": "16.89", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.14", "ppl": "17.63", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "800", "lr": "1.84e-05", "gnorm": "1.045", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "14252"}
2023-02-01 02:17:44 | INFO | valid_c4_small/C4_small | {"epoch": 1, "valid_c4_small/C4_small_loss": "4.215", "valid_c4_small/C4_small_moe_gate_loss": "12.6318", "valid_c4_small/C4_small_overflow_expert1": "0.003", "valid_c4_small/C4_small_overflow_expert2": "13.375", "valid_c4_small/C4_small_entropy_gating": "0.443", "valid_c4_small/C4_small_expert1_balance_top": "31.613", "valid_c4_small/C4_small_expert1_balance_bottom": "18.212", "valid_c4_small/C4_small_unused_expert1_count": "0.472", "valid_c4_small/C4_small_expert2_balance_top": "31.532", "valid_c4_small/C4_small_expert2_balance_bottom": "17.786", "valid_c4_small/C4_small_unused_expert2_count": "0.357", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.033", "valid_c4_small/C4_small_ppl": "16.37", "valid_c4_small/C4_small_wps": "51967.9", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "809", "valid_c4_small/C4_small_best_loss": "4.215"}
2023-02-01 02:17:44 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2023-02-01 02:17:44 | INFO | train | {"epoch": 1, "train_loss": "4.328", "train_moe_gate_loss": "13.7221", "train_overflow_expert1": "0.357", "train_overflow_expert2": "23.381", "train_entropy_gating": "0.398", "train_expert1_balance_top": "33.95", "train_expert1_balance_bottom": "15.17", "train_unused_expert1_count": "0.672", "train_expert2_balance_top": "33.805", "train_expert2_balance_bottom": "15.486", "train_unused_expert2_count": "0.52", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "4.13", "train_ppl": "17.51", "train_wps": "14779.5", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "809", "train_lr": "1.8382e-05", "train_gnorm": "1.154", "train_clip": "99.3", "train_loss_scale": "1", "train_train_wall": "13569", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "14524"}
2023-02-01 02:17:44 | INFO | fairseq.trainer | begin training epoch 2
2023-02-01 02:18:01 | INFO | train_inner | {"epoch": 2, "loss": "4.315", "moe_gate_loss": "12.9606", "overflow_expert1": "0.019", "overflow_expert2": "18.133", "entropy_gating": "0.411", "expert1_balance_top": "31.829", "expert1_balance_bottom": "16.963", "unused_expert1_count": "0.514", "expert2_balance_top": "32.327", "expert2_balance_bottom": "16.793", "unused_expert2_count": "0.435", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.128", "ppl": "17.48", "wps": "9068", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "810", "lr": "1.838e-05", "gnorm": "1.024", "clip": "100", "loss_scale": "1", "train_wall": "174", "cuda_gb_allocated": "14.3", "cuda_gb_reserved": "21.6", "cuda_gb_free": "9.4", "wall": "14541"}
2023-02-01 02:20:52 | INFO | train_inner | {"epoch": 2, "loss": "4.326", "moe_gate_loss": "12.9518", "overflow_expert1": "0.023", "overflow_expert2": "18.197", "entropy_gating": "0.412", "expert1_balance_top": "31.844", "expert1_balance_bottom": "16.9", "unused_expert1_count": "0.515", "expert2_balance_top": "32.275", "expert2_balance_bottom": "16.751", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.14", "ppl": "17.63", "wps": "15282.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "820", "lr": "1.836e-05", "gnorm": "1.037", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "14712"}
2023-02-01 02:23:44 | INFO | train_inner | {"epoch": 2, "loss": "4.252", "moe_gate_loss": "12.9646", "overflow_expert1": "0.024", "overflow_expert2": "18.518", "entropy_gating": "0.414", "expert1_balance_top": "31.92", "expert1_balance_bottom": "16.798", "unused_expert1_count": "0.516", "expert2_balance_top": "32.461", "expert2_balance_bottom": "16.618", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.065", "ppl": "16.74", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "830", "lr": "1.834e-05", "gnorm": "1.053", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "14884"}
2023-02-01 02:26:35 | INFO | train_inner | {"epoch": 2, "loss": "4.249", "moe_gate_loss": "12.9609", "overflow_expert1": "0.013", "overflow_expert2": "18.576", "entropy_gating": "0.412", "expert1_balance_top": "31.92", "expert1_balance_bottom": "16.722", "unused_expert1_count": "0.521", "expert2_balance_top": "32.392", "expert2_balance_bottom": "16.598", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.062", "ppl": "16.7", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "840", "lr": "1.832e-05", "gnorm": "1.078", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "15055"}
2023-02-01 02:29:27 | INFO | train_inner | {"epoch": 2, "loss": "4.24", "moe_gate_loss": "12.9684", "overflow_expert1": "0.016", "overflow_expert2": "18.724", "entropy_gating": "0.413", "expert1_balance_top": "31.977", "expert1_balance_bottom": "16.707", "unused_expert1_count": "0.51", "expert2_balance_top": "32.407", "expert2_balance_bottom": "16.563", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.053", "ppl": "16.6", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "850", "lr": "1.83e-05", "gnorm": "1.065", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "15226"}
2023-02-01 02:32:18 | INFO | train_inner | {"epoch": 2, "loss": "4.201", "moe_gate_loss": "12.9783", "overflow_expert1": "0.021", "overflow_expert2": "18.568", "entropy_gating": "0.412", "expert1_balance_top": "32.046", "expert1_balance_bottom": "16.689", "unused_expert1_count": "0.512", "expert2_balance_top": "32.363", "expert2_balance_bottom": "16.665", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.013", "ppl": "16.15", "wps": "15292.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "860", "lr": "1.828e-05", "gnorm": "1.061", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "15398"}
2023-02-01 02:35:09 | INFO | train_inner | {"epoch": 2, "loss": "4.209", "moe_gate_loss": "12.947", "overflow_expert1": "0.013", "overflow_expert2": "18.157", "entropy_gating": "0.412", "expert1_balance_top": "31.843", "expert1_balance_bottom": "16.835", "unused_expert1_count": "0.516", "expert2_balance_top": "32.239", "expert2_balance_bottom": "16.793", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.022", "ppl": "16.25", "wps": "15298.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "870", "lr": "1.826e-05", "gnorm": "1.059", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "15569"}
2023-02-01 02:38:01 | INFO | train_inner | {"epoch": 2, "loss": "4.223", "moe_gate_loss": "12.9683", "overflow_expert1": "0.019", "overflow_expert2": "18.46", "entropy_gating": "0.412", "expert1_balance_top": "31.942", "expert1_balance_bottom": "16.744", "unused_expert1_count": "0.518", "expert2_balance_top": "32.364", "expert2_balance_bottom": "16.695", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.036", "ppl": "16.4", "wps": "15290.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "880", "lr": "1.824e-05", "gnorm": "1.048", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "15741"}
2023-02-01 02:40:52 | INFO | train_inner | {"epoch": 2, "loss": "4.274", "moe_gate_loss": "12.9538", "overflow_expert1": "0.018", "overflow_expert2": "18.282", "entropy_gating": "0.412", "expert1_balance_top": "31.854", "expert1_balance_bottom": "16.831", "unused_expert1_count": "0.514", "expert2_balance_top": "32.283", "expert2_balance_bottom": "16.731", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.087", "ppl": "16.99", "wps": "15297.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "890", "lr": "1.822e-05", "gnorm": "1.053", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "15912"}
2023-02-01 02:43:44 | INFO | train_inner | {"epoch": 2, "loss": "4.252", "moe_gate_loss": "12.9543", "overflow_expert1": "0.013", "overflow_expert2": "18.182", "entropy_gating": "0.411", "expert1_balance_top": "31.869", "expert1_balance_bottom": "16.824", "unused_expert1_count": "0.515", "expert2_balance_top": "32.216", "expert2_balance_bottom": "16.76", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.065", "ppl": "16.73", "wps": "15297.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "900", "lr": "1.82e-05", "gnorm": "1.052", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "16083"}
2023-02-01 02:46:35 | INFO | train_inner | {"epoch": 2, "loss": "4.237", "moe_gate_loss": "12.9692", "overflow_expert1": "0.014", "overflow_expert2": "18.475", "entropy_gating": "0.412", "expert1_balance_top": "31.97", "expert1_balance_bottom": "16.756", "unused_expert1_count": "0.515", "expert2_balance_top": "32.251", "expert2_balance_bottom": "16.679", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.05", "ppl": "16.57", "wps": "15293.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "910", "lr": "1.818e-05", "gnorm": "1.068", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "16255"}
2023-02-01 02:49:26 | INFO | train_inner | {"epoch": 2, "loss": "4.221", "moe_gate_loss": "12.9598", "overflow_expert1": "0.019", "overflow_expert2": "18.16", "entropy_gating": "0.412", "expert1_balance_top": "31.9", "expert1_balance_bottom": "16.827", "unused_expert1_count": "0.52", "expert2_balance_top": "32.229", "expert2_balance_bottom": "16.819", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.034", "ppl": "16.39", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "920", "lr": "1.816e-05", "gnorm": "1.076", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "16426"}
2023-02-01 02:52:18 | INFO | train_inner | {"epoch": 2, "loss": "4.238", "moe_gate_loss": "12.9566", "overflow_expert1": "0.014", "overflow_expert2": "18.339", "entropy_gating": "0.414", "expert1_balance_top": "31.881", "expert1_balance_bottom": "16.804", "unused_expert1_count": "0.519", "expert2_balance_top": "32.296", "expert2_balance_bottom": "16.73", "unused_expert2_count": "0.465", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.051", "ppl": "16.58", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "930", "lr": "1.814e-05", "gnorm": "1.094", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "16598"}
2023-02-01 02:55:09 | INFO | train_inner | {"epoch": 2, "loss": "4.233", "moe_gate_loss": "12.9687", "overflow_expert1": "0.021", "overflow_expert2": "18.227", "entropy_gating": "0.413", "expert1_balance_top": "31.952", "expert1_balance_bottom": "16.793", "unused_expert1_count": "0.518", "expert2_balance_top": "32.168", "expert2_balance_bottom": "16.806", "unused_expert2_count": "0.469", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.046", "ppl": "16.52", "wps": "15297.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "940", "lr": "1.812e-05", "gnorm": "1.081", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "16769"}
2023-02-01 02:58:01 | INFO | train_inner | {"epoch": 2, "loss": "4.284", "moe_gate_loss": "12.9761", "overflow_expert1": "0.021", "overflow_expert2": "18.422", "entropy_gating": "0.413", "expert1_balance_top": "31.997", "expert1_balance_bottom": "16.734", "unused_expert1_count": "0.521", "expert2_balance_top": "32.234", "expert2_balance_bottom": "16.728", "unused_expert2_count": "0.463", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.096", "ppl": "17.11", "wps": "15296.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "950", "lr": "1.81e-05", "gnorm": "1.077", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "16940"}
2023-02-01 03:00:52 | INFO | train_inner | {"epoch": 2, "loss": "4.239", "moe_gate_loss": "12.9529", "overflow_expert1": "0.022", "overflow_expert2": "17.963", "entropy_gating": "0.412", "expert1_balance_top": "31.839", "expert1_balance_bottom": "16.874", "unused_expert1_count": "0.516", "expert2_balance_top": "32.126", "expert2_balance_bottom": "16.895", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.053", "ppl": "16.59", "wps": "15288.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "960", "lr": "1.808e-05", "gnorm": "1.129", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "17112"}
2023-02-01 03:03:43 | INFO | train_inner | {"epoch": 2, "loss": "4.235", "moe_gate_loss": "12.9684", "overflow_expert1": "0.018", "overflow_expert2": "18.448", "entropy_gating": "0.412", "expert1_balance_top": "31.942", "expert1_balance_bottom": "16.777", "unused_expert1_count": "0.517", "expert2_balance_top": "32.312", "expert2_balance_bottom": "16.707", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.048", "ppl": "16.54", "wps": "15301.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "970", "lr": "1.806e-05", "gnorm": "1.081", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "17283"}
2023-02-01 03:06:35 | INFO | train_inner | {"epoch": 2, "loss": "4.303", "moe_gate_loss": "13.0026", "overflow_expert1": "0.026", "overflow_expert2": "18.564", "entropy_gating": "0.413", "expert1_balance_top": "32.135", "expert1_balance_bottom": "16.656", "unused_expert1_count": "0.506", "expert2_balance_top": "32.25", "expert2_balance_bottom": "16.726", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.116", "ppl": "17.34", "wps": "15293.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "980", "lr": "1.804e-05", "gnorm": "1.803", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "17455"}
2023-02-01 03:09:26 | INFO | train_inner | {"epoch": 2, "loss": "4.238", "moe_gate_loss": "12.9675", "overflow_expert1": "0.019", "overflow_expert2": "18.238", "entropy_gating": "0.412", "expert1_balance_top": "31.94", "expert1_balance_bottom": "16.812", "unused_expert1_count": "0.508", "expert2_balance_top": "32.232", "expert2_balance_bottom": "16.808", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.051", "ppl": "16.58", "wps": "15298.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "990", "lr": "1.802e-05", "gnorm": "1.078", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "17626"}
2023-02-01 03:12:17 | INFO | train_inner | {"epoch": 2, "loss": "4.254", "moe_gate_loss": "12.9495", "overflow_expert1": "0.015", "overflow_expert2": "18.157", "entropy_gating": "0.412", "expert1_balance_top": "31.813", "expert1_balance_bottom": "16.872", "unused_expert1_count": "0.513", "expert2_balance_top": "32.167", "expert2_balance_bottom": "16.805", "unused_expert2_count": "0.462", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.067", "ppl": "16.76", "wps": "15296.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1000", "lr": "1.8e-05", "gnorm": "1.063", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "17797"}
2023-02-01 03:14:07 | INFO | valid_c4_small/C4_small | {"epoch": 2, "valid_c4_small/C4_small_loss": "4.216", "valid_c4_small/C4_small_moe_gate_loss": "12.6164", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "13.262", "valid_c4_small/C4_small_entropy_gating": "0.446", "valid_c4_small/C4_small_expert1_balance_top": "31.606", "valid_c4_small/C4_small_expert1_balance_bottom": "18.153", "valid_c4_small/C4_small_unused_expert1_count": "0.476", "valid_c4_small/C4_small_expert2_balance_top": "31.557", "valid_c4_small/C4_small_expert2_balance_bottom": "17.895", "valid_c4_small/C4_small_unused_expert2_count": "0.388", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.034", "valid_c4_small/C4_small_ppl": "16.38", "valid_c4_small/C4_small_wps": "52016.3", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "1000", "valid_c4_small/C4_small_best_loss": "4.216"}
2023-02-01 03:14:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 1000 updates
2023-02-01 03:14:15 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 2 @ 1000 updates, score 4.216) (writing took 7.882307628635317 seconds)
2023-02-01 03:17:07 | INFO | train_inner | {"epoch": 2, "loss": "4.238", "moe_gate_loss": "12.9678", "overflow_expert1": "0.015", "overflow_expert2": "18.268", "entropy_gating": "0.413", "expert1_balance_top": "31.95", "expert1_balance_bottom": "16.795", "unused_expert1_count": "0.513", "expert2_balance_top": "32.248", "expert2_balance_bottom": "16.787", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.051", "ppl": "16.58", "wps": "9049.9", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "1010", "lr": "1.798e-05", "gnorm": "1.137", "clip": "100", "loss_scale": "1", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "18087"}
2023-02-01 03:19:58 | INFO | train_inner | {"epoch": 2, "loss": "4.227", "moe_gate_loss": "12.9704", "overflow_expert1": "0.026", "overflow_expert2": "18.221", "entropy_gating": "0.412", "expert1_balance_top": "31.939", "expert1_balance_bottom": "16.794", "unused_expert1_count": "0.514", "expert2_balance_top": "32.221", "expert2_balance_bottom": "16.798", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.04", "ppl": "16.45", "wps": "15298.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1020", "lr": "1.796e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "18258"}
2023-02-01 03:22:50 | INFO | train_inner | {"epoch": 2, "loss": "4.274", "moe_gate_loss": "12.9492", "overflow_expert1": "0.02", "overflow_expert2": "18.097", "entropy_gating": "0.413", "expert1_balance_top": "31.822", "expert1_balance_bottom": "16.91", "unused_expert1_count": "0.519", "expert2_balance_top": "32.209", "expert2_balance_bottom": "16.832", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.087", "ppl": "16.99", "wps": "15290.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1030", "lr": "1.794e-05", "gnorm": "1.084", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "18430"}
2023-02-01 03:25:41 | INFO | train_inner | {"epoch": 2, "loss": "4.254", "moe_gate_loss": "12.9602", "overflow_expert1": "0.025", "overflow_expert2": "18.134", "entropy_gating": "0.413", "expert1_balance_top": "31.861", "expert1_balance_bottom": "16.859", "unused_expert1_count": "0.513", "expert2_balance_top": "32.216", "expert2_balance_bottom": "16.824", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.067", "ppl": "16.76", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1040", "lr": "1.792e-05", "gnorm": "1.086", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "18601"}
2023-02-01 03:28:33 | INFO | train_inner | {"epoch": 2, "loss": "4.217", "moe_gate_loss": "12.9597", "overflow_expert1": "0.018", "overflow_expert2": "18.256", "entropy_gating": "0.413", "expert1_balance_top": "31.868", "expert1_balance_bottom": "16.849", "unused_expert1_count": "0.508", "expert2_balance_top": "32.262", "expert2_balance_bottom": "16.771", "unused_expert2_count": "0.463", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.03", "ppl": "16.34", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1050", "lr": "1.79e-05", "gnorm": "1.176", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "18773"}
2023-02-01 03:31:24 | INFO | train_inner | {"epoch": 2, "loss": "4.267", "moe_gate_loss": "12.9442", "overflow_expert1": "0.019", "overflow_expert2": "17.869", "entropy_gating": "0.412", "expert1_balance_top": "31.762", "expert1_balance_bottom": "16.929", "unused_expert1_count": "0.513", "expert2_balance_top": "32.067", "expert2_balance_bottom": "16.911", "unused_expert2_count": "0.46", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.08", "ppl": "16.92", "wps": "15301", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1060", "lr": "1.788e-05", "gnorm": "1.066", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "18944"}
2023-02-01 03:34:16 | INFO | train_inner | {"epoch": 2, "loss": "4.212", "moe_gate_loss": "12.9447", "overflow_expert1": "0.019", "overflow_expert2": "17.941", "entropy_gating": "0.412", "expert1_balance_top": "31.778", "expert1_balance_bottom": "16.938", "unused_expert1_count": "0.512", "expert2_balance_top": "32.126", "expert2_balance_bottom": "16.858", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.026", "ppl": "16.29", "wps": "15298.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1070", "lr": "1.786e-05", "gnorm": "1.069", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "19115"}
2023-02-01 03:37:07 | INFO | train_inner | {"epoch": 2, "loss": "4.271", "moe_gate_loss": "12.9519", "overflow_expert1": "0.014", "overflow_expert2": "18.201", "entropy_gating": "0.412", "expert1_balance_top": "31.823", "expert1_balance_bottom": "16.865", "unused_expert1_count": "0.517", "expert2_balance_top": "32.188", "expert2_balance_bottom": "16.773", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.084", "ppl": "16.96", "wps": "15299.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1080", "lr": "1.784e-05", "gnorm": "1.07", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "19287"}
2023-02-01 03:39:58 | INFO | train_inner | {"epoch": 2, "loss": "4.22", "moe_gate_loss": "12.9669", "overflow_expert1": "0.028", "overflow_expert2": "18.252", "entropy_gating": "0.411", "expert1_balance_top": "31.903", "expert1_balance_bottom": "16.834", "unused_expert1_count": "0.505", "expert2_balance_top": "32.254", "expert2_balance_bottom": "16.797", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.033", "ppl": "16.37", "wps": "15294.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1090", "lr": "1.782e-05", "gnorm": "1.071", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "19458"}
2023-02-01 03:42:50 | INFO | train_inner | {"epoch": 2, "loss": "4.233", "moe_gate_loss": "12.9579", "overflow_expert1": "0.018", "overflow_expert2": "18.062", "entropy_gating": "0.411", "expert1_balance_top": "31.883", "expert1_balance_bottom": "16.861", "unused_expert1_count": "0.513", "expert2_balance_top": "32.132", "expert2_balance_bottom": "16.825", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.046", "ppl": "16.52", "wps": "15288.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1100", "lr": "1.78e-05", "gnorm": "1.061", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "19630"}
2023-02-01 03:45:41 | INFO | train_inner | {"epoch": 2, "loss": "4.283", "moe_gate_loss": "12.9379", "overflow_expert1": "0.017", "overflow_expert2": "17.995", "entropy_gating": "0.411", "expert1_balance_top": "31.716", "expert1_balance_bottom": "16.951", "unused_expert1_count": "0.507", "expert2_balance_top": "32.176", "expert2_balance_bottom": "16.848", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.096", "ppl": "17.11", "wps": "15289.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1110", "lr": "1.778e-05", "gnorm": "1.072", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "19801"}
2023-02-01 03:48:33 | INFO | train_inner | {"epoch": 2, "loss": "4.26", "moe_gate_loss": "12.9743", "overflow_expert1": "0.027", "overflow_expert2": "18.146", "entropy_gating": "0.409", "expert1_balance_top": "31.972", "expert1_balance_bottom": "16.808", "unused_expert1_count": "0.506", "expert2_balance_top": "32.17", "expert2_balance_bottom": "16.844", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.073", "ppl": "16.83", "wps": "15293.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1120", "lr": "1.776e-05", "gnorm": "1.1", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "19972"}
2023-02-01 03:51:24 | INFO | train_inner | {"epoch": 2, "loss": "4.239", "moe_gate_loss": "12.9661", "overflow_expert1": "0.027", "overflow_expert2": "18.234", "entropy_gating": "0.411", "expert1_balance_top": "31.9", "expert1_balance_bottom": "16.855", "unused_expert1_count": "0.508", "expert2_balance_top": "32.271", "expert2_balance_bottom": "16.775", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.052", "ppl": "16.59", "wps": "15291.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1130", "lr": "1.774e-05", "gnorm": "1.073", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "20144"}
2023-02-01 03:54:15 | INFO | train_inner | {"epoch": 2, "loss": "4.22", "moe_gate_loss": "12.9392", "overflow_expert1": "0.015", "overflow_expert2": "17.92", "entropy_gating": "0.411", "expert1_balance_top": "31.762", "expert1_balance_bottom": "16.944", "unused_expert1_count": "0.512", "expert2_balance_top": "32.145", "expert2_balance_bottom": "16.848", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.034", "ppl": "16.38", "wps": "15298.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1140", "lr": "1.772e-05", "gnorm": "1.067", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "20315"}
2023-02-01 03:57:07 | INFO | train_inner | {"epoch": 2, "loss": "4.242", "moe_gate_loss": "12.9349", "overflow_expert1": "0.018", "overflow_expert2": "17.864", "entropy_gating": "0.412", "expert1_balance_top": "31.71", "expert1_balance_bottom": "16.999", "unused_expert1_count": "0.508", "expert2_balance_top": "32.143", "expert2_balance_bottom": "16.869", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.055", "ppl": "16.62", "wps": "15301.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1150", "lr": "1.77e-05", "gnorm": "1.055", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "20487"}
2023-02-01 03:59:58 | INFO | train_inner | {"epoch": 2, "loss": "4.247", "moe_gate_loss": "12.9597", "overflow_expert1": "0.032", "overflow_expert2": "18.072", "entropy_gating": "0.411", "expert1_balance_top": "31.851", "expert1_balance_bottom": "16.887", "unused_expert1_count": "0.507", "expert2_balance_top": "32.161", "expert2_balance_bottom": "16.815", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.06", "ppl": "16.68", "wps": "15298.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1160", "lr": "1.768e-05", "gnorm": "1.069", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "20658"}
2023-02-01 04:02:50 | INFO | train_inner | {"epoch": 2, "loss": "4.274", "moe_gate_loss": "12.9312", "overflow_expert1": "0.018", "overflow_expert2": "17.915", "entropy_gating": "0.413", "expert1_balance_top": "31.686", "expert1_balance_bottom": "16.988", "unused_expert1_count": "0.51", "expert2_balance_top": "32.233", "expert2_balance_bottom": "16.806", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.088", "ppl": "17", "wps": "15284.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1170", "lr": "1.766e-05", "gnorm": "1.062", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "20829"}
2023-02-01 04:05:41 | INFO | train_inner | {"epoch": 2, "loss": "4.222", "moe_gate_loss": "12.9546", "overflow_expert1": "0.023", "overflow_expert2": "18.113", "entropy_gating": "0.413", "expert1_balance_top": "31.812", "expert1_balance_bottom": "16.905", "unused_expert1_count": "0.51", "expert2_balance_top": "32.182", "expert2_balance_bottom": "16.789", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.035", "ppl": "16.39", "wps": "15287.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1180", "lr": "1.764e-05", "gnorm": "1.084", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "21001"}
2023-02-01 04:08:33 | INFO | train_inner | {"epoch": 2, "loss": "4.237", "moe_gate_loss": "12.9385", "overflow_expert1": "0.011", "overflow_expert2": "17.948", "entropy_gating": "0.413", "expert1_balance_top": "31.759", "expert1_balance_bottom": "16.956", "unused_expert1_count": "0.508", "expert2_balance_top": "32.188", "expert2_balance_bottom": "16.849", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.05", "ppl": "16.56", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1190", "lr": "1.762e-05", "gnorm": "1.064", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "21172"}
2023-02-01 04:11:24 | INFO | train_inner | {"epoch": 2, "loss": "4.223", "moe_gate_loss": "12.9341", "overflow_expert1": "0.013", "overflow_expert2": "17.835", "entropy_gating": "0.411", "expert1_balance_top": "31.72", "expert1_balance_bottom": "17.001", "unused_expert1_count": "0.514", "expert2_balance_top": "32.119", "expert2_balance_bottom": "16.899", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.036", "ppl": "16.41", "wps": "15290.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1200", "lr": "1.76e-05", "gnorm": "1.071", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "21344"}
2023-02-01 04:14:15 | INFO | train_inner | {"epoch": 2, "loss": "4.217", "moe_gate_loss": "12.9467", "overflow_expert1": "0.022", "overflow_expert2": "18.128", "entropy_gating": "0.411", "expert1_balance_top": "31.772", "expert1_balance_bottom": "16.922", "unused_expert1_count": "0.511", "expert2_balance_top": "32.202", "expert2_balance_bottom": "16.775", "unused_expert2_count": "0.464", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.03", "ppl": "16.34", "wps": "15288.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1210", "lr": "1.758e-05", "gnorm": "1.081", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "21515"}
2023-02-01 04:17:07 | INFO | train_inner | {"epoch": 2, "loss": "4.229", "moe_gate_loss": "12.9484", "overflow_expert1": "0.022", "overflow_expert2": "17.908", "entropy_gating": "0.41", "expert1_balance_top": "31.803", "expert1_balance_bottom": "16.932", "unused_expert1_count": "0.512", "expert2_balance_top": "32.162", "expert2_balance_bottom": "16.898", "unused_expert2_count": "0.461", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.042", "ppl": "16.47", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1220", "lr": "1.756e-05", "gnorm": "1.066", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "21687"}
2023-02-01 04:19:58 | INFO | train_inner | {"epoch": 2, "loss": "4.275", "moe_gate_loss": "12.9676", "overflow_expert1": "0.027", "overflow_expert2": "18.317", "entropy_gating": "0.411", "expert1_balance_top": "31.884", "expert1_balance_bottom": "16.83", "unused_expert1_count": "0.511", "expert2_balance_top": "32.256", "expert2_balance_bottom": "16.704", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.088", "ppl": "17.01", "wps": "15297.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1230", "lr": "1.754e-05", "gnorm": "1.107", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "21858"}
2023-02-01 04:22:50 | INFO | train_inner | {"epoch": 2, "loss": "4.208", "moe_gate_loss": "12.9473", "overflow_expert1": "0.025", "overflow_expert2": "17.885", "entropy_gating": "0.412", "expert1_balance_top": "31.789", "expert1_balance_bottom": "16.951", "unused_expert1_count": "0.513", "expert2_balance_top": "32.153", "expert2_balance_bottom": "16.877", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.021", "ppl": "16.24", "wps": "15291.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1240", "lr": "1.752e-05", "gnorm": "1.071", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "22030"}
2023-02-01 04:25:41 | INFO | train_inner | {"epoch": 2, "loss": "4.274", "moe_gate_loss": "12.9261", "overflow_expert1": "0.015", "overflow_expert2": "17.792", "entropy_gating": "0.413", "expert1_balance_top": "31.65", "expert1_balance_bottom": "17.009", "unused_expert1_count": "0.512", "expert2_balance_top": "32.123", "expert2_balance_bottom": "16.869", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.088", "ppl": "17", "wps": "15289.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1250", "lr": "1.75e-05", "gnorm": "1.081", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "22201"}
2023-02-01 04:27:31 | INFO | valid_c4_small/C4_small | {"epoch": 2, "valid_c4_small/C4_small_loss": "4.213", "valid_c4_small/C4_small_moe_gate_loss": "12.5914", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "13.157", "valid_c4_small/C4_small_entropy_gating": "0.445", "valid_c4_small/C4_small_expert1_balance_top": "31.371", "valid_c4_small/C4_small_expert1_balance_bottom": "18.347", "valid_c4_small/C4_small_unused_expert1_count": "0.472", "valid_c4_small/C4_small_expert2_balance_top": "31.643", "valid_c4_small/C4_small_expert2_balance_bottom": "17.886", "valid_c4_small/C4_small_unused_expert2_count": "0.386", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.031", "valid_c4_small/C4_small_ppl": "16.35", "valid_c4_small/C4_small_wps": "52001.3", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "1250", "valid_c4_small/C4_small_best_loss": "4.213"}
2023-02-01 04:27:31 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 1250 updates
2023-02-01 05:09:02 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 2 @ 1250 updates, score 4.213) (writing took 2491.3074326217175 seconds)
2023-02-01 05:11:54 | INFO | train_inner | {"epoch": 2, "loss": "4.303", "moe_gate_loss": "12.9497", "overflow_expert1": "0.016", "overflow_expert2": "18.162", "entropy_gating": "0.412", "expert1_balance_top": "31.795", "expert1_balance_bottom": "16.89", "unused_expert1_count": "0.511", "expert2_balance_top": "32.257", "expert2_balance_bottom": "16.766", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.117", "ppl": "17.35", "wps": "945.4", "ups": "0", "wpb": "262144", "bsz": "128", "num_updates": "1260", "lr": "1.748e-05", "gnorm": "1.101", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "24974"}
2023-02-01 05:14:45 | INFO | train_inner | {"epoch": 2, "loss": "4.243", "moe_gate_loss": "12.9312", "overflow_expert1": "0.016", "overflow_expert2": "18.004", "entropy_gating": "0.412", "expert1_balance_top": "31.694", "expert1_balance_bottom": "16.991", "unused_expert1_count": "0.511", "expert2_balance_top": "32.282", "expert2_balance_bottom": "16.801", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.057", "ppl": "16.64", "wps": "15287.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1270", "lr": "1.746e-05", "gnorm": "1.062", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "25145"}
2023-02-01 05:17:37 | INFO | train_inner | {"epoch": 2, "loss": "4.257", "moe_gate_loss": "12.9382", "overflow_expert1": "0.013", "overflow_expert2": "18.003", "entropy_gating": "0.412", "expert1_balance_top": "31.721", "expert1_balance_bottom": "16.963", "unused_expert1_count": "0.504", "expert2_balance_top": "32.233", "expert2_balance_bottom": "16.821", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.071", "ppl": "16.8", "wps": "15285.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1280", "lr": "1.744e-05", "gnorm": "1.086", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "25317"}
2023-02-01 05:20:28 | INFO | train_inner | {"epoch": 2, "loss": "4.228", "moe_gate_loss": "12.9515", "overflow_expert1": "0.035", "overflow_expert2": "17.782", "entropy_gating": "0.411", "expert1_balance_top": "31.771", "expert1_balance_bottom": "16.994", "unused_expert1_count": "0.505", "expert2_balance_top": "32.136", "expert2_balance_bottom": "16.877", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.041", "ppl": "16.46", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1290", "lr": "1.742e-05", "gnorm": "1.228", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "25488"}
2023-02-01 05:23:20 | INFO | train_inner | {"epoch": 2, "loss": "4.245", "moe_gate_loss": "12.9247", "overflow_expert1": "0.011", "overflow_expert2": "17.919", "entropy_gating": "0.411", "expert1_balance_top": "31.645", "expert1_balance_bottom": "17.024", "unused_expert1_count": "0.51", "expert2_balance_top": "32.209", "expert2_balance_bottom": "16.809", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.058", "ppl": "16.66", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1300", "lr": "1.74e-05", "gnorm": "1.063", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "25660"}
2023-02-01 05:26:11 | INFO | train_inner | {"epoch": 2, "loss": "4.192", "moe_gate_loss": "12.9238", "overflow_expert1": "0.016", "overflow_expert2": "17.684", "entropy_gating": "0.411", "expert1_balance_top": "31.629", "expert1_balance_bottom": "17.06", "unused_expert1_count": "0.502", "expert2_balance_top": "32.143", "expert2_balance_bottom": "16.909", "unused_expert2_count": "0.461", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.006", "ppl": "16.06", "wps": "15291.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1310", "lr": "1.738e-05", "gnorm": "1.061", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "25831"}
2023-02-01 05:29:03 | INFO | train_inner | {"epoch": 2, "loss": "4.212", "moe_gate_loss": "12.9702", "overflow_expert1": "0.032", "overflow_expert2": "18.219", "entropy_gating": "0.409", "expert1_balance_top": "31.858", "expert1_balance_bottom": "16.845", "unused_expert1_count": "0.503", "expert2_balance_top": "32.335", "expert2_balance_bottom": "16.741", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.025", "ppl": "16.28", "wps": "15295.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1320", "lr": "1.736e-05", "gnorm": "1.133", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "26002"}
2023-02-01 05:31:54 | INFO | train_inner | {"epoch": 2, "loss": "4.224", "moe_gate_loss": "12.9323", "overflow_expert1": "0.013", "overflow_expert2": "17.958", "entropy_gating": "0.411", "expert1_balance_top": "31.696", "expert1_balance_bottom": "16.984", "unused_expert1_count": "0.505", "expert2_balance_top": "32.19", "expert2_balance_bottom": "16.828", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.038", "ppl": "16.43", "wps": "15295.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1330", "lr": "1.734e-05", "gnorm": "1.073", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "26174"}
2023-02-01 05:34:45 | INFO | train_inner | {"epoch": 2, "loss": "4.253", "moe_gate_loss": "12.9233", "overflow_expert1": "0.015", "overflow_expert2": "17.674", "entropy_gating": "0.411", "expert1_balance_top": "31.612", "expert1_balance_bottom": "17.056", "unused_expert1_count": "0.503", "expert2_balance_top": "32.128", "expert2_balance_bottom": "16.911", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.067", "ppl": "16.76", "wps": "15288.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1340", "lr": "1.732e-05", "gnorm": "1.07", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "26345"}
2023-02-01 05:37:37 | INFO | train_inner | {"epoch": 2, "loss": "4.218", "moe_gate_loss": "12.9385", "overflow_expert1": "0.017", "overflow_expert2": "17.899", "entropy_gating": "0.41", "expert1_balance_top": "31.746", "expert1_balance_bottom": "16.964", "unused_expert1_count": "0.505", "expert2_balance_top": "32.278", "expert2_balance_bottom": "16.858", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.031", "ppl": "16.35", "wps": "15284.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1350", "lr": "1.73e-05", "gnorm": "1.069", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "26517"}
2023-02-01 05:40:28 | INFO | train_inner | {"epoch": 2, "loss": "4.178", "moe_gate_loss": "12.9194", "overflow_expert1": "0.013", "overflow_expert2": "17.862", "entropy_gating": "0.411", "expert1_balance_top": "31.618", "expert1_balance_bottom": "17.045", "unused_expert1_count": "0.502", "expert2_balance_top": "32.212", "expert2_balance_bottom": "16.818", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.992", "ppl": "15.91", "wps": "15281", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1360", "lr": "1.728e-05", "gnorm": "1.067", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "26688"}
2023-02-01 05:43:37 | INFO | train_inner | {"epoch": 2, "loss": "4.192", "moe_gate_loss": "12.952", "overflow_expert1": "0.02", "overflow_expert2": "18.004", "entropy_gating": "0.409", "expert1_balance_top": "31.788", "expert1_balance_bottom": "16.927", "unused_expert1_count": "0.501", "expert2_balance_top": "32.255", "expert2_balance_bottom": "16.818", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.006", "ppl": "16.06", "wps": "13913.3", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "1370", "lr": "1.726e-05", "gnorm": "1.079", "clip": "100", "loss_scale": "2", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "26877"}
2023-02-01 05:46:28 | INFO | train_inner | {"epoch": 2, "loss": "4.211", "moe_gate_loss": "12.9146", "overflow_expert1": "0.011", "overflow_expert2": "17.632", "entropy_gating": "0.412", "expert1_balance_top": "31.593", "expert1_balance_bottom": "17.059", "unused_expert1_count": "0.495", "expert2_balance_top": "32.163", "expert2_balance_bottom": "16.901", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.025", "ppl": "16.27", "wps": "15285.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1380", "lr": "1.724e-05", "gnorm": "1.073", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "27048"}
2023-02-01 05:49:20 | INFO | train_inner | {"epoch": 2, "loss": "4.189", "moe_gate_loss": "12.9257", "overflow_expert1": "0.015", "overflow_expert2": "17.814", "entropy_gating": "0.412", "expert1_balance_top": "31.643", "expert1_balance_bottom": "17.038", "unused_expert1_count": "0.498", "expert2_balance_top": "32.145", "expert2_balance_bottom": "16.866", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.002", "ppl": "16.02", "wps": "15288.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1390", "lr": "1.722e-05", "gnorm": "1.067", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "27220"}
2023-02-01 05:52:11 | INFO | train_inner | {"epoch": 2, "loss": "4.191", "moe_gate_loss": "12.9295", "overflow_expert1": "0.016", "overflow_expert2": "17.909", "entropy_gating": "0.411", "expert1_balance_top": "31.643", "expert1_balance_bottom": "17.005", "unused_expert1_count": "0.505", "expert2_balance_top": "32.21", "expert2_balance_bottom": "16.764", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.005", "ppl": "16.05", "wps": "15287", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1400", "lr": "1.72e-05", "gnorm": "1.092", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "27391"}
2023-02-01 05:55:03 | INFO | train_inner | {"epoch": 2, "loss": "4.263", "moe_gate_loss": "12.9332", "overflow_expert1": "0.016", "overflow_expert2": "17.852", "entropy_gating": "0.411", "expert1_balance_top": "31.679", "expert1_balance_bottom": "16.994", "unused_expert1_count": "0.502", "expert2_balance_top": "32.265", "expert2_balance_bottom": "16.822", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.077", "ppl": "16.88", "wps": "15289.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1410", "lr": "1.718e-05", "gnorm": "1.071", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "27563"}
2023-02-01 05:57:54 | INFO | train_inner | {"epoch": 2, "loss": "4.184", "moe_gate_loss": "12.911", "overflow_expert1": "0.01", "overflow_expert2": "17.829", "entropy_gating": "0.411", "expert1_balance_top": "31.551", "expert1_balance_bottom": "17.099", "unused_expert1_count": "0.497", "expert2_balance_top": "32.227", "expert2_balance_bottom": "16.801", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.998", "ppl": "15.98", "wps": "15288.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1420", "lr": "1.716e-05", "gnorm": "1.059", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "27734"}
2023-02-01 06:00:46 | INFO | train_inner | {"epoch": 2, "loss": "4.264", "moe_gate_loss": "12.9107", "overflow_expert1": "0.01", "overflow_expert2": "17.525", "entropy_gating": "0.411", "expert1_balance_top": "31.545", "expert1_balance_bottom": "17.102", "unused_expert1_count": "0.501", "expert2_balance_top": "32.13", "expert2_balance_bottom": "16.918", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.077", "ppl": "16.88", "wps": "15286.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1430", "lr": "1.714e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "27906"}
2023-02-01 06:03:37 | INFO | train_inner | {"epoch": 2, "loss": "4.247", "moe_gate_loss": "12.9326", "overflow_expert1": "0.02", "overflow_expert2": "17.9", "entropy_gating": "0.412", "expert1_balance_top": "31.661", "expert1_balance_bottom": "17.007", "unused_expert1_count": "0.503", "expert2_balance_top": "32.234", "expert2_balance_bottom": "16.794", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.06", "ppl": "16.68", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1440", "lr": "1.712e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "28077"}
2023-02-01 06:06:29 | INFO | train_inner | {"epoch": 2, "loss": "4.285", "moe_gate_loss": "12.9059", "overflow_expert1": "0.012", "overflow_expert2": "17.707", "entropy_gating": "0.412", "expert1_balance_top": "31.492", "expert1_balance_bottom": "17.134", "unused_expert1_count": "0.504", "expert2_balance_top": "32.187", "expert2_balance_bottom": "16.825", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.099", "ppl": "17.14", "wps": "15281.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1450", "lr": "1.71e-05", "gnorm": "1.077", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "28249"}
2023-02-01 06:09:20 | INFO | train_inner | {"epoch": 2, "loss": "4.263", "moe_gate_loss": "12.9077", "overflow_expert1": "0.01", "overflow_expert2": "17.577", "entropy_gating": "0.411", "expert1_balance_top": "31.521", "expert1_balance_bottom": "17.127", "unused_expert1_count": "0.499", "expert2_balance_top": "32.198", "expert2_balance_bottom": "16.859", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.077", "ppl": "16.87", "wps": "15289.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1460", "lr": "1.708e-05", "gnorm": "1.073", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "28420"}
2023-02-01 06:12:12 | INFO | train_inner | {"epoch": 2, "loss": "4.251", "moe_gate_loss": "12.894", "overflow_expert1": "0.008", "overflow_expert2": "17.561", "entropy_gating": "0.412", "expert1_balance_top": "31.432", "expert1_balance_bottom": "17.19", "unused_expert1_count": "0.504", "expert2_balance_top": "32.081", "expert2_balance_bottom": "16.862", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.065", "ppl": "16.73", "wps": "15292", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1470", "lr": "1.706e-05", "gnorm": "1.07", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "28592"}
2023-02-01 06:15:03 | INFO | train_inner | {"epoch": 2, "loss": "4.265", "moe_gate_loss": "12.9071", "overflow_expert1": "0.011", "overflow_expert2": "17.608", "entropy_gating": "0.412", "expert1_balance_top": "31.502", "expert1_balance_bottom": "17.114", "unused_expert1_count": "0.506", "expert2_balance_top": "32.197", "expert2_balance_bottom": "16.855", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.079", "ppl": "16.9", "wps": "15295.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1480", "lr": "1.704e-05", "gnorm": "1.064", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "28763"}
2023-02-01 06:17:54 | INFO | train_inner | {"epoch": 2, "loss": "4.228", "moe_gate_loss": "12.9218", "overflow_expert1": "0.017", "overflow_expert2": "17.684", "entropy_gating": "0.413", "expert1_balance_top": "31.604", "expert1_balance_bottom": "17.079", "unused_expert1_count": "0.502", "expert2_balance_top": "32.167", "expert2_balance_bottom": "16.86", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.042", "ppl": "16.47", "wps": "15293.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1490", "lr": "1.702e-05", "gnorm": "1.077", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "28934"}
2023-02-01 06:20:46 | INFO | train_inner | {"epoch": 2, "loss": "4.249", "moe_gate_loss": "12.9095", "overflow_expert1": "0.015", "overflow_expert2": "17.715", "entropy_gating": "0.412", "expert1_balance_top": "31.52", "expert1_balance_bottom": "17.122", "unused_expert1_count": "0.503", "expert2_balance_top": "32.213", "expert2_balance_bottom": "16.848", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.063", "ppl": "16.71", "wps": "15292.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1500", "lr": "1.7e-05", "gnorm": "1.053", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "29106"}
2023-02-01 06:22:35 | INFO | valid_c4_small/C4_small | {"epoch": 2, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.5916", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.994", "valid_c4_small/C4_small_entropy_gating": "0.445", "valid_c4_small/C4_small_expert1_balance_top": "31.386", "valid_c4_small/C4_small_expert1_balance_bottom": "18.355", "valid_c4_small/C4_small_unused_expert1_count": "0.461", "valid_c4_small/C4_small_expert2_balance_top": "31.593", "valid_c4_small/C4_small_expert2_balance_bottom": "17.768", "valid_c4_small/C4_small_unused_expert2_count": "0.377", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.029", "valid_c4_small/C4_small_ppl": "16.32", "valid_c4_small/C4_small_wps": "52077", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "1500", "valid_c4_small/C4_small_best_loss": "4.21"}
2023-02-01 06:22:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 1500 updates
2023-02-01 06:24:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 2 @ 1500 updates, score 4.21) (writing took 141.21038669301197 seconds)
2023-02-01 06:27:47 | INFO | train_inner | {"epoch": 2, "loss": "4.23", "moe_gate_loss": "12.9201", "overflow_expert1": "0.02", "overflow_expert2": "17.673", "entropy_gating": "0.412", "expert1_balance_top": "31.574", "expert1_balance_bottom": "17.102", "unused_expert1_count": "0.498", "expert2_balance_top": "32.144", "expert2_balance_bottom": "16.842", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.044", "ppl": "16.49", "wps": "6217.4", "ups": "0.02", "wpb": "262144", "bsz": "128", "num_updates": "1510", "lr": "1.698e-05", "gnorm": "1.309", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "29527"}
2023-02-01 06:30:39 | INFO | train_inner | {"epoch": 2, "loss": "4.25", "moe_gate_loss": "12.9136", "overflow_expert1": "0.011", "overflow_expert2": "17.601", "entropy_gating": "0.412", "expert1_balance_top": "31.572", "expert1_balance_bottom": "17.105", "unused_expert1_count": "0.498", "expert2_balance_top": "32.191", "expert2_balance_bottom": "16.876", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.064", "ppl": "16.72", "wps": "15288", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1520", "lr": "1.696e-05", "gnorm": "1.072", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "29699"}
2023-02-01 06:33:30 | INFO | train_inner | {"epoch": 2, "loss": "4.225", "moe_gate_loss": "12.8964", "overflow_expert1": "0.007", "overflow_expert2": "17.425", "entropy_gating": "0.412", "expert1_balance_top": "31.455", "expert1_balance_bottom": "17.175", "unused_expert1_count": "0.502", "expert2_balance_top": "32.109", "expert2_balance_bottom": "16.937", "unused_expert2_count": "0.461", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.039", "ppl": "16.44", "wps": "15293.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1530", "lr": "1.694e-05", "gnorm": "1.063", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "29870"}
2023-02-01 06:36:22 | INFO | train_inner | {"epoch": 2, "loss": "4.292", "moe_gate_loss": "12.9021", "overflow_expert1": "0.011", "overflow_expert2": "17.694", "entropy_gating": "0.413", "expert1_balance_top": "31.481", "expert1_balance_bottom": "17.137", "unused_expert1_count": "0.502", "expert2_balance_top": "32.214", "expert2_balance_bottom": "16.823", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.106", "ppl": "17.22", "wps": "15295.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1540", "lr": "1.692e-05", "gnorm": "1.072", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "30042"}
2023-02-01 06:39:13 | INFO | train_inner | {"epoch": 2, "loss": "4.208", "moe_gate_loss": "12.9234", "overflow_expert1": "0.015", "overflow_expert2": "17.619", "entropy_gating": "0.411", "expert1_balance_top": "31.62", "expert1_balance_bottom": "17.066", "unused_expert1_count": "0.499", "expert2_balance_top": "32.144", "expert2_balance_bottom": "16.861", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.022", "ppl": "16.24", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1550", "lr": "1.69e-05", "gnorm": "1.06", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "30213"}
2023-02-01 06:42:05 | INFO | train_inner | {"epoch": 2, "loss": "4.262", "moe_gate_loss": "12.9209", "overflow_expert1": "0.014", "overflow_expert2": "17.928", "entropy_gating": "0.413", "expert1_balance_top": "31.594", "expert1_balance_bottom": "17.079", "unused_expert1_count": "0.498", "expert2_balance_top": "32.312", "expert2_balance_bottom": "16.736", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.076", "ppl": "16.86", "wps": "15291.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1560", "lr": "1.688e-05", "gnorm": "1.059", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "30384"}
2023-02-01 06:44:56 | INFO | train_inner | {"epoch": 2, "loss": "4.224", "moe_gate_loss": "12.9207", "overflow_expert1": "0.015", "overflow_expert2": "17.689", "entropy_gating": "0.412", "expert1_balance_top": "31.59", "expert1_balance_bottom": "17.06", "unused_expert1_count": "0.501", "expert2_balance_top": "32.198", "expert2_balance_bottom": "16.832", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.037", "ppl": "16.42", "wps": "15287.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1570", "lr": "1.686e-05", "gnorm": "1.07", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "30556"}
2023-02-01 06:47:47 | INFO | train_inner | {"epoch": 2, "loss": "4.218", "moe_gate_loss": "12.9182", "overflow_expert1": "0.014", "overflow_expert2": "17.687", "entropy_gating": "0.413", "expert1_balance_top": "31.576", "expert1_balance_bottom": "17.088", "unused_expert1_count": "0.504", "expert2_balance_top": "32.257", "expert2_balance_bottom": "16.838", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.032", "ppl": "16.36", "wps": "15294", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1580", "lr": "1.684e-05", "gnorm": "1.088", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "30727"}
2023-02-01 06:50:39 | INFO | train_inner | {"epoch": 2, "loss": "4.232", "moe_gate_loss": "12.946", "overflow_expert1": "0.015", "overflow_expert2": "18.104", "entropy_gating": "0.412", "expert1_balance_top": "31.76", "expert1_balance_bottom": "16.949", "unused_expert1_count": "0.502", "expert2_balance_top": "32.358", "expert2_balance_bottom": "16.725", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.045", "ppl": "16.51", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1590", "lr": "1.682e-05", "gnorm": "1.24", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "30899"}
2023-02-01 06:53:30 | INFO | train_inner | {"epoch": 2, "loss": "4.233", "moe_gate_loss": "12.8904", "overflow_expert1": "0.008", "overflow_expert2": "17.362", "entropy_gating": "0.412", "expert1_balance_top": "31.409", "expert1_balance_bottom": "17.218", "unused_expert1_count": "0.502", "expert2_balance_top": "32.051", "expert2_balance_bottom": "16.94", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.047", "ppl": "16.53", "wps": "15293", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1600", "lr": "1.68e-05", "gnorm": "1.073", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "31070"}
2023-02-01 06:56:22 | INFO | train_inner | {"epoch": 2, "loss": "4.251", "moe_gate_loss": "12.9046", "overflow_expert1": "0.014", "overflow_expert2": "17.583", "entropy_gating": "0.412", "expert1_balance_top": "31.483", "expert1_balance_bottom": "17.161", "unused_expert1_count": "0.496", "expert2_balance_top": "32.2", "expert2_balance_bottom": "16.842", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.065", "ppl": "16.74", "wps": "15299.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1610", "lr": "1.678e-05", "gnorm": "1.089", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "31242"}
2023-02-01 06:59:13 | INFO | train_inner | {"epoch": 2, "loss": "4.26", "moe_gate_loss": "12.8862", "overflow_expert1": "0.007", "overflow_expert2": "17.309", "entropy_gating": "0.412", "expert1_balance_top": "31.352", "expert1_balance_bottom": "17.228", "unused_expert1_count": "0.501", "expert2_balance_top": "32.128", "expert2_balance_bottom": "16.956", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.074", "ppl": "16.84", "wps": "15294.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1620", "lr": "1.676e-05", "gnorm": "1.072", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "31413"}
2023-02-01 07:02:53 | INFO | valid_c4_small/C4_small | {"epoch": 2, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.6118", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "13.056", "valid_c4_small/C4_small_entropy_gating": "0.445", "valid_c4_small/C4_small_expert1_balance_top": "31.52", "valid_c4_small/C4_small_expert1_balance_bottom": "18.334", "valid_c4_small/C4_small_unused_expert1_count": "0.466", "valid_c4_small/C4_small_expert2_balance_top": "31.653", "valid_c4_small/C4_small_expert2_balance_bottom": "17.799", "valid_c4_small/C4_small_unused_expert2_count": "0.388", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.028", "valid_c4_small/C4_small_ppl": "16.32", "valid_c4_small/C4_small_wps": "52058.3", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "1626", "valid_c4_small/C4_small_best_loss": "4.21"}
2023-02-01 07:02:53 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2023-02-01 07:02:53 | INFO | train | {"epoch": 2, "train_loss": "4.241", "train_moe_gate_loss": "12.9404", "train_overflow_expert1": "0.017", "train_overflow_expert2": "17.988", "train_entropy_gating": "0.412", "train_expert1_balance_top": "31.743", "train_expert1_balance_bottom": "16.949", "train_unused_expert1_count": "0.508", "train_expert2_balance_top": "32.214", "train_expert2_balance_bottom": "16.81", "train_unused_expert2_count": "0.454", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "4.054", "train_ppl": "16.61", "train_wps": "12517.6", "train_ups": "0.05", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "1626", "train_lr": "1.6748e-05", "train_gnorm": "1.091", "train_clip": "100", "train_loss_scale": "2", "train_train_wall": "13560", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "31633"}
2023-02-01 07:02:53 | INFO | fairseq.trainer | begin training epoch 3
2023-02-01 07:04:02 | INFO | train_inner | {"epoch": 3, "loss": "4.229", "moe_gate_loss": "12.9013", "overflow_expert1": "0.012", "overflow_expert2": "17.664", "entropy_gating": "0.413", "expert1_balance_top": "31.458", "expert1_balance_bottom": "17.154", "unused_expert1_count": "0.499", "expert2_balance_top": "32.238", "expert2_balance_bottom": "16.801", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.043", "ppl": "16.48", "wps": "9075.7", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "1630", "lr": "1.674e-05", "gnorm": "1.067", "clip": "100", "loss_scale": "2", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "31702"}
2023-02-01 07:06:53 | INFO | train_inner | {"epoch": 3, "loss": "4.269", "moe_gate_loss": "12.8982", "overflow_expert1": "0.016", "overflow_expert2": "17.579", "entropy_gating": "0.413", "expert1_balance_top": "31.434", "expert1_balance_bottom": "17.18", "unused_expert1_count": "0.498", "expert2_balance_top": "32.239", "expert2_balance_bottom": "16.848", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.083", "ppl": "16.94", "wps": "15297.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1640", "lr": "1.672e-05", "gnorm": "1.052", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "31873"}
2023-02-01 07:09:45 | INFO | train_inner | {"epoch": 3, "loss": "4.195", "moe_gate_loss": "12.9119", "overflow_expert1": "0.01", "overflow_expert2": "18.09", "entropy_gating": "0.413", "expert1_balance_top": "31.539", "expert1_balance_bottom": "17.032", "unused_expert1_count": "0.5", "expert2_balance_top": "32.459", "expert2_balance_bottom": "16.597", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.008", "ppl": "16.09", "wps": "15291.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1650", "lr": "1.67e-05", "gnorm": "1.075", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "32045"}
2023-02-01 07:12:36 | INFO | train_inner | {"epoch": 3, "loss": "4.178", "moe_gate_loss": "12.9211", "overflow_expert1": "0.011", "overflow_expert2": "18.155", "entropy_gating": "0.411", "expert1_balance_top": "31.631", "expert1_balance_bottom": "16.951", "unused_expert1_count": "0.498", "expert2_balance_top": "32.365", "expert2_balance_bottom": "16.66", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.991", "ppl": "15.91", "wps": "15294.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1660", "lr": "1.668e-05", "gnorm": "1.079", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "32216"}
2023-02-01 07:15:27 | INFO | train_inner | {"epoch": 3, "loss": "4.189", "moe_gate_loss": "12.9202", "overflow_expert1": "0.01", "overflow_expert2": "18.184", "entropy_gating": "0.413", "expert1_balance_top": "31.612", "expert1_balance_bottom": "16.958", "unused_expert1_count": "0.495", "expert2_balance_top": "32.299", "expert2_balance_bottom": "16.628", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.003", "ppl": "16.03", "wps": "15293.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1670", "lr": "1.666e-05", "gnorm": "1.078", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "32387"}
2023-02-01 07:18:19 | INFO | train_inner | {"epoch": 3, "loss": "4.125", "moe_gate_loss": "12.9193", "overflow_expert1": "0.012", "overflow_expert2": "17.905", "entropy_gating": "0.412", "expert1_balance_top": "31.611", "expert1_balance_bottom": "16.995", "unused_expert1_count": "0.499", "expert2_balance_top": "32.205", "expert2_balance_bottom": "16.774", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.938", "ppl": "15.33", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1680", "lr": "1.664e-05", "gnorm": "1.074", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "32559"}
2023-02-01 07:21:10 | INFO | train_inner | {"epoch": 3, "loss": "4.161", "moe_gate_loss": "12.9134", "overflow_expert1": "0.01", "overflow_expert2": "17.795", "entropy_gating": "0.411", "expert1_balance_top": "31.579", "expert1_balance_bottom": "17.028", "unused_expert1_count": "0.502", "expert2_balance_top": "32.242", "expert2_balance_bottom": "16.817", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.975", "ppl": "15.72", "wps": "15294.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1690", "lr": "1.662e-05", "gnorm": "1.082", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "32730"}
2023-02-01 07:24:02 | INFO | train_inner | {"epoch": 3, "loss": "4.18", "moe_gate_loss": "12.9245", "overflow_expert1": "0.009", "overflow_expert2": "18.069", "entropy_gating": "0.41", "expert1_balance_top": "31.63", "expert1_balance_bottom": "16.938", "unused_expert1_count": "0.493", "expert2_balance_top": "32.295", "expert2_balance_bottom": "16.729", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.993", "ppl": "15.92", "wps": "15291.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1700", "lr": "1.66e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "32902"}
2023-02-01 07:26:53 | INFO | train_inner | {"epoch": 3, "loss": "4.202", "moe_gate_loss": "12.907", "overflow_expert1": "0.012", "overflow_expert2": "17.729", "entropy_gating": "0.41", "expert1_balance_top": "31.51", "expert1_balance_bottom": "17.087", "unused_expert1_count": "0.495", "expert2_balance_top": "32.159", "expert2_balance_bottom": "16.809", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.016", "ppl": "16.18", "wps": "15297.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1710", "lr": "1.658e-05", "gnorm": "1.094", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "33073"}
2023-02-01 07:29:44 | INFO | train_inner | {"epoch": 3, "loss": "4.167", "moe_gate_loss": "12.9092", "overflow_expert1": "0.006", "overflow_expert2": "17.721", "entropy_gating": "0.411", "expert1_balance_top": "31.522", "expert1_balance_bottom": "17.052", "unused_expert1_count": "0.498", "expert2_balance_top": "32.188", "expert2_balance_bottom": "16.81", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.981", "ppl": "15.79", "wps": "15297.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1720", "lr": "1.656e-05", "gnorm": "1.089", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "33244"}
2023-02-01 07:32:36 | INFO | train_inner | {"epoch": 3, "loss": "4.193", "moe_gate_loss": "12.9083", "overflow_expert1": "0.008", "overflow_expert2": "17.714", "entropy_gating": "0.411", "expert1_balance_top": "31.527", "expert1_balance_bottom": "17.1", "unused_expert1_count": "0.496", "expert2_balance_top": "32.164", "expert2_balance_bottom": "16.845", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.007", "ppl": "16.07", "wps": "15292", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1730", "lr": "1.654e-05", "gnorm": "1.083", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "33416"}
2023-02-01 07:35:27 | INFO | train_inner | {"epoch": 3, "loss": "4.165", "moe_gate_loss": "12.9251", "overflow_expert1": "0.013", "overflow_expert2": "17.979", "entropy_gating": "0.411", "expert1_balance_top": "31.63", "expert1_balance_bottom": "17.008", "unused_expert1_count": "0.5", "expert2_balance_top": "32.304", "expert2_balance_bottom": "16.749", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.979", "ppl": "15.77", "wps": "15293.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1740", "lr": "1.652e-05", "gnorm": "1.102", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "33587"}
2023-02-01 07:38:19 | INFO | train_inner | {"epoch": 3, "loss": "4.183", "moe_gate_loss": "12.9096", "overflow_expert1": "0.01", "overflow_expert2": "17.694", "entropy_gating": "0.412", "expert1_balance_top": "31.542", "expert1_balance_bottom": "17.07", "unused_expert1_count": "0.499", "expert2_balance_top": "32.135", "expert2_balance_bottom": "16.837", "unused_expert2_count": "0.46", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.997", "ppl": "15.97", "wps": "15293.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1750", "lr": "1.65e-05", "gnorm": "1.114", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "33759"}
2023-02-01 07:40:08 | INFO | valid_c4_small/C4_small | {"epoch": 3, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.5977", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "13.154", "valid_c4_small/C4_small_entropy_gating": "0.446", "valid_c4_small/C4_small_expert1_balance_top": "31.376", "valid_c4_small/C4_small_expert1_balance_bottom": "18.329", "valid_c4_small/C4_small_unused_expert1_count": "0.466", "valid_c4_small/C4_small_expert2_balance_top": "31.658", "valid_c4_small/C4_small_expert2_balance_bottom": "17.797", "valid_c4_small/C4_small_unused_expert2_count": "0.391", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.33", "valid_c4_small/C4_small_wps": "52084.7", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "1750", "valid_c4_small/C4_small_best_loss": "4.21"}
2023-02-01 07:40:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 1750 updates
2023-02-01 07:54:10 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 3 @ 1750 updates, score 4.211) (writing took 841.93152096821 seconds)
2023-02-01 07:57:01 | INFO | train_inner | {"epoch": 3, "loss": "4.153", "moe_gate_loss": "12.9323", "overflow_expert1": "0.012", "overflow_expert2": "17.84", "entropy_gating": "0.411", "expert1_balance_top": "31.696", "expert1_balance_bottom": "16.977", "unused_expert1_count": "0.501", "expert2_balance_top": "32.12", "expert2_balance_bottom": "16.847", "unused_expert2_count": "0.464", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.967", "ppl": "15.63", "wps": "2335.8", "ups": "0.01", "wpb": "262144", "bsz": "128", "num_updates": "1760", "lr": "1.648e-05", "gnorm": "1.111", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "34881"}
2023-02-01 07:59:52 | INFO | train_inner | {"epoch": 3, "loss": "4.231", "moe_gate_loss": "12.9096", "overflow_expert1": "0.01", "overflow_expert2": "17.96", "entropy_gating": "0.411", "expert1_balance_top": "31.51", "expert1_balance_bottom": "17.07", "unused_expert1_count": "0.496", "expert2_balance_top": "32.265", "expert2_balance_bottom": "16.744", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.045", "ppl": "16.51", "wps": "15287.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1770", "lr": "1.646e-05", "gnorm": "1.096", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "35052"}
2023-02-01 08:02:44 | INFO | train_inner | {"epoch": 3, "loss": "4.181", "moe_gate_loss": "12.9127", "overflow_expert1": "0.013", "overflow_expert2": "17.591", "entropy_gating": "0.409", "expert1_balance_top": "31.526", "expert1_balance_bottom": "17.082", "unused_expert1_count": "0.498", "expert2_balance_top": "32.053", "expert2_balance_bottom": "16.893", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.995", "ppl": "15.94", "wps": "15297.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1780", "lr": "1.644e-05", "gnorm": "1.121", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "35224"}
2023-02-01 08:05:36 | INFO | train_inner | {"epoch": 3, "loss": "4.199", "moe_gate_loss": "12.9172", "overflow_expert1": "0.012", "overflow_expert2": "17.874", "entropy_gating": "0.41", "expert1_balance_top": "31.571", "expert1_balance_bottom": "17.067", "unused_expert1_count": "0.498", "expert2_balance_top": "32.253", "expert2_balance_bottom": "16.783", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.013", "ppl": "16.14", "wps": "15256.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1790", "lr": "1.642e-05", "gnorm": "1.126", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "35396"}
2023-02-01 08:08:27 | INFO | train_inner | {"epoch": 3, "loss": "4.244", "moe_gate_loss": "12.9516", "overflow_expert1": "0.018", "overflow_expert2": "18.108", "entropy_gating": "0.411", "expert1_balance_top": "31.773", "expert1_balance_bottom": "16.901", "unused_expert1_count": "0.497", "expert2_balance_top": "32.266", "expert2_balance_bottom": "16.761", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.057", "ppl": "16.65", "wps": "15296.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1800", "lr": "1.64e-05", "gnorm": "1.282", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "35567"}
2023-02-01 08:11:19 | INFO | train_inner | {"epoch": 3, "loss": "4.199", "moe_gate_loss": "12.9163", "overflow_expert1": "0.012", "overflow_expert2": "17.722", "entropy_gating": "0.411", "expert1_balance_top": "31.556", "expert1_balance_bottom": "17.072", "unused_expert1_count": "0.496", "expert2_balance_top": "32.136", "expert2_balance_bottom": "16.875", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.012", "ppl": "16.14", "wps": "15284.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1810", "lr": "1.638e-05", "gnorm": "1.102", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "35738"}
2023-02-01 08:14:10 | INFO | train_inner | {"epoch": 3, "loss": "4.195", "moe_gate_loss": "12.9048", "overflow_expert1": "0.008", "overflow_expert2": "17.601", "entropy_gating": "0.411", "expert1_balance_top": "31.499", "expert1_balance_bottom": "17.102", "unused_expert1_count": "0.499", "expert2_balance_top": "32.161", "expert2_balance_bottom": "16.888", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.008", "ppl": "16.09", "wps": "15288.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1820", "lr": "1.636e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "35910"}
2023-02-01 08:17:02 | INFO | train_inner | {"epoch": 3, "loss": "4.167", "moe_gate_loss": "12.9264", "overflow_expert1": "0.01", "overflow_expert2": "17.968", "entropy_gating": "0.409", "expert1_balance_top": "31.626", "expert1_balance_bottom": "16.999", "unused_expert1_count": "0.496", "expert2_balance_top": "32.242", "expert2_balance_bottom": "16.777", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.981", "ppl": "15.79", "wps": "15282.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1830", "lr": "1.634e-05", "gnorm": "1.126", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "36081"}
2023-02-01 08:19:53 | INFO | train_inner | {"epoch": 3, "loss": "4.18", "moe_gate_loss": "12.9315", "overflow_expert1": "0.017", "overflow_expert2": "17.781", "entropy_gating": "0.409", "expert1_balance_top": "31.661", "expert1_balance_bottom": "17.008", "unused_expert1_count": "0.496", "expert2_balance_top": "32.157", "expert2_balance_bottom": "16.864", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.994", "ppl": "15.93", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1840", "lr": "1.632e-05", "gnorm": "1.119", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "36253"}
2023-02-01 08:22:44 | INFO | train_inner | {"epoch": 3, "loss": "4.203", "moe_gate_loss": "12.9078", "overflow_expert1": "0.011", "overflow_expert2": "17.678", "entropy_gating": "0.41", "expert1_balance_top": "31.504", "expert1_balance_bottom": "17.1", "unused_expert1_count": "0.5", "expert2_balance_top": "32.194", "expert2_balance_bottom": "16.867", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.017", "ppl": "16.19", "wps": "15294.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1850", "lr": "1.63e-05", "gnorm": "1.098", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "36424"}
2023-02-01 08:25:36 | INFO | train_inner | {"epoch": 3, "loss": "4.19", "moe_gate_loss": "12.9076", "overflow_expert1": "0.018", "overflow_expert2": "17.508", "entropy_gating": "0.411", "expert1_balance_top": "31.48", "expert1_balance_bottom": "17.162", "unused_expert1_count": "0.493", "expert2_balance_top": "32.127", "expert2_balance_bottom": "16.909", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.004", "ppl": "16.04", "wps": "15284.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1860", "lr": "1.628e-05", "gnorm": "1.111", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "36596"}
2023-02-01 08:28:27 | INFO | train_inner | {"epoch": 3, "loss": "4.167", "moe_gate_loss": "12.9251", "overflow_expert1": "0.014", "overflow_expert2": "17.901", "entropy_gating": "0.409", "expert1_balance_top": "31.592", "expert1_balance_bottom": "17.028", "unused_expert1_count": "0.497", "expert2_balance_top": "32.241", "expert2_balance_bottom": "16.786", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.981", "ppl": "15.79", "wps": "15288.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1870", "lr": "1.626e-05", "gnorm": "1.103", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "36767"}
2023-02-01 08:31:19 | INFO | train_inner | {"epoch": 3, "loss": "4.174", "moe_gate_loss": "12.9082", "overflow_expert1": "0.014", "overflow_expert2": "17.579", "entropy_gating": "0.41", "expert1_balance_top": "31.492", "expert1_balance_bottom": "17.114", "unused_expert1_count": "0.495", "expert2_balance_top": "32.112", "expert2_balance_bottom": "16.889", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.987", "ppl": "15.86", "wps": "15298.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1880", "lr": "1.624e-05", "gnorm": "1.097", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "36939"}
2023-02-01 08:34:10 | INFO | train_inner | {"epoch": 3, "loss": "4.179", "moe_gate_loss": "12.9022", "overflow_expert1": "0.008", "overflow_expert2": "17.495", "entropy_gating": "0.41", "expert1_balance_top": "31.49", "expert1_balance_bottom": "17.143", "unused_expert1_count": "0.497", "expert2_balance_top": "32.131", "expert2_balance_bottom": "16.905", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.993", "ppl": "15.92", "wps": "15290.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1890", "lr": "1.622e-05", "gnorm": "1.095", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "37110"}
2023-02-01 08:37:02 | INFO | train_inner | {"epoch": 3, "loss": "4.221", "moe_gate_loss": "12.9055", "overflow_expert1": "0.009", "overflow_expert2": "17.673", "entropy_gating": "0.41", "expert1_balance_top": "31.489", "expert1_balance_bottom": "17.128", "unused_expert1_count": "0.495", "expert2_balance_top": "32.169", "expert2_balance_bottom": "16.845", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.035", "ppl": "16.39", "wps": "15286.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1900", "lr": "1.62e-05", "gnorm": "1.101", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "37282"}
2023-02-01 08:39:53 | INFO | train_inner | {"epoch": 3, "loss": "4.148", "moe_gate_loss": "12.9282", "overflow_expert1": "0.014", "overflow_expert2": "17.905", "entropy_gating": "0.409", "expert1_balance_top": "31.65", "expert1_balance_bottom": "17.013", "unused_expert1_count": "0.495", "expert2_balance_top": "32.217", "expert2_balance_bottom": "16.809", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.962", "ppl": "15.58", "wps": "15293.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1910", "lr": "1.618e-05", "gnorm": "1.099", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "37453"}
2023-02-01 08:42:45 | INFO | train_inner | {"epoch": 3, "loss": "4.223", "moe_gate_loss": "12.9137", "overflow_expert1": "0.012", "overflow_expert2": "17.608", "entropy_gating": "0.409", "expert1_balance_top": "31.555", "expert1_balance_bottom": "17.09", "unused_expert1_count": "0.495", "expert2_balance_top": "32.135", "expert2_balance_bottom": "16.866", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.036", "ppl": "16.41", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1920", "lr": "1.616e-05", "gnorm": "1.094", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "37624"}
2023-02-01 08:45:36 | INFO | train_inner | {"epoch": 3, "loss": "4.227", "moe_gate_loss": "12.9036", "overflow_expert1": "0.01", "overflow_expert2": "17.61", "entropy_gating": "0.409", "expert1_balance_top": "31.479", "expert1_balance_bottom": "17.13", "unused_expert1_count": "0.496", "expert2_balance_top": "32.144", "expert2_balance_bottom": "16.882", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.041", "ppl": "16.46", "wps": "15284.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1930", "lr": "1.614e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "37796"}
2023-02-01 08:48:28 | INFO | train_inner | {"epoch": 3, "loss": "4.207", "moe_gate_loss": "12.932", "overflow_expert1": "0.016", "overflow_expert2": "17.835", "entropy_gating": "0.408", "expert1_balance_top": "31.663", "expert1_balance_bottom": "17.02", "unused_expert1_count": "0.492", "expert2_balance_top": "32.226", "expert2_balance_bottom": "16.83", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.02", "ppl": "16.22", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1940", "lr": "1.612e-05", "gnorm": "1.109", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "37968"}
2023-02-01 08:51:19 | INFO | train_inner | {"epoch": 3, "loss": "4.151", "moe_gate_loss": "12.93", "overflow_expert1": "0.017", "overflow_expert2": "17.854", "entropy_gating": "0.408", "expert1_balance_top": "31.673", "expert1_balance_bottom": "17.02", "unused_expert1_count": "0.494", "expert2_balance_top": "32.222", "expert2_balance_bottom": "16.825", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.964", "ppl": "15.61", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1950", "lr": "1.61e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "38139"}
2023-02-01 08:54:10 | INFO | train_inner | {"epoch": 3, "loss": "4.159", "moe_gate_loss": "12.9013", "overflow_expert1": "0.01", "overflow_expert2": "17.618", "entropy_gating": "0.409", "expert1_balance_top": "31.479", "expert1_balance_bottom": "17.13", "unused_expert1_count": "0.493", "expert2_balance_top": "32.148", "expert2_balance_bottom": "16.864", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.973", "ppl": "15.7", "wps": "15296.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1960", "lr": "1.608e-05", "gnorm": "1.097", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "38310"}
2023-02-01 08:57:02 | INFO | train_inner | {"epoch": 3, "loss": "4.184", "moe_gate_loss": "12.9049", "overflow_expert1": "0.011", "overflow_expert2": "17.537", "entropy_gating": "0.409", "expert1_balance_top": "31.485", "expert1_balance_bottom": "17.15", "unused_expert1_count": "0.495", "expert2_balance_top": "32.16", "expert2_balance_bottom": "16.91", "unused_expert2_count": "0.458", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.998", "ppl": "15.98", "wps": "15290.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1970", "lr": "1.606e-05", "gnorm": "1.094", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "38482"}
2023-02-01 08:59:53 | INFO | train_inner | {"epoch": 3, "loss": "4.227", "moe_gate_loss": "12.9097", "overflow_expert1": "0.018", "overflow_expert2": "17.677", "entropy_gating": "0.409", "expert1_balance_top": "31.485", "expert1_balance_bottom": "17.125", "unused_expert1_count": "0.493", "expert2_balance_top": "32.167", "expert2_balance_bottom": "16.819", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.04", "ppl": "16.45", "wps": "15287.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1980", "lr": "1.604e-05", "gnorm": "1.089", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "38653"}
2023-02-01 09:02:45 | INFO | train_inner | {"epoch": 3, "loss": "4.187", "moe_gate_loss": "12.9065", "overflow_expert1": "0.017", "overflow_expert2": "17.678", "entropy_gating": "0.409", "expert1_balance_top": "31.478", "expert1_balance_bottom": "17.15", "unused_expert1_count": "0.493", "expert2_balance_top": "32.201", "expert2_balance_bottom": "16.828", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.001", "ppl": "16.01", "wps": "15284.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "1990", "lr": "1.602e-05", "gnorm": "1.105", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "38825"}
2023-02-01 09:05:36 | INFO | train_inner | {"epoch": 3, "loss": "4.187", "moe_gate_loss": "12.9105", "overflow_expert1": "0.011", "overflow_expert2": "17.712", "entropy_gating": "0.41", "expert1_balance_top": "31.516", "expert1_balance_bottom": "17.11", "unused_expert1_count": "0.49", "expert2_balance_top": "32.248", "expert2_balance_bottom": "16.833", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.001", "ppl": "16.01", "wps": "15281", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2000", "lr": "1.6e-05", "gnorm": "1.103", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "38996"}
2023-02-01 09:07:26 | INFO | valid_c4_small/C4_small | {"epoch": 3, "valid_c4_small/C4_small_loss": "4.209", "valid_c4_small/C4_small_moe_gate_loss": "12.6076", "valid_c4_small/C4_small_overflow_expert1": "0.001", "valid_c4_small/C4_small_overflow_expert2": "12.831", "valid_c4_small/C4_small_entropy_gating": "0.441", "valid_c4_small/C4_small_expert1_balance_top": "31.512", "valid_c4_small/C4_small_expert1_balance_bottom": "18.344", "valid_c4_small/C4_small_unused_expert1_count": "0.464", "valid_c4_small/C4_small_expert2_balance_top": "31.68", "valid_c4_small/C4_small_expert2_balance_bottom": "17.927", "valid_c4_small/C4_small_unused_expert2_count": "0.376", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.028", "valid_c4_small/C4_small_ppl": "16.31", "valid_c4_small/C4_small_wps": "52010.1", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "2000", "valid_c4_small/C4_small_best_loss": "4.209"}
2023-02-01 09:07:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 2000 updates
2023-02-01 09:07:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 3 @ 2000 updates, score 4.209) (writing took 7.787493246141821 seconds)
2023-02-01 09:10:26 | INFO | train_inner | {"epoch": 3, "loss": "4.171", "moe_gate_loss": "12.9061", "overflow_expert1": "0.008", "overflow_expert2": "17.585", "entropy_gating": "0.409", "expert1_balance_top": "31.516", "expert1_balance_bottom": "17.114", "unused_expert1_count": "0.488", "expert2_balance_top": "32.136", "expert2_balance_bottom": "16.879", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.984", "ppl": "15.83", "wps": "9044.6", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "2010", "lr": "1.598e-05", "gnorm": "1.1", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "39286"}
2023-02-01 09:13:18 | INFO | train_inner | {"epoch": 3, "loss": "4.194", "moe_gate_loss": "12.9101", "overflow_expert1": "0.009", "overflow_expert2": "17.657", "entropy_gating": "0.408", "expert1_balance_top": "31.532", "expert1_balance_bottom": "17.121", "unused_expert1_count": "0.496", "expert2_balance_top": "32.188", "expert2_balance_bottom": "16.899", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.008", "ppl": "16.09", "wps": "15284.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2020", "lr": "1.596e-05", "gnorm": "1.108", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "39458"}
2023-02-01 09:16:09 | INFO | train_inner | {"epoch": 3, "loss": "4.167", "moe_gate_loss": "12.9133", "overflow_expert1": "0.018", "overflow_expert2": "17.687", "entropy_gating": "0.409", "expert1_balance_top": "31.545", "expert1_balance_bottom": "17.106", "unused_expert1_count": "0.495", "expert2_balance_top": "32.232", "expert2_balance_bottom": "16.827", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.98", "ppl": "15.78", "wps": "15285.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2030", "lr": "1.594e-05", "gnorm": "1.112", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "39629"}
2023-02-01 09:19:01 | INFO | train_inner | {"epoch": 3, "loss": "4.164", "moe_gate_loss": "12.9241", "overflow_expert1": "0.018", "overflow_expert2": "17.727", "entropy_gating": "0.407", "expert1_balance_top": "31.607", "expert1_balance_bottom": "17.067", "unused_expert1_count": "0.493", "expert2_balance_top": "32.202", "expert2_balance_bottom": "16.843", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.977", "ppl": "15.75", "wps": "15286.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2040", "lr": "1.592e-05", "gnorm": "1.121", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "39801"}
2023-02-01 09:21:52 | INFO | train_inner | {"epoch": 3, "loss": "4.198", "moe_gate_loss": "12.9225", "overflow_expert1": "0.014", "overflow_expert2": "17.969", "entropy_gating": "0.409", "expert1_balance_top": "31.599", "expert1_balance_bottom": "17.028", "unused_expert1_count": "0.494", "expert2_balance_top": "32.28", "expert2_balance_bottom": "16.72", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.011", "ppl": "16.13", "wps": "15290.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2050", "lr": "1.59e-05", "gnorm": "1.115", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "39972"}
2023-02-01 09:24:44 | INFO | train_inner | {"epoch": 3, "loss": "4.187", "moe_gate_loss": "12.9079", "overflow_expert1": "0.02", "overflow_expert2": "17.426", "entropy_gating": "0.409", "expert1_balance_top": "31.498", "expert1_balance_bottom": "17.154", "unused_expert1_count": "0.493", "expert2_balance_top": "32.125", "expert2_balance_bottom": "16.943", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.001", "ppl": "16.01", "wps": "15298.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2060", "lr": "1.588e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "40143"}
2023-02-01 09:27:35 | INFO | train_inner | {"epoch": 3, "loss": "4.187", "moe_gate_loss": "12.9004", "overflow_expert1": "0.01", "overflow_expert2": "17.618", "entropy_gating": "0.409", "expert1_balance_top": "31.437", "expert1_balance_bottom": "17.145", "unused_expert1_count": "0.49", "expert2_balance_top": "32.173", "expert2_balance_bottom": "16.865", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4", "ppl": "16", "wps": "15286.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2070", "lr": "1.586e-05", "gnorm": "1.119", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "40315"}
2023-02-01 09:30:27 | INFO | train_inner | {"epoch": 3, "loss": "4.262", "moe_gate_loss": "12.9148", "overflow_expert1": "0.011", "overflow_expert2": "17.706", "entropy_gating": "0.409", "expert1_balance_top": "31.548", "expert1_balance_bottom": "17.087", "unused_expert1_count": "0.49", "expert2_balance_top": "32.215", "expert2_balance_bottom": "16.822", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.076", "ppl": "16.87", "wps": "15286.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2080", "lr": "1.584e-05", "gnorm": "1.144", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "40486"}
2023-02-01 09:33:18 | INFO | train_inner | {"epoch": 3, "loss": "4.21", "moe_gate_loss": "12.8938", "overflow_expert1": "0.005", "overflow_expert2": "17.588", "entropy_gating": "0.408", "expert1_balance_top": "31.401", "expert1_balance_bottom": "17.17", "unused_expert1_count": "0.49", "expert2_balance_top": "32.193", "expert2_balance_bottom": "16.852", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.024", "ppl": "16.27", "wps": "15286.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2090", "lr": "1.582e-05", "gnorm": "1.095", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "40658"}
2023-02-01 09:36:09 | INFO | train_inner | {"epoch": 3, "loss": "4.154", "moe_gate_loss": "12.9051", "overflow_expert1": "0.01", "overflow_expert2": "17.586", "entropy_gating": "0.408", "expert1_balance_top": "31.499", "expert1_balance_bottom": "17.137", "unused_expert1_count": "0.489", "expert2_balance_top": "32.19", "expert2_balance_bottom": "16.891", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.968", "ppl": "15.64", "wps": "15284.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2100", "lr": "1.58e-05", "gnorm": "1.104", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "40829"}
2023-02-01 09:39:01 | INFO | train_inner | {"epoch": 3, "loss": "4.189", "moe_gate_loss": "12.9276", "overflow_expert1": "0.039", "overflow_expert2": "17.645", "entropy_gating": "0.409", "expert1_balance_top": "31.592", "expert1_balance_bottom": "17.112", "unused_expert1_count": "0.492", "expert2_balance_top": "32.209", "expert2_balance_bottom": "16.845", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.003", "ppl": "16.03", "wps": "15291.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2110", "lr": "1.578e-05", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "41001"}
2023-02-01 09:41:59 | INFO | train_inner | {"epoch": 3, "loss": "4.186", "moe_gate_loss": "12.8975", "overflow_expert1": "0.01", "overflow_expert2": "17.621", "entropy_gating": "0.408", "expert1_balance_top": "31.421", "expert1_balance_bottom": "17.167", "unused_expert1_count": "0.493", "expert2_balance_top": "32.228", "expert2_balance_bottom": "16.871", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4", "ppl": "16", "wps": "14745.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2120", "lr": "1.576e-05", "gnorm": "1.093", "clip": "100", "loss_scale": "4", "train_wall": "172", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "41179"}
2023-02-01 09:44:51 | INFO | train_inner | {"epoch": 3, "loss": "4.157", "moe_gate_loss": "12.8889", "overflow_expert1": "0.009", "overflow_expert2": "17.382", "entropy_gating": "0.408", "expert1_balance_top": "31.385", "expert1_balance_bottom": "17.235", "unused_expert1_count": "0.495", "expert2_balance_top": "32.175", "expert2_balance_bottom": "16.908", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.971", "ppl": "15.68", "wps": "15212.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2130", "lr": "1.574e-05", "gnorm": "1.094", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "41351"}
2023-02-01 09:47:42 | INFO | train_inner | {"epoch": 3, "loss": "4.157", "moe_gate_loss": "12.9401", "overflow_expert1": "0.027", "overflow_expert2": "18.097", "entropy_gating": "0.407", "expert1_balance_top": "31.671", "expert1_balance_bottom": "16.981", "unused_expert1_count": "0.491", "expert2_balance_top": "32.378", "expert2_balance_bottom": "16.721", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.97", "ppl": "15.67", "wps": "15301.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2140", "lr": "1.572e-05", "gnorm": "1.17", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "41522"}
2023-02-01 09:50:51 | INFO | train_inner | {"epoch": 3, "loss": "4.167", "moe_gate_loss": "12.8968", "overflow_expert1": "0.009", "overflow_expert2": "17.53", "entropy_gating": "0.406", "expert1_balance_top": "31.425", "expert1_balance_bottom": "17.178", "unused_expert1_count": "0.491", "expert2_balance_top": "32.106", "expert2_balance_bottom": "16.877", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.98", "ppl": "15.78", "wps": "13902.5", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "2150", "lr": "1.57e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "4", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "41711"}
2023-02-01 09:53:42 | INFO | train_inner | {"epoch": 3, "loss": "4.197", "moe_gate_loss": "12.9031", "overflow_expert1": "0.007", "overflow_expert2": "17.619", "entropy_gating": "0.407", "expert1_balance_top": "31.482", "expert1_balance_bottom": "17.146", "unused_expert1_count": "0.488", "expert2_balance_top": "32.217", "expert2_balance_bottom": "16.88", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.011", "ppl": "16.12", "wps": "15285.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2160", "lr": "1.568e-05", "gnorm": "1.132", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "41882"}
2023-02-01 09:56:34 | INFO | train_inner | {"epoch": 3, "loss": "4.15", "moe_gate_loss": "12.9077", "overflow_expert1": "0.014", "overflow_expert2": "17.587", "entropy_gating": "0.407", "expert1_balance_top": "31.519", "expert1_balance_bottom": "17.121", "unused_expert1_count": "0.493", "expert2_balance_top": "32.203", "expert2_balance_bottom": "16.868", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.964", "ppl": "15.61", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2170", "lr": "1.566e-05", "gnorm": "1.113", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "42054"}
2023-02-01 09:59:42 | INFO | train_inner | {"epoch": 3, "loss": "4.109", "moe_gate_loss": "12.898", "overflow_expert1": "0.011", "overflow_expert2": "17.658", "entropy_gating": "0.408", "expert1_balance_top": "31.437", "expert1_balance_bottom": "17.165", "unused_expert1_count": "0.488", "expert2_balance_top": "32.241", "expert2_balance_bottom": "16.829", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.923", "ppl": "15.17", "wps": "13899.9", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "2180", "lr": "1.564e-05", "gnorm": "1.097", "clip": "100", "loss_scale": "2", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "42242"}
2023-02-01 10:02:38 | INFO | train_inner | {"epoch": 3, "loss": "4.152", "moe_gate_loss": "12.9071", "overflow_expert1": "0.012", "overflow_expert2": "17.693", "entropy_gating": "0.407", "expert1_balance_top": "31.507", "expert1_balance_bottom": "17.115", "unused_expert1_count": "0.492", "expert2_balance_top": "32.258", "expert2_balance_bottom": "16.85", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.966", "ppl": "15.63", "wps": "14921.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2190", "lr": "1.562e-05", "gnorm": "1.102", "clip": "100", "loss_scale": "2", "train_wall": "170", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "42418"}
2023-02-01 10:05:30 | INFO | train_inner | {"epoch": 3, "loss": "4.152", "moe_gate_loss": "12.8968", "overflow_expert1": "0.009", "overflow_expert2": "17.497", "entropy_gating": "0.409", "expert1_balance_top": "31.432", "expert1_balance_bottom": "17.179", "unused_expert1_count": "0.486", "expert2_balance_top": "32.168", "expert2_balance_bottom": "16.904", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.966", "ppl": "15.62", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2200", "lr": "1.56e-05", "gnorm": "1.142", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "42590"}
2023-02-01 10:08:21 | INFO | train_inner | {"epoch": 3, "loss": "4.131", "moe_gate_loss": "12.8965", "overflow_expert1": "0.013", "overflow_expert2": "17.474", "entropy_gating": "0.408", "expert1_balance_top": "31.401", "expert1_balance_bottom": "17.177", "unused_expert1_count": "0.489", "expert2_balance_top": "32.2", "expert2_balance_bottom": "16.863", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.945", "ppl": "15.4", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2210", "lr": "1.558e-05", "gnorm": "1.129", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "42761"}
2023-02-01 10:11:13 | INFO | train_inner | {"epoch": 3, "loss": "4.167", "moe_gate_loss": "12.9074", "overflow_expert1": "0.01", "overflow_expert2": "17.657", "entropy_gating": "0.407", "expert1_balance_top": "31.49", "expert1_balance_bottom": "17.133", "unused_expert1_count": "0.493", "expert2_balance_top": "32.211", "expert2_balance_bottom": "16.824", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.981", "ppl": "15.79", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2220", "lr": "1.556e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "42932"}
2023-02-01 10:14:04 | INFO | train_inner | {"epoch": 3, "loss": "4.184", "moe_gate_loss": "12.8843", "overflow_expert1": "0.01", "overflow_expert2": "17.312", "entropy_gating": "0.408", "expert1_balance_top": "31.348", "expert1_balance_bottom": "17.236", "unused_expert1_count": "0.491", "expert2_balance_top": "32.1", "expert2_balance_bottom": "16.939", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.998", "ppl": "15.98", "wps": "15296.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2230", "lr": "1.554e-05", "gnorm": "1.098", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "43104"}
2023-02-01 10:16:55 | INFO | train_inner | {"epoch": 3, "loss": "4.184", "moe_gate_loss": "12.8854", "overflow_expert1": "0.006", "overflow_expert2": "17.518", "entropy_gating": "0.408", "expert1_balance_top": "31.362", "expert1_balance_bottom": "17.22", "unused_expert1_count": "0.489", "expert2_balance_top": "32.213", "expert2_balance_bottom": "16.842", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.999", "ppl": "15.98", "wps": "15294.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2240", "lr": "1.552e-05", "gnorm": "1.115", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "43275"}
2023-02-01 10:19:47 | INFO | train_inner | {"epoch": 3, "loss": "4.21", "moe_gate_loss": "12.8958", "overflow_expert1": "0.013", "overflow_expert2": "17.388", "entropy_gating": "0.407", "expert1_balance_top": "31.434", "expert1_balance_bottom": "17.177", "unused_expert1_count": "0.493", "expert2_balance_top": "32.124", "expert2_balance_bottom": "16.928", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.024", "ppl": "16.26", "wps": "15291.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2250", "lr": "1.55e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "43447"}
2023-02-01 10:21:36 | INFO | valid_c4_small/C4_small | {"epoch": 3, "valid_c4_small/C4_small_loss": "4.208", "valid_c4_small/C4_small_moe_gate_loss": "12.5957", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.916", "valid_c4_small/C4_small_entropy_gating": "0.441", "valid_c4_small/C4_small_expert1_balance_top": "31.459", "valid_c4_small/C4_small_expert1_balance_bottom": "18.286", "valid_c4_small/C4_small_unused_expert1_count": "0.469", "valid_c4_small/C4_small_expert2_balance_top": "31.542", "valid_c4_small/C4_small_expert2_balance_bottom": "17.922", "valid_c4_small/C4_small_unused_expert2_count": "0.385", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.027", "valid_c4_small/C4_small_ppl": "16.3", "valid_c4_small/C4_small_wps": "52092.8", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "2250", "valid_c4_small/C4_small_best_loss": "4.208"}
2023-02-01 10:21:36 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 2250 updates
2023-02-01 10:21:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 3 @ 2250 updates, score 4.208) (writing took 7.526451864745468 seconds)
2023-02-01 10:24:36 | INFO | train_inner | {"epoch": 3, "loss": "4.178", "moe_gate_loss": "12.8852", "overflow_expert1": "0.008", "overflow_expert2": "17.332", "entropy_gating": "0.409", "expert1_balance_top": "31.348", "expert1_balance_bottom": "17.237", "unused_expert1_count": "0.493", "expert2_balance_top": "32.108", "expert2_balance_bottom": "16.935", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.992", "ppl": "15.91", "wps": "9058.4", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "2260", "lr": "1.548e-05", "gnorm": "1.106", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "43736"}
2023-02-01 10:27:28 | INFO | train_inner | {"epoch": 3, "loss": "4.24", "moe_gate_loss": "12.8911", "overflow_expert1": "0.01", "overflow_expert2": "17.589", "entropy_gating": "0.408", "expert1_balance_top": "31.371", "expert1_balance_bottom": "17.217", "unused_expert1_count": "0.486", "expert2_balance_top": "32.187", "expert2_balance_bottom": "16.818", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.054", "ppl": "16.6", "wps": "15288.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2270", "lr": "1.546e-05", "gnorm": "1.107", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "43908"}
2023-02-01 10:30:19 | INFO | train_inner | {"epoch": 3, "loss": "4.203", "moe_gate_loss": "12.8714", "overflow_expert1": "0.006", "overflow_expert2": "17.096", "entropy_gating": "0.408", "expert1_balance_top": "31.273", "expert1_balance_bottom": "17.3", "unused_expert1_count": "0.495", "expert2_balance_top": "32.039", "expert2_balance_bottom": "16.978", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.018", "ppl": "16.2", "wps": "15287.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2280", "lr": "1.544e-05", "gnorm": "1.098", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "44079"}
2023-02-01 10:33:11 | INFO | train_inner | {"epoch": 3, "loss": "4.191", "moe_gate_loss": "12.8754", "overflow_expert1": "0.006", "overflow_expert2": "17.286", "entropy_gating": "0.409", "expert1_balance_top": "31.294", "expert1_balance_bottom": "17.295", "unused_expert1_count": "0.492", "expert2_balance_top": "32.067", "expert2_balance_bottom": "16.923", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.006", "ppl": "16.06", "wps": "15293.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2290", "lr": "1.542e-05", "gnorm": "1.102", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "44250"}
2023-02-01 10:36:02 | INFO | train_inner | {"epoch": 3, "loss": "4.247", "moe_gate_loss": "12.8816", "overflow_expert1": "0.011", "overflow_expert2": "17.331", "entropy_gating": "0.409", "expert1_balance_top": "31.304", "expert1_balance_bottom": "17.266", "unused_expert1_count": "0.494", "expert2_balance_top": "32.15", "expert2_balance_bottom": "16.887", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.061", "ppl": "16.69", "wps": "15286.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2300", "lr": "1.54e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "44422"}
2023-02-01 10:38:53 | INFO | train_inner | {"epoch": 3, "loss": "4.173", "moe_gate_loss": "12.8959", "overflow_expert1": "0.012", "overflow_expert2": "17.442", "entropy_gating": "0.408", "expert1_balance_top": "31.419", "expert1_balance_bottom": "17.196", "unused_expert1_count": "0.49", "expert2_balance_top": "32.13", "expert2_balance_bottom": "16.907", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.987", "ppl": "15.85", "wps": "15290.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2310", "lr": "1.538e-05", "gnorm": "1.093", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "44593"}
2023-02-01 10:41:45 | INFO | train_inner | {"epoch": 3, "loss": "4.18", "moe_gate_loss": "12.8878", "overflow_expert1": "0.015", "overflow_expert2": "17.389", "entropy_gating": "0.408", "expert1_balance_top": "31.343", "expert1_balance_bottom": "17.242", "unused_expert1_count": "0.487", "expert2_balance_top": "32.168", "expert2_balance_bottom": "16.893", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.994", "ppl": "15.93", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2320", "lr": "1.536e-05", "gnorm": "1.136", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "44765"}
2023-02-01 10:44:36 | INFO | train_inner | {"epoch": 3, "loss": "4.168", "moe_gate_loss": "12.883", "overflow_expert1": "0.01", "overflow_expert2": "17.305", "entropy_gating": "0.408", "expert1_balance_top": "31.316", "expert1_balance_bottom": "17.272", "unused_expert1_count": "0.488", "expert2_balance_top": "32.118", "expert2_balance_bottom": "16.89", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.982", "ppl": "15.8", "wps": "15286.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2330", "lr": "1.534e-05", "gnorm": "1.096", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "44936"}
2023-02-01 10:47:28 | INFO | train_inner | {"epoch": 3, "loss": "4.177", "moe_gate_loss": "12.8795", "overflow_expert1": "0.006", "overflow_expert2": "17.319", "entropy_gating": "0.409", "expert1_balance_top": "31.317", "expert1_balance_bottom": "17.272", "unused_expert1_count": "0.489", "expert2_balance_top": "32.105", "expert2_balance_bottom": "16.904", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.991", "ppl": "15.9", "wps": "15288.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2340", "lr": "1.532e-05", "gnorm": "1.089", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "45108"}
2023-02-01 10:50:19 | INFO | train_inner | {"epoch": 3, "loss": "4.206", "moe_gate_loss": "12.8753", "overflow_expert1": "0.009", "overflow_expert2": "17.258", "entropy_gating": "0.409", "expert1_balance_top": "31.278", "expert1_balance_bottom": "17.302", "unused_expert1_count": "0.491", "expert2_balance_top": "32.129", "expert2_balance_bottom": "16.945", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.021", "ppl": "16.23", "wps": "15293.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2350", "lr": "1.53e-05", "gnorm": "1.093", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "45279"}
2023-02-01 10:53:11 | INFO | train_inner | {"epoch": 3, "loss": "4.212", "moe_gate_loss": "12.8735", "overflow_expert1": "0.007", "overflow_expert2": "17.336", "entropy_gating": "0.408", "expert1_balance_top": "31.271", "expert1_balance_bottom": "17.314", "unused_expert1_count": "0.487", "expert2_balance_top": "32.148", "expert2_balance_bottom": "16.887", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.027", "ppl": "16.3", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2360", "lr": "1.528e-05", "gnorm": "1.1", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "45451"}
2023-02-01 10:56:02 | INFO | train_inner | {"epoch": 3, "loss": "4.189", "moe_gate_loss": "12.9114", "overflow_expert1": "0.012", "overflow_expert2": "17.616", "entropy_gating": "0.408", "expert1_balance_top": "31.507", "expert1_balance_bottom": "17.141", "unused_expert1_count": "0.488", "expert2_balance_top": "32.194", "expert2_balance_bottom": "16.824", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.002", "ppl": "16.02", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2370", "lr": "1.526e-05", "gnorm": "1.099", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "45622"}
2023-02-01 10:58:54 | INFO | train_inner | {"epoch": 3, "loss": "4.188", "moe_gate_loss": "12.8812", "overflow_expert1": "0.009", "overflow_expert2": "17.505", "entropy_gating": "0.409", "expert1_balance_top": "31.328", "expert1_balance_bottom": "17.27", "unused_expert1_count": "0.482", "expert2_balance_top": "32.207", "expert2_balance_bottom": "16.811", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.002", "ppl": "16.03", "wps": "15298.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2380", "lr": "1.524e-05", "gnorm": "1.101", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "45793"}
2023-02-01 11:01:45 | INFO | train_inner | {"epoch": 3, "loss": "4.172", "moe_gate_loss": "12.8976", "overflow_expert1": "0.008", "overflow_expert2": "17.525", "entropy_gating": "0.409", "expert1_balance_top": "31.43", "expert1_balance_bottom": "17.167", "unused_expert1_count": "0.488", "expert2_balance_top": "32.163", "expert2_balance_bottom": "16.835", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.986", "ppl": "15.84", "wps": "15285.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2390", "lr": "1.522e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "45965"}
2023-02-01 11:04:36 | INFO | train_inner | {"epoch": 3, "loss": "4.166", "moe_gate_loss": "12.9114", "overflow_expert1": "0.01", "overflow_expert2": "17.63", "entropy_gating": "0.406", "expert1_balance_top": "31.54", "expert1_balance_bottom": "17.102", "unused_expert1_count": "0.488", "expert2_balance_top": "32.159", "expert2_balance_bottom": "16.816", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.98", "ppl": "15.78", "wps": "15296.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2400", "lr": "1.52e-05", "gnorm": "1.148", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "46136"}
2023-02-01 11:07:28 | INFO | train_inner | {"epoch": 3, "loss": "4.2", "moe_gate_loss": "12.8885", "overflow_expert1": "0.009", "overflow_expert2": "17.439", "entropy_gating": "0.408", "expert1_balance_top": "31.387", "expert1_balance_bottom": "17.234", "unused_expert1_count": "0.489", "expert2_balance_top": "32.149", "expert2_balance_bottom": "16.864", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.014", "ppl": "16.16", "wps": "15290.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2410", "lr": "1.518e-05", "gnorm": "1.114", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "46308"}
2023-02-01 11:10:19 | INFO | train_inner | {"epoch": 3, "loss": "4.185", "moe_gate_loss": "12.8779", "overflow_expert1": "0.01", "overflow_expert2": "17.359", "entropy_gating": "0.409", "expert1_balance_top": "31.289", "expert1_balance_bottom": "17.282", "unused_expert1_count": "0.49", "expert2_balance_top": "32.149", "expert2_balance_bottom": "16.865", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.999", "ppl": "15.99", "wps": "15294.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2420", "lr": "1.516e-05", "gnorm": "1.097", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "46479"}
2023-02-01 11:13:11 | INFO | train_inner | {"epoch": 3, "loss": "4.211", "moe_gate_loss": "12.8732", "overflow_expert1": "0.007", "overflow_expert2": "17.252", "entropy_gating": "0.407", "expert1_balance_top": "31.279", "expert1_balance_bottom": "17.303", "unused_expert1_count": "0.49", "expert2_balance_top": "32.114", "expert2_balance_bottom": "16.903", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.025", "ppl": "16.28", "wps": "15294", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2430", "lr": "1.514e-05", "gnorm": "1.109", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "46651"}
2023-02-01 11:16:02 | INFO | train_inner | {"epoch": 3, "loss": "4.19", "moe_gate_loss": "12.8692", "overflow_expert1": "0.008", "overflow_expert2": "17.111", "entropy_gating": "0.407", "expert1_balance_top": "31.226", "expert1_balance_bottom": "17.333", "unused_expert1_count": "0.489", "expert2_balance_top": "32.081", "expert2_balance_bottom": "16.959", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.004", "ppl": "16.05", "wps": "15300.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2440", "lr": "1.512e-05", "gnorm": "1.097", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "46822"}
2023-02-01 11:18:34 | INFO | valid_c4_small/C4_small | {"epoch": 3, "valid_c4_small/C4_small_loss": "4.208", "valid_c4_small/C4_small_moe_gate_loss": "12.5783", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.905", "valid_c4_small/C4_small_entropy_gating": "0.44", "valid_c4_small/C4_small_expert1_balance_top": "31.272", "valid_c4_small/C4_small_expert1_balance_bottom": "18.402", "valid_c4_small/C4_small_unused_expert1_count": "0.462", "valid_c4_small/C4_small_expert2_balance_top": "31.638", "valid_c4_small/C4_small_expert2_balance_bottom": "17.772", "valid_c4_small/C4_small_unused_expert2_count": "0.379", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.026", "valid_c4_small/C4_small_ppl": "16.29", "valid_c4_small/C4_small_wps": "52035", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "2442", "valid_c4_small/C4_small_best_loss": "4.208"}
2023-02-01 11:18:34 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2023-02-01 11:18:34 | INFO | train | {"epoch": 3, "train_loss": "4.186", "train_moe_gate_loss": "12.905", "train_overflow_expert1": "0.012", "train_overflow_expert2": "17.631", "train_entropy_gating": "0.409", "train_expert1_balance_top": "31.485", "train_expert1_balance_bottom": "17.13", "train_unused_expert1_count": "0.493", "train_expert2_balance_top": "32.186", "train_expert2_balance_bottom": "16.846", "train_unused_expert2_count": "0.451", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "4", "train_ppl": "16", "train_wps": "13944.1", "train_ups": "0.05", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "2442", "train_lr": "1.5116e-05", "train_gnorm": "1.108", "train_clip": "100", "train_loss_scale": "2", "train_train_wall": "13582", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "46974"}
2023-02-01 11:18:34 | INFO | fairseq.trainer | begin training epoch 4
2023-02-01 11:20:51 | INFO | train_inner | {"epoch": 4, "loss": "4.193", "moe_gate_loss": "12.8736", "overflow_expert1": "0.009", "overflow_expert2": "17.265", "entropy_gating": "0.408", "expert1_balance_top": "31.273", "expert1_balance_bottom": "17.292", "unused_expert1_count": "0.485", "expert2_balance_top": "32.126", "expert2_balance_bottom": "16.874", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.008", "ppl": "16.08", "wps": "9071.1", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "2450", "lr": "1.51e-05", "gnorm": "1.091", "clip": "100", "loss_scale": "2", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "47111"}
2023-02-01 11:23:42 | INFO | train_inner | {"epoch": 4, "loss": "4.198", "moe_gate_loss": "12.8832", "overflow_expert1": "0.011", "overflow_expert2": "17.643", "entropy_gating": "0.408", "expert1_balance_top": "31.355", "expert1_balance_bottom": "17.251", "unused_expert1_count": "0.485", "expert2_balance_top": "32.352", "expert2_balance_bottom": "16.771", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.013", "ppl": "16.14", "wps": "15285.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2460", "lr": "1.508e-05", "gnorm": "1.102", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "47282"}
2023-02-01 11:26:34 | INFO | train_inner | {"epoch": 4, "loss": "4.14", "moe_gate_loss": "12.8947", "overflow_expert1": "0.009", "overflow_expert2": "17.98", "entropy_gating": "0.407", "expert1_balance_top": "31.432", "expert1_balance_bottom": "17.099", "unused_expert1_count": "0.49", "expert2_balance_top": "32.358", "expert2_balance_bottom": "16.605", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.954", "ppl": "15.5", "wps": "15286", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2470", "lr": "1.506e-05", "gnorm": "1.114", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "47454"}
2023-02-01 11:29:25 | INFO | train_inner | {"epoch": 4, "loss": "4.127", "moe_gate_loss": "12.8929", "overflow_expert1": "0.009", "overflow_expert2": "17.937", "entropy_gating": "0.407", "expert1_balance_top": "31.422", "expert1_balance_bottom": "17.092", "unused_expert1_count": "0.491", "expert2_balance_top": "32.319", "expert2_balance_bottom": "16.67", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.941", "ppl": "15.35", "wps": "15298.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2480", "lr": "1.504e-05", "gnorm": "1.115", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "47625"}
2023-02-01 11:32:17 | INFO | train_inner | {"epoch": 4, "loss": "4.115", "moe_gate_loss": "12.8937", "overflow_expert1": "0.006", "overflow_expert2": "17.899", "entropy_gating": "0.408", "expert1_balance_top": "31.456", "expert1_balance_bottom": "17.103", "unused_expert1_count": "0.491", "expert2_balance_top": "32.23", "expert2_balance_bottom": "16.686", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.929", "ppl": "15.23", "wps": "15286.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2490", "lr": "1.502e-05", "gnorm": "1.117", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "47797"}
2023-02-01 11:35:08 | INFO | train_inner | {"epoch": 4, "loss": "4.108", "moe_gate_loss": "12.8967", "overflow_expert1": "0.009", "overflow_expert2": "17.717", "entropy_gating": "0.406", "expert1_balance_top": "31.475", "expert1_balance_bottom": "17.102", "unused_expert1_count": "0.488", "expert2_balance_top": "32.16", "expert2_balance_bottom": "16.782", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.16", "wps": "15290.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2500", "lr": "1.5e-05", "gnorm": "1.127", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "47968"}
2023-02-01 11:36:58 | INFO | valid_c4_small/C4_small | {"epoch": 4, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.595", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "13.072", "valid_c4_small/C4_small_entropy_gating": "0.437", "valid_c4_small/C4_small_expert1_balance_top": "31.418", "valid_c4_small/C4_small_expert1_balance_bottom": "18.285", "valid_c4_small/C4_small_unused_expert1_count": "0.457", "valid_c4_small/C4_small_expert2_balance_top": "31.775", "valid_c4_small/C4_small_expert2_balance_bottom": "17.799", "valid_c4_small/C4_small_unused_expert2_count": "0.371", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.33", "valid_c4_small/C4_small_wps": "52031.5", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "2500", "valid_c4_small/C4_small_best_loss": "4.208"}
2023-02-01 11:36:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 2500 updates
2023-02-01 11:37:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 4 @ 2500 updates, score 4.211) (writing took 7.49019272159785 seconds)
2023-02-01 11:39:58 | INFO | train_inner | {"epoch": 4, "loss": "4.094", "moe_gate_loss": "12.8874", "overflow_expert1": "0.009", "overflow_expert2": "17.514", "entropy_gating": "0.406", "expert1_balance_top": "31.37", "expert1_balance_bottom": "17.186", "unused_expert1_count": "0.486", "expert2_balance_top": "32.216", "expert2_balance_bottom": "16.843", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.908", "ppl": "15.01", "wps": "9051.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "2510", "lr": "1.498e-05", "gnorm": "1.11", "clip": "100", "loss_scale": "2", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "48258"}
2023-02-01 11:42:49 | INFO | train_inner | {"epoch": 4, "loss": "4.165", "moe_gate_loss": "12.8995", "overflow_expert1": "0.006", "overflow_expert2": "17.736", "entropy_gating": "0.405", "expert1_balance_top": "31.465", "expert1_balance_bottom": "17.078", "unused_expert1_count": "0.485", "expert2_balance_top": "32.255", "expert2_balance_bottom": "16.777", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.979", "ppl": "15.77", "wps": "15291.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2520", "lr": "1.496e-05", "gnorm": "1.12", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "48429"}
2023-02-01 11:45:41 | INFO | train_inner | {"epoch": 4, "loss": "4.156", "moe_gate_loss": "12.8849", "overflow_expert1": "0.008", "overflow_expert2": "17.545", "entropy_gating": "0.407", "expert1_balance_top": "31.356", "expert1_balance_bottom": "17.199", "unused_expert1_count": "0.488", "expert2_balance_top": "32.09", "expert2_balance_bottom": "16.817", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.97", "ppl": "15.67", "wps": "15295.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2530", "lr": "1.494e-05", "gnorm": "1.13", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "48601"}
2023-02-01 11:48:32 | INFO | train_inner | {"epoch": 4, "loss": "4.139", "moe_gate_loss": "12.8864", "overflow_expert1": "0.005", "overflow_expert2": "17.399", "entropy_gating": "0.406", "expert1_balance_top": "31.39", "expert1_balance_bottom": "17.193", "unused_expert1_count": "0.486", "expert2_balance_top": "32.107", "expert2_balance_bottom": "16.874", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.953", "ppl": "15.49", "wps": "15291.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2540", "lr": "1.492e-05", "gnorm": "1.126", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "48772"}
2023-02-01 11:51:24 | INFO | train_inner | {"epoch": 4, "loss": "4.108", "moe_gate_loss": "12.8936", "overflow_expert1": "0.009", "overflow_expert2": "17.503", "entropy_gating": "0.405", "expert1_balance_top": "31.425", "expert1_balance_bottom": "17.175", "unused_expert1_count": "0.487", "expert2_balance_top": "32.097", "expert2_balance_bottom": "16.863", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.16", "wps": "15289", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2550", "lr": "1.49e-05", "gnorm": "1.125", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "48944"}
2023-02-01 11:54:15 | INFO | train_inner | {"epoch": 4, "loss": "4.147", "moe_gate_loss": "12.8911", "overflow_expert1": "0.009", "overflow_expert2": "17.617", "entropy_gating": "0.405", "expert1_balance_top": "31.389", "expert1_balance_bottom": "17.197", "unused_expert1_count": "0.487", "expert2_balance_top": "32.19", "expert2_balance_bottom": "16.817", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.961", "ppl": "15.57", "wps": "15290.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2560", "lr": "1.488e-05", "gnorm": "1.139", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "49115"}
2023-02-01 11:57:07 | INFO | train_inner | {"epoch": 4, "loss": "4.126", "moe_gate_loss": "12.8863", "overflow_expert1": "0.007", "overflow_expert2": "17.457", "entropy_gating": "0.407", "expert1_balance_top": "31.389", "expert1_balance_bottom": "17.185", "unused_expert1_count": "0.488", "expert2_balance_top": "32.081", "expert2_balance_bottom": "16.896", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.94", "ppl": "15.35", "wps": "15284.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2570", "lr": "1.486e-05", "gnorm": "1.138", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "49286"}
2023-02-01 11:59:58 | INFO | train_inner | {"epoch": 4, "loss": "4.126", "moe_gate_loss": "12.9057", "overflow_expert1": "0.009", "overflow_expert2": "17.663", "entropy_gating": "0.406", "expert1_balance_top": "31.509", "expert1_balance_bottom": "17.105", "unused_expert1_count": "0.487", "expert2_balance_top": "32.181", "expert2_balance_bottom": "16.843", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.94", "ppl": "15.34", "wps": "15291.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2580", "lr": "1.484e-05", "gnorm": "1.15", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "49458"}
2023-02-01 12:02:49 | INFO | train_inner | {"epoch": 4, "loss": "4.172", "moe_gate_loss": "12.8886", "overflow_expert1": "0.01", "overflow_expert2": "17.517", "entropy_gating": "0.405", "expert1_balance_top": "31.366", "expert1_balance_bottom": "17.203", "unused_expert1_count": "0.489", "expert2_balance_top": "32.125", "expert2_balance_bottom": "16.877", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.986", "ppl": "15.85", "wps": "15285.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2590", "lr": "1.482e-05", "gnorm": "1.144", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "49629"}
2023-02-01 12:05:41 | INFO | train_inner | {"epoch": 4, "loss": "4.127", "moe_gate_loss": "12.8918", "overflow_expert1": "0.008", "overflow_expert2": "17.434", "entropy_gating": "0.405", "expert1_balance_top": "31.4", "expert1_balance_bottom": "17.184", "unused_expert1_count": "0.488", "expert2_balance_top": "32.098", "expert2_balance_bottom": "16.9", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.941", "ppl": "15.36", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2600", "lr": "1.48e-05", "gnorm": "1.133", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "49801"}
2023-02-01 12:08:49 | INFO | train_inner | {"epoch": 4, "loss": "4.189", "moe_gate_loss": "12.8969", "overflow_expert1": "0.009", "overflow_expert2": "17.659", "entropy_gating": "0.407", "expert1_balance_top": "31.444", "expert1_balance_bottom": "17.163", "unused_expert1_count": "0.49", "expert2_balance_top": "32.188", "expert2_balance_bottom": "16.824", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.003", "ppl": "16.03", "wps": "13903.5", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "2610", "lr": "1.478e-05", "gnorm": "1.151", "clip": "100", "loss_scale": "1", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "49989"}
2023-02-01 12:11:41 | INFO | train_inner | {"epoch": 4, "loss": "4.145", "moe_gate_loss": "12.9052", "overflow_expert1": "0.009", "overflow_expert2": "17.627", "entropy_gating": "0.406", "expert1_balance_top": "31.494", "expert1_balance_bottom": "17.119", "unused_expert1_count": "0.488", "expert2_balance_top": "32.182", "expert2_balance_bottom": "16.872", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.959", "ppl": "15.55", "wps": "15286.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2620", "lr": "1.476e-05", "gnorm": "1.145", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "50161"}
2023-02-01 12:14:33 | INFO | train_inner | {"epoch": 4, "loss": "4.141", "moe_gate_loss": "12.891", "overflow_expert1": "0.008", "overflow_expert2": "17.422", "entropy_gating": "0.405", "expert1_balance_top": "31.401", "expert1_balance_bottom": "17.19", "unused_expert1_count": "0.49", "expert2_balance_top": "32.065", "expert2_balance_bottom": "16.92", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.955", "ppl": "15.51", "wps": "15277.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2630", "lr": "1.474e-05", "gnorm": "1.123", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "50332"}
2023-02-01 12:17:24 | INFO | train_inner | {"epoch": 4, "loss": "4.163", "moe_gate_loss": "12.8919", "overflow_expert1": "0.005", "overflow_expert2": "17.575", "entropy_gating": "0.406", "expert1_balance_top": "31.408", "expert1_balance_bottom": "17.157", "unused_expert1_count": "0.483", "expert2_balance_top": "32.254", "expert2_balance_bottom": "16.856", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.977", "ppl": "15.75", "wps": "15292.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2640", "lr": "1.472e-05", "gnorm": "1.136", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "50504"}
2023-02-01 12:20:15 | INFO | train_inner | {"epoch": 4, "loss": "4.108", "moe_gate_loss": "12.9078", "overflow_expert1": "0.013", "overflow_expert2": "17.565", "entropy_gating": "0.405", "expert1_balance_top": "31.529", "expert1_balance_bottom": "17.123", "unused_expert1_count": "0.488", "expert2_balance_top": "32.143", "expert2_balance_bottom": "16.917", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.16", "wps": "15282.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2650", "lr": "1.47e-05", "gnorm": "1.144", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "50675"}
2023-02-01 12:23:07 | INFO | train_inner | {"epoch": 4, "loss": "4.18", "moe_gate_loss": "12.8869", "overflow_expert1": "0.012", "overflow_expert2": "17.353", "entropy_gating": "0.406", "expert1_balance_top": "31.369", "expert1_balance_bottom": "17.22", "unused_expert1_count": "0.489", "expert2_balance_top": "32.1", "expert2_balance_bottom": "16.945", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.994", "ppl": "15.94", "wps": "15291.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2660", "lr": "1.468e-05", "gnorm": "1.126", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "50847"}
2023-02-01 12:25:58 | INFO | train_inner | {"epoch": 4, "loss": "4.128", "moe_gate_loss": "12.8909", "overflow_expert1": "0.013", "overflow_expert2": "17.48", "entropy_gating": "0.407", "expert1_balance_top": "31.402", "expert1_balance_bottom": "17.204", "unused_expert1_count": "0.49", "expert2_balance_top": "32.184", "expert2_balance_bottom": "16.908", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.942", "ppl": "15.37", "wps": "15282.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2670", "lr": "1.466e-05", "gnorm": "1.167", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "51018"}
2023-02-01 12:28:50 | INFO | train_inner | {"epoch": 4, "loss": "4.134", "moe_gate_loss": "12.8861", "overflow_expert1": "0.007", "overflow_expert2": "17.315", "entropy_gating": "0.406", "expert1_balance_top": "31.362", "expert1_balance_bottom": "17.217", "unused_expert1_count": "0.488", "expert2_balance_top": "32.071", "expert2_balance_bottom": "16.94", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.948", "ppl": "15.44", "wps": "15295.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2680", "lr": "1.464e-05", "gnorm": "1.121", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "51190"}
2023-02-01 12:31:41 | INFO | train_inner | {"epoch": 4, "loss": "4.147", "moe_gate_loss": "12.8938", "overflow_expert1": "0.01", "overflow_expert2": "17.573", "entropy_gating": "0.405", "expert1_balance_top": "31.399", "expert1_balance_bottom": "17.184", "unused_expert1_count": "0.492", "expert2_balance_top": "32.168", "expert2_balance_bottom": "16.858", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.961", "ppl": "15.57", "wps": "15294.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2690", "lr": "1.462e-05", "gnorm": "1.138", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "51361"}
2023-02-01 12:34:33 | INFO | train_inner | {"epoch": 4, "loss": "4.133", "moe_gate_loss": "12.8819", "overflow_expert1": "0.01", "overflow_expert2": "17.343", "entropy_gating": "0.405", "expert1_balance_top": "31.347", "expert1_balance_bottom": "17.226", "unused_expert1_count": "0.487", "expert2_balance_top": "32.099", "expert2_balance_bottom": "16.94", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.947", "ppl": "15.43", "wps": "15299.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2700", "lr": "1.46e-05", "gnorm": "1.129", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "51533"}
2023-02-01 12:37:24 | INFO | train_inner | {"epoch": 4, "loss": "4.155", "moe_gate_loss": "12.8845", "overflow_expert1": "0.006", "overflow_expert2": "17.431", "entropy_gating": "0.404", "expert1_balance_top": "31.377", "expert1_balance_bottom": "17.246", "unused_expert1_count": "0.489", "expert2_balance_top": "32.13", "expert2_balance_bottom": "16.906", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.97", "ppl": "15.67", "wps": "15295.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2710", "lr": "1.458e-05", "gnorm": "1.13", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "51704"}
2023-02-01 12:40:15 | INFO | train_inner | {"epoch": 4, "loss": "4.147", "moe_gate_loss": "12.8733", "overflow_expert1": "0.006", "overflow_expert2": "17.265", "entropy_gating": "0.405", "expert1_balance_top": "31.297", "expert1_balance_bottom": "17.278", "unused_expert1_count": "0.486", "expert2_balance_top": "32.087", "expert2_balance_bottom": "16.952", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.961", "ppl": "15.57", "wps": "15292.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2720", "lr": "1.456e-05", "gnorm": "1.144", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "51875"}
2023-02-01 12:43:07 | INFO | train_inner | {"epoch": 4, "loss": "4.131", "moe_gate_loss": "12.8992", "overflow_expert1": "0.011", "overflow_expert2": "17.674", "entropy_gating": "0.405", "expert1_balance_top": "31.478", "expert1_balance_bottom": "17.151", "unused_expert1_count": "0.489", "expert2_balance_top": "32.235", "expert2_balance_bottom": "16.853", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.945", "ppl": "15.4", "wps": "15286.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2730", "lr": "1.454e-05", "gnorm": "1.119", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "52047"}
2023-02-01 12:45:58 | INFO | train_inner | {"epoch": 4, "loss": "4.145", "moe_gate_loss": "12.8831", "overflow_expert1": "0.009", "overflow_expert2": "17.403", "entropy_gating": "0.406", "expert1_balance_top": "31.354", "expert1_balance_bottom": "17.24", "unused_expert1_count": "0.485", "expert2_balance_top": "32.154", "expert2_balance_bottom": "16.908", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.96", "ppl": "15.56", "wps": "15289.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2740", "lr": "1.452e-05", "gnorm": "1.126", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "52218"}
2023-02-01 12:48:50 | INFO | train_inner | {"epoch": 4, "loss": "4.184", "moe_gate_loss": "12.8975", "overflow_expert1": "0.011", "overflow_expert2": "17.533", "entropy_gating": "0.405", "expert1_balance_top": "31.454", "expert1_balance_bottom": "17.176", "unused_expert1_count": "0.488", "expert2_balance_top": "32.171", "expert2_balance_bottom": "16.907", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.998", "ppl": "15.98", "wps": "15292.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2750", "lr": "1.45e-05", "gnorm": "1.149", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "52390"}
2023-02-01 12:50:39 | INFO | valid_c4_small/C4_small | {"epoch": 4, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.5856", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.559", "valid_c4_small/C4_small_entropy_gating": "0.434", "valid_c4_small/C4_small_expert1_balance_top": "31.445", "valid_c4_small/C4_small_expert1_balance_bottom": "18.36", "valid_c4_small/C4_small_unused_expert1_count": "0.456", "valid_c4_small/C4_small_expert2_balance_top": "31.492", "valid_c4_small/C4_small_expert2_balance_bottom": "18.04", "valid_c4_small/C4_small_unused_expert2_count": "0.362", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.029", "valid_c4_small/C4_small_ppl": "16.32", "valid_c4_small/C4_small_wps": "52096", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "2750", "valid_c4_small/C4_small_best_loss": "4.208"}
2023-02-01 12:50:39 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 2750 updates
2023-02-01 12:50:47 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 4 @ 2750 updates, score 4.21) (writing took 7.63550330279395 seconds)
2023-02-01 12:53:39 | INFO | train_inner | {"epoch": 4, "loss": "4.162", "moe_gate_loss": "12.882", "overflow_expert1": "0.01", "overflow_expert2": "17.287", "entropy_gating": "0.403", "expert1_balance_top": "31.353", "expert1_balance_bottom": "17.245", "unused_expert1_count": "0.487", "expert2_balance_top": "32.093", "expert2_balance_bottom": "16.96", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.976", "ppl": "15.74", "wps": "9060.2", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "2760", "lr": "1.448e-05", "gnorm": "1.139", "clip": "100", "loss_scale": "1", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "52679"}
2023-02-01 12:56:31 | INFO | train_inner | {"epoch": 4, "loss": "4.095", "moe_gate_loss": "12.888", "overflow_expert1": "0.011", "overflow_expert2": "17.398", "entropy_gating": "0.404", "expert1_balance_top": "31.407", "expert1_balance_bottom": "17.22", "unused_expert1_count": "0.488", "expert2_balance_top": "32.097", "expert2_balance_bottom": "16.903", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.909", "ppl": "15.02", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2770", "lr": "1.446e-05", "gnorm": "1.139", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "52850"}
2023-02-01 12:59:22 | INFO | train_inner | {"epoch": 4, "loss": "4.153", "moe_gate_loss": "12.8717", "overflow_expert1": "0.007", "overflow_expert2": "17.459", "entropy_gating": "0.405", "expert1_balance_top": "31.283", "expert1_balance_bottom": "17.288", "unused_expert1_count": "0.487", "expert2_balance_top": "32.158", "expert2_balance_bottom": "16.885", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.968", "ppl": "15.64", "wps": "15280.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2780", "lr": "1.444e-05", "gnorm": "1.134", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "53022"}
2023-02-01 13:02:14 | INFO | train_inner | {"epoch": 4, "loss": "4.137", "moe_gate_loss": "12.8829", "overflow_expert1": "0.009", "overflow_expert2": "17.302", "entropy_gating": "0.404", "expert1_balance_top": "31.39", "expert1_balance_bottom": "17.242", "unused_expert1_count": "0.488", "expert2_balance_top": "32.102", "expert2_balance_bottom": "16.95", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.951", "ppl": "15.46", "wps": "15290.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2790", "lr": "1.442e-05", "gnorm": "1.134", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "53193"}
2023-02-01 13:05:05 | INFO | train_inner | {"epoch": 4, "loss": "4.171", "moe_gate_loss": "12.8782", "overflow_expert1": "0.014", "overflow_expert2": "17.366", "entropy_gating": "0.405", "expert1_balance_top": "31.325", "expert1_balance_bottom": "17.273", "unused_expert1_count": "0.487", "expert2_balance_top": "32.107", "expert2_balance_bottom": "16.926", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.985", "ppl": "15.84", "wps": "15283.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2800", "lr": "1.44e-05", "gnorm": "1.125", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "53365"}
2023-02-01 13:07:57 | INFO | train_inner | {"epoch": 4, "loss": "4.135", "moe_gate_loss": "12.875", "overflow_expert1": "0.009", "overflow_expert2": "17.354", "entropy_gating": "0.404", "expert1_balance_top": "31.318", "expert1_balance_bottom": "17.269", "unused_expert1_count": "0.489", "expert2_balance_top": "32.115", "expert2_balance_bottom": "16.929", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.949", "ppl": "15.44", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2810", "lr": "1.438e-05", "gnorm": "1.134", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "53536"}
2023-02-01 13:10:48 | INFO | train_inner | {"epoch": 4, "loss": "4.133", "moe_gate_loss": "12.892", "overflow_expert1": "0.01", "overflow_expert2": "17.489", "entropy_gating": "0.405", "expert1_balance_top": "31.449", "expert1_balance_bottom": "17.184", "unused_expert1_count": "0.49", "expert2_balance_top": "32.162", "expert2_balance_bottom": "16.91", "unused_expert2_count": "0.434", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.947", "ppl": "15.42", "wps": "15282.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2820", "lr": "1.436e-05", "gnorm": "1.144", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "53708"}
2023-02-01 13:13:40 | INFO | train_inner | {"epoch": 4, "loss": "4.152", "moe_gate_loss": "12.8732", "overflow_expert1": "0.006", "overflow_expert2": "17.171", "entropy_gating": "0.403", "expert1_balance_top": "31.341", "expert1_balance_bottom": "17.283", "unused_expert1_count": "0.489", "expert2_balance_top": "32.036", "expert2_balance_bottom": "17.023", "unused_expert2_count": "0.439", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.966", "ppl": "15.63", "wps": "15282.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2830", "lr": "1.434e-05", "gnorm": "1.136", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "53880"}
2023-02-01 13:16:31 | INFO | train_inner | {"epoch": 4, "loss": "4.094", "moe_gate_loss": "12.8857", "overflow_expert1": "0.014", "overflow_expert2": "17.487", "entropy_gating": "0.404", "expert1_balance_top": "31.384", "expert1_balance_bottom": "17.228", "unused_expert1_count": "0.487", "expert2_balance_top": "32.168", "expert2_balance_bottom": "16.909", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.908", "ppl": "15.01", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2840", "lr": "1.432e-05", "gnorm": "1.135", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "54051"}
2023-02-01 13:19:23 | INFO | train_inner | {"epoch": 4, "loss": "4.155", "moe_gate_loss": "12.8862", "overflow_expert1": "0.01", "overflow_expert2": "17.462", "entropy_gating": "0.403", "expert1_balance_top": "31.399", "expert1_balance_bottom": "17.224", "unused_expert1_count": "0.489", "expert2_balance_top": "32.133", "expert2_balance_bottom": "16.893", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.969", "ppl": "15.66", "wps": "15289", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2850", "lr": "1.43e-05", "gnorm": "1.154", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "54223"}
2023-02-01 13:22:14 | INFO | train_inner | {"epoch": 4, "loss": "4.137", "moe_gate_loss": "12.8947", "overflow_expert1": "0.013", "overflow_expert2": "17.529", "entropy_gating": "0.405", "expert1_balance_top": "31.464", "expert1_balance_bottom": "17.183", "unused_expert1_count": "0.491", "expert2_balance_top": "32.202", "expert2_balance_bottom": "16.89", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.951", "ppl": "15.47", "wps": "15295.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2860", "lr": "1.428e-05", "gnorm": "1.157", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "54394"}
2023-02-01 13:25:06 | INFO | train_inner | {"epoch": 4, "loss": "4.126", "moe_gate_loss": "12.8733", "overflow_expert1": "0.009", "overflow_expert2": "17.378", "entropy_gating": "0.404", "expert1_balance_top": "31.319", "expert1_balance_bottom": "17.303", "unused_expert1_count": "0.486", "expert2_balance_top": "32.162", "expert2_balance_bottom": "16.907", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.94", "ppl": "15.35", "wps": "15283.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2870", "lr": "1.426e-05", "gnorm": "1.122", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "54565"}
2023-02-01 13:27:57 | INFO | train_inner | {"epoch": 4, "loss": "4.17", "moe_gate_loss": "12.8723", "overflow_expert1": "0.01", "overflow_expert2": "17.22", "entropy_gating": "0.405", "expert1_balance_top": "31.316", "expert1_balance_bottom": "17.289", "unused_expert1_count": "0.49", "expert2_balance_top": "32.091", "expert2_balance_bottom": "16.98", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.984", "ppl": "15.82", "wps": "15270.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2880", "lr": "1.424e-05", "gnorm": "1.14", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "54737"}
2023-02-01 13:30:49 | INFO | train_inner | {"epoch": 4, "loss": "4.205", "moe_gate_loss": "12.8811", "overflow_expert1": "0.009", "overflow_expert2": "17.592", "entropy_gating": "0.404", "expert1_balance_top": "31.405", "expert1_balance_bottom": "17.219", "unused_expert1_count": "0.486", "expert2_balance_top": "32.217", "expert2_balance_bottom": "16.868", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.02", "ppl": "16.22", "wps": "15288.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2890", "lr": "1.422e-05", "gnorm": "1.167", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "54909"}
2023-02-01 13:33:40 | INFO | train_inner | {"epoch": 4, "loss": "4.158", "moe_gate_loss": "12.8711", "overflow_expert1": "0.006", "overflow_expert2": "17.353", "entropy_gating": "0.404", "expert1_balance_top": "31.355", "expert1_balance_bottom": "17.289", "unused_expert1_count": "0.485", "expert2_balance_top": "32.143", "expert2_balance_bottom": "16.926", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.973", "ppl": "15.7", "wps": "15291.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2900", "lr": "1.42e-05", "gnorm": "1.135", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "55080"}
2023-02-01 13:36:32 | INFO | train_inner | {"epoch": 4, "loss": "4.144", "moe_gate_loss": "12.8741", "overflow_expert1": "0.009", "overflow_expert2": "17.381", "entropy_gating": "0.403", "expert1_balance_top": "31.326", "expert1_balance_bottom": "17.264", "unused_expert1_count": "0.487", "expert2_balance_top": "32.136", "expert2_balance_bottom": "16.926", "unused_expert2_count": "0.438", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.958", "ppl": "15.54", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2910", "lr": "1.418e-05", "gnorm": "1.141", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "55252"}
2023-02-01 13:39:23 | INFO | train_inner | {"epoch": 4, "loss": "4.131", "moe_gate_loss": "12.8935", "overflow_expert1": "0.023", "overflow_expert2": "17.373", "entropy_gating": "0.405", "expert1_balance_top": "31.435", "expert1_balance_bottom": "17.238", "unused_expert1_count": "0.482", "expert2_balance_top": "32.164", "expert2_balance_bottom": "16.951", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.945", "ppl": "15.4", "wps": "15284.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2920", "lr": "1.416e-05", "gnorm": "1.143", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "55423"}
2023-02-01 13:42:15 | INFO | train_inner | {"epoch": 4, "loss": "4.136", "moe_gate_loss": "12.8659", "overflow_expert1": "0.006", "overflow_expert2": "17.25", "entropy_gating": "0.405", "expert1_balance_top": "31.338", "expert1_balance_bottom": "17.327", "unused_expert1_count": "0.484", "expert2_balance_top": "32.104", "expert2_balance_bottom": "16.989", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.95", "ppl": "15.45", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2930", "lr": "1.414e-05", "gnorm": "1.123", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "55595"}
2023-02-01 13:45:06 | INFO | train_inner | {"epoch": 4, "loss": "4.125", "moe_gate_loss": "12.8608", "overflow_expert1": "0.009", "overflow_expert2": "17.195", "entropy_gating": "0.404", "expert1_balance_top": "31.315", "expert1_balance_bottom": "17.346", "unused_expert1_count": "0.487", "expert2_balance_top": "32.107", "expert2_balance_bottom": "17.013", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.939", "ppl": "15.34", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2940", "lr": "1.412e-05", "gnorm": "1.132", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "55766"}
2023-02-01 13:47:58 | INFO | train_inner | {"epoch": 4, "loss": "4.088", "moe_gate_loss": "12.8847", "overflow_expert1": "0.024", "overflow_expert2": "17.443", "entropy_gating": "0.403", "expert1_balance_top": "31.405", "expert1_balance_bottom": "17.232", "unused_expert1_count": "0.489", "expert2_balance_top": "32.254", "expert2_balance_bottom": "16.908", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.902", "ppl": "14.95", "wps": "15301.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2950", "lr": "1.41e-05", "gnorm": "1.167", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "55937"}
2023-02-01 13:50:49 | INFO | train_inner | {"epoch": 4, "loss": "4.163", "moe_gate_loss": "12.8672", "overflow_expert1": "0.009", "overflow_expert2": "17.445", "entropy_gating": "0.404", "expert1_balance_top": "31.365", "expert1_balance_bottom": "17.291", "unused_expert1_count": "0.486", "expert2_balance_top": "32.203", "expert2_balance_bottom": "16.921", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.978", "ppl": "15.75", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2960", "lr": "1.408e-05", "gnorm": "1.142", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "56109"}
2023-02-01 13:53:40 | INFO | train_inner | {"epoch": 4, "loss": "4.15", "moe_gate_loss": "12.8538", "overflow_expert1": "0.008", "overflow_expert2": "17.073", "entropy_gating": "0.403", "expert1_balance_top": "31.254", "expert1_balance_bottom": "17.385", "unused_expert1_count": "0.485", "expert2_balance_top": "32.066", "expert2_balance_bottom": "17.039", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.964", "ppl": "15.61", "wps": "15291.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2970", "lr": "1.406e-05", "gnorm": "1.137", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "56280"}
2023-02-01 13:56:32 | INFO | train_inner | {"epoch": 4, "loss": "4.129", "moe_gate_loss": "12.8599", "overflow_expert1": "0.009", "overflow_expert2": "17.21", "entropy_gating": "0.403", "expert1_balance_top": "31.299", "expert1_balance_bottom": "17.353", "unused_expert1_count": "0.484", "expert2_balance_top": "32.121", "expert2_balance_bottom": "17.007", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.943", "ppl": "15.38", "wps": "15284.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2980", "lr": "1.404e-05", "gnorm": "1.131", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "56452"}
2023-02-01 13:59:23 | INFO | train_inner | {"epoch": 4, "loss": "4.102", "moe_gate_loss": "12.8506", "overflow_expert1": "0.009", "overflow_expert2": "17.124", "entropy_gating": "0.404", "expert1_balance_top": "31.264", "expert1_balance_bottom": "17.38", "unused_expert1_count": "0.488", "expert2_balance_top": "32.086", "expert2_balance_bottom": "17.033", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.917", "ppl": "15.1", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "2990", "lr": "1.402e-05", "gnorm": "1.125", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "56623"}
2023-02-01 14:02:15 | INFO | train_inner | {"epoch": 4, "loss": "4.101", "moe_gate_loss": "12.8732", "overflow_expert1": "0.015", "overflow_expert2": "17.426", "entropy_gating": "0.403", "expert1_balance_top": "31.401", "expert1_balance_bottom": "17.284", "unused_expert1_count": "0.487", "expert2_balance_top": "32.154", "expert2_balance_bottom": "16.938", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.915", "ppl": "15.09", "wps": "15296.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3000", "lr": "1.4e-05", "gnorm": "1.438", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "56795"}
2023-02-01 14:04:05 | INFO | valid_c4_small/C4_small | {"epoch": 4, "valid_c4_small/C4_small_loss": "4.207", "valid_c4_small/C4_small_moe_gate_loss": "12.5466", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.608", "valid_c4_small/C4_small_entropy_gating": "0.435", "valid_c4_small/C4_small_expert1_balance_top": "31.263", "valid_c4_small/C4_small_expert1_balance_bottom": "18.534", "valid_c4_small/C4_small_unused_expert1_count": "0.459", "valid_c4_small/C4_small_expert2_balance_top": "31.607", "valid_c4_small/C4_small_expert2_balance_bottom": "17.993", "valid_c4_small/C4_small_unused_expert2_count": "0.371", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.026", "valid_c4_small/C4_small_ppl": "16.29", "valid_c4_small/C4_small_wps": "51991.2", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "3000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 14:04:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 3000 updates
2023-02-01 14:04:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 4 @ 3000 updates, score 4.207) (writing took 7.530257636681199 seconds)
2023-02-01 14:07:05 | INFO | train_inner | {"epoch": 4, "loss": "4.114", "moe_gate_loss": "12.8487", "overflow_expert1": "0.006", "overflow_expert2": "17.191", "entropy_gating": "0.403", "expert1_balance_top": "31.291", "expert1_balance_bottom": "17.383", "unused_expert1_count": "0.484", "expert2_balance_top": "32.158", "expert2_balance_bottom": "17.034", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.928", "ppl": "15.23", "wps": "9050.4", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "3010", "lr": "1.398e-05", "gnorm": "1.124", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "57084"}
2023-02-01 14:09:56 | INFO | train_inner | {"epoch": 4, "loss": "4.118", "moe_gate_loss": "12.8453", "overflow_expert1": "0.008", "overflow_expert2": "16.991", "entropy_gating": "0.404", "expert1_balance_top": "31.267", "expert1_balance_bottom": "17.418", "unused_expert1_count": "0.483", "expert2_balance_top": "32.015", "expert2_balance_bottom": "17.09", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.933", "ppl": "15.27", "wps": "15284.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3020", "lr": "1.396e-05", "gnorm": "1.125", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "57256"}
2023-02-01 14:12:47 | INFO | train_inner | {"epoch": 4, "loss": "4.083", "moe_gate_loss": "12.8439", "overflow_expert1": "0.01", "overflow_expert2": "17.116", "entropy_gating": "0.403", "expert1_balance_top": "31.217", "expert1_balance_bottom": "17.416", "unused_expert1_count": "0.486", "expert2_balance_top": "32.157", "expert2_balance_bottom": "17.028", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.91", "wps": "15294.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3030", "lr": "1.394e-05", "gnorm": "1.143", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "57427"}
2023-02-01 14:15:39 | INFO | train_inner | {"epoch": 4, "loss": "4.123", "moe_gate_loss": "12.8596", "overflow_expert1": "0.01", "overflow_expert2": "17.336", "entropy_gating": "0.405", "expert1_balance_top": "31.353", "expert1_balance_bottom": "17.334", "unused_expert1_count": "0.488", "expert2_balance_top": "32.163", "expert2_balance_bottom": "16.981", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.938", "ppl": "15.32", "wps": "15293", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3040", "lr": "1.392e-05", "gnorm": "1.14", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "57599"}
2023-02-01 14:18:30 | INFO | train_inner | {"epoch": 4, "loss": "4.14", "moe_gate_loss": "12.827", "overflow_expert1": "0.006", "overflow_expert2": "16.916", "entropy_gating": "0.403", "expert1_balance_top": "31.175", "expert1_balance_bottom": "17.496", "unused_expert1_count": "0.487", "expert2_balance_top": "32.022", "expert2_balance_bottom": "17.105", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.955", "ppl": "15.51", "wps": "15282.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3050", "lr": "1.39e-05", "gnorm": "1.123", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "57770"}
2023-02-01 14:21:22 | INFO | train_inner | {"epoch": 4, "loss": "4.158", "moe_gate_loss": "12.8285", "overflow_expert1": "0.007", "overflow_expert2": "17.032", "entropy_gating": "0.404", "expert1_balance_top": "31.165", "expert1_balance_bottom": "17.513", "unused_expert1_count": "0.484", "expert2_balance_top": "32.123", "expert2_balance_bottom": "17.045", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.973", "ppl": "15.7", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3060", "lr": "1.388e-05", "gnorm": "1.122", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "57942"}
2023-02-01 14:24:13 | INFO | train_inner | {"epoch": 4, "loss": "4.171", "moe_gate_loss": "12.8456", "overflow_expert1": "0.012", "overflow_expert2": "17.09", "entropy_gating": "0.404", "expert1_balance_top": "31.27", "expert1_balance_bottom": "17.415", "unused_expert1_count": "0.489", "expert2_balance_top": "32.075", "expert2_balance_bottom": "17.056", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.986", "ppl": "15.84", "wps": "15290.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3070", "lr": "1.386e-05", "gnorm": "1.134", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "58113"}
2023-02-01 14:27:05 | INFO | train_inner | {"epoch": 4, "loss": "4.148", "moe_gate_loss": "12.8214", "overflow_expert1": "0.005", "overflow_expert2": "16.892", "entropy_gating": "0.406", "expert1_balance_top": "31.117", "expert1_balance_bottom": "17.53", "unused_expert1_count": "0.491", "expert2_balance_top": "32.022", "expert2_balance_bottom": "17.103", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.963", "ppl": "15.59", "wps": "15293.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3080", "lr": "1.384e-05", "gnorm": "1.15", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "58285"}
2023-02-01 14:29:56 | INFO | train_inner | {"epoch": 4, "loss": "4.188", "moe_gate_loss": "12.8413", "overflow_expert1": "0.009", "overflow_expert2": "17.109", "entropy_gating": "0.403", "expert1_balance_top": "31.24", "expert1_balance_bottom": "17.437", "unused_expert1_count": "0.483", "expert2_balance_top": "32.119", "expert2_balance_bottom": "17.027", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4.002", "ppl": "16.03", "wps": "15288.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3090", "lr": "1.382e-05", "gnorm": "1.148", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "58456"}
2023-02-01 14:32:48 | INFO | train_inner | {"epoch": 4, "loss": "4.16", "moe_gate_loss": "12.8208", "overflow_expert1": "0.004", "overflow_expert2": "16.824", "entropy_gating": "0.404", "expert1_balance_top": "31.139", "expert1_balance_bottom": "17.546", "unused_expert1_count": "0.486", "expert2_balance_top": "32.04", "expert2_balance_bottom": "17.106", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.975", "ppl": "15.73", "wps": "15290.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3100", "lr": "1.38e-05", "gnorm": "1.124", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "58628"}
2023-02-01 14:35:39 | INFO | train_inner | {"epoch": 4, "loss": "4.182", "moe_gate_loss": "12.8239", "overflow_expert1": "0.004", "overflow_expert2": "16.97", "entropy_gating": "0.405", "expert1_balance_top": "31.139", "expert1_balance_bottom": "17.519", "unused_expert1_count": "0.485", "expert2_balance_top": "32.11", "expert2_balance_bottom": "17.064", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.997", "ppl": "15.96", "wps": "15291.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3110", "lr": "1.378e-05", "gnorm": "1.135", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "58799"}
2023-02-01 14:38:31 | INFO | train_inner | {"epoch": 4, "loss": "4.144", "moe_gate_loss": "12.8287", "overflow_expert1": "0.01", "overflow_expert2": "16.904", "entropy_gating": "0.404", "expert1_balance_top": "31.147", "expert1_balance_bottom": "17.502", "unused_expert1_count": "0.485", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.073", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.959", "ppl": "15.55", "wps": "15283.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3120", "lr": "1.376e-05", "gnorm": "1.124", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "58971"}
2023-02-01 14:41:22 | INFO | train_inner | {"epoch": 4, "loss": "4.158", "moe_gate_loss": "12.8378", "overflow_expert1": "0.01", "overflow_expert2": "16.988", "entropy_gating": "0.402", "expert1_balance_top": "31.231", "expert1_balance_bottom": "17.462", "unused_expert1_count": "0.489", "expert2_balance_top": "32.13", "expert2_balance_bottom": "17.083", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.973", "ppl": "15.7", "wps": "15286", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3130", "lr": "1.374e-05", "gnorm": "1.135", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "59142"}
2023-02-01 14:44:14 | INFO | train_inner | {"epoch": 4, "loss": "4.134", "moe_gate_loss": "12.8361", "overflow_expert1": "0.013", "overflow_expert2": "17.025", "entropy_gating": "0.404", "expert1_balance_top": "31.19", "expert1_balance_bottom": "17.49", "unused_expert1_count": "0.488", "expert2_balance_top": "32.112", "expert2_balance_bottom": "17.066", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.949", "ppl": "15.45", "wps": "15292.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3140", "lr": "1.372e-05", "gnorm": "1.14", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "59313"}
2023-02-01 14:47:05 | INFO | train_inner | {"epoch": 4, "loss": "4.134", "moe_gate_loss": "12.8363", "overflow_expert1": "0.008", "overflow_expert2": "17.047", "entropy_gating": "0.404", "expert1_balance_top": "31.237", "expert1_balance_bottom": "17.467", "unused_expert1_count": "0.489", "expert2_balance_top": "32.11", "expert2_balance_bottom": "17.04", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.949", "ppl": "15.44", "wps": "15288.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3150", "lr": "1.37e-05", "gnorm": "1.135", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "59485"}
2023-02-01 14:49:56 | INFO | train_inner | {"epoch": 4, "loss": "4.133", "moe_gate_loss": "12.8249", "overflow_expert1": "0.005", "overflow_expert2": "16.911", "entropy_gating": "0.404", "expert1_balance_top": "31.19", "expert1_balance_bottom": "17.52", "unused_expert1_count": "0.49", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.085", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.948", "ppl": "15.43", "wps": "15288.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3160", "lr": "1.368e-05", "gnorm": "1.128", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "59656"}
2023-02-01 14:52:48 | INFO | train_inner | {"epoch": 4, "loss": "4.175", "moe_gate_loss": "12.8215", "overflow_expert1": "0.007", "overflow_expert2": "16.85", "entropy_gating": "0.404", "expert1_balance_top": "31.142", "expert1_balance_bottom": "17.552", "unused_expert1_count": "0.488", "expert2_balance_top": "32.064", "expert2_balance_bottom": "17.154", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.99", "ppl": "15.89", "wps": "15285.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3170", "lr": "1.366e-05", "gnorm": "1.123", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "59828"}
2023-02-01 14:55:39 | INFO | train_inner | {"epoch": 4, "loss": "4.145", "moe_gate_loss": "12.8254", "overflow_expert1": "0.007", "overflow_expert2": "16.959", "entropy_gating": "0.403", "expert1_balance_top": "31.158", "expert1_balance_bottom": "17.536", "unused_expert1_count": "0.485", "expert2_balance_top": "32.061", "expert2_balance_bottom": "17.073", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.96", "ppl": "15.56", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3180", "lr": "1.364e-05", "gnorm": "1.129", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "59999"}
2023-02-01 14:58:31 | INFO | train_inner | {"epoch": 4, "loss": "4.165", "moe_gate_loss": "12.8374", "overflow_expert1": "0.009", "overflow_expert2": "16.928", "entropy_gating": "0.404", "expert1_balance_top": "31.247", "expert1_balance_bottom": "17.496", "unused_expert1_count": "0.482", "expert2_balance_top": "32.068", "expert2_balance_bottom": "17.099", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.98", "ppl": "15.78", "wps": "15289.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3190", "lr": "1.362e-05", "gnorm": "1.12", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "60171"}
2023-02-01 15:01:22 | INFO | train_inner | {"epoch": 4, "loss": "4.128", "moe_gate_loss": "12.8233", "overflow_expert1": "0.006", "overflow_expert2": "17.027", "entropy_gating": "0.404", "expert1_balance_top": "31.157", "expert1_balance_bottom": "17.555", "unused_expert1_count": "0.488", "expert2_balance_top": "32.074", "expert2_balance_bottom": "17.053", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.943", "ppl": "15.38", "wps": "15292", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3200", "lr": "1.36e-05", "gnorm": "1.113", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "60342"}
2023-02-01 15:04:14 | INFO | train_inner | {"epoch": 4, "loss": "4.124", "moe_gate_loss": "12.8379", "overflow_expert1": "0.01", "overflow_expert2": "16.939", "entropy_gating": "0.404", "expert1_balance_top": "31.251", "expert1_balance_bottom": "17.472", "unused_expert1_count": "0.484", "expert2_balance_top": "32.083", "expert2_balance_bottom": "17.106", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.938", "ppl": "15.33", "wps": "15285.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3210", "lr": "1.358e-05", "gnorm": "1.13", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "60514"}
2023-02-01 15:07:05 | INFO | train_inner | {"epoch": 4, "loss": "4.146", "moe_gate_loss": "12.8548", "overflow_expert1": "0.01", "overflow_expert2": "17.317", "entropy_gating": "0.402", "expert1_balance_top": "31.379", "expert1_balance_bottom": "17.378", "unused_expert1_count": "0.486", "expert2_balance_top": "32.242", "expert2_balance_bottom": "16.997", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.961", "ppl": "15.57", "wps": "15290.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3220", "lr": "1.356e-05", "gnorm": "1.147", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "60685"}
2023-02-01 15:09:57 | INFO | train_inner | {"epoch": 4, "loss": "4.15", "moe_gate_loss": "12.814", "overflow_expert1": "0.006", "overflow_expert2": "16.824", "entropy_gating": "0.403", "expert1_balance_top": "31.109", "expert1_balance_bottom": "17.607", "unused_expert1_count": "0.488", "expert2_balance_top": "32.038", "expert2_balance_bottom": "17.123", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.965", "ppl": "15.62", "wps": "15292.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3230", "lr": "1.354e-05", "gnorm": "1.12", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "60857"}
2023-02-01 15:12:48 | INFO | train_inner | {"epoch": 4, "loss": "4.156", "moe_gate_loss": "12.8253", "overflow_expert1": "0.008", "overflow_expert2": "16.794", "entropy_gating": "0.405", "expert1_balance_top": "31.173", "expert1_balance_bottom": "17.553", "unused_expert1_count": "0.489", "expert2_balance_top": "32.017", "expert2_balance_bottom": "17.14", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.971", "ppl": "15.68", "wps": "15292.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3240", "lr": "1.352e-05", "gnorm": "1.126", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "61028"}
2023-02-01 15:15:40 | INFO | train_inner | {"epoch": 4, "loss": "4.17", "moe_gate_loss": "12.8112", "overflow_expert1": "0.006", "overflow_expert2": "16.779", "entropy_gating": "0.404", "expert1_balance_top": "31.09", "expert1_balance_bottom": "17.625", "unused_expert1_count": "0.484", "expert2_balance_top": "32.05", "expert2_balance_bottom": "17.121", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.985", "ppl": "15.83", "wps": "15286.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3250", "lr": "1.35e-05", "gnorm": "1.133", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "61199"}
2023-02-01 15:17:29 | INFO | valid_c4_small/C4_small | {"epoch": 4, "valid_c4_small/C4_small_loss": "4.207", "valid_c4_small/C4_small_moe_gate_loss": "12.538", "valid_c4_small/C4_small_overflow_expert1": "0.001", "valid_c4_small/C4_small_overflow_expert2": "12.371", "valid_c4_small/C4_small_entropy_gating": "0.434", "valid_c4_small/C4_small_expert1_balance_top": "31.247", "valid_c4_small/C4_small_expert1_balance_bottom": "18.788", "valid_c4_small/C4_small_unused_expert1_count": "0.455", "valid_c4_small/C4_small_expert2_balance_top": "31.519", "valid_c4_small/C4_small_expert2_balance_bottom": "18.036", "valid_c4_small/C4_small_unused_expert2_count": "0.372", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.026", "valid_c4_small/C4_small_ppl": "16.29", "valid_c4_small/C4_small_wps": "52021.4", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "3250", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 15:17:29 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 3250 updates
2023-02-01 15:17:37 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 4 @ 3250 updates, score 4.207) (writing took 7.585611791815609 seconds)
2023-02-01 15:22:10 | INFO | valid_c4_small/C4_small | {"epoch": 4, "valid_c4_small/C4_small_loss": "4.206", "valid_c4_small/C4_small_moe_gate_loss": "12.5316", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.22", "valid_c4_small/C4_small_entropy_gating": "0.434", "valid_c4_small/C4_small_expert1_balance_top": "31.186", "valid_c4_small/C4_small_expert1_balance_bottom": "18.756", "valid_c4_small/C4_small_unused_expert1_count": "0.455", "valid_c4_small/C4_small_expert2_balance_top": "31.6", "valid_c4_small/C4_small_expert2_balance_bottom": "18.112", "valid_c4_small/C4_small_unused_expert2_count": "0.373", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.025", "valid_c4_small/C4_small_ppl": "16.28", "valid_c4_small/C4_small_wps": "52039.8", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "3259", "valid_c4_small/C4_small_best_loss": "4.206"}
2023-02-01 15:22:10 | INFO | fairseq_cli.train | end of epoch 4 (average epoch stats below)
2023-02-01 15:22:10 | INFO | train | {"epoch": 4, "train_loss": "4.143", "train_moe_gate_loss": "12.8676", "train_overflow_expert1": "0.009", "train_overflow_expert2": "17.309", "train_entropy_gating": "0.405", "train_expert1_balance_top": "31.325", "train_expert1_balance_bottom": "17.308", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "32.131", "train_expert2_balance_bottom": "16.951", "train_unused_expert2_count": "0.447", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.957", "train_ppl": "15.53", "train_wps": "14653.6", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "3259", "train_lr": "1.3482e-05", "train_gnorm": "1.137", "train_clip": "100", "train_loss_scale": "2", "train_train_wall": "13573", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "61589"}
2023-02-01 15:22:10 | INFO | fairseq.trainer | begin training epoch 5
2023-02-01 15:22:27 | INFO | train_inner | {"epoch": 5, "loss": "4.159", "moe_gate_loss": "12.8098", "overflow_expert1": "0.007", "overflow_expert2": "16.685", "entropy_gating": "0.403", "expert1_balance_top": "31.039", "expert1_balance_bottom": "17.638", "unused_expert1_count": "0.486", "expert2_balance_top": "32.045", "expert2_balance_bottom": "17.146", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.974", "ppl": "15.71", "wps": "6439.8", "ups": "0.02", "wpb": "262144", "bsz": "128", "num_updates": "3260", "lr": "1.348e-05", "gnorm": "1.126", "clip": "100", "loss_scale": "2", "train_wall": "176", "cuda_gb_allocated": "14.3", "cuda_gb_reserved": "21.6", "cuda_gb_free": "9.4", "wall": "61607"}
2023-02-01 15:25:18 | INFO | train_inner | {"epoch": 5, "loss": "4.172", "moe_gate_loss": "12.8188", "overflow_expert1": "0.008", "overflow_expert2": "16.776", "entropy_gating": "0.404", "expert1_balance_top": "31.123", "expert1_balance_bottom": "17.557", "unused_expert1_count": "0.487", "expert2_balance_top": "32.064", "expert2_balance_bottom": "17.146", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.987", "ppl": "15.86", "wps": "15282.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3270", "lr": "1.346e-05", "gnorm": "1.122", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "61778"}
2023-02-01 15:28:10 | INFO | train_inner | {"epoch": 5, "loss": "4.105", "moe_gate_loss": "12.8287", "overflow_expert1": "0.008", "overflow_expert2": "17.399", "entropy_gating": "0.405", "expert1_balance_top": "31.194", "expert1_balance_bottom": "17.484", "unused_expert1_count": "0.488", "expert2_balance_top": "32.379", "expert2_balance_bottom": "16.901", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.92", "ppl": "15.14", "wps": "15290.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3280", "lr": "1.344e-05", "gnorm": "1.131", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "61950"}
2023-02-01 15:31:01 | INFO | train_inner | {"epoch": 5, "loss": "4.107", "moe_gate_loss": "12.8296", "overflow_expert1": "0.006", "overflow_expert2": "17.281", "entropy_gating": "0.403", "expert1_balance_top": "31.232", "expert1_balance_bottom": "17.419", "unused_expert1_count": "0.484", "expert2_balance_top": "32.257", "expert2_balance_bottom": "16.915", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.16", "wps": "15287.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3290", "lr": "1.342e-05", "gnorm": "1.136", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "62121"}
2023-02-01 15:33:52 | INFO | train_inner | {"epoch": 5, "loss": "4.094", "moe_gate_loss": "12.8364", "overflow_expert1": "0.006", "overflow_expert2": "17.504", "entropy_gating": "0.404", "expert1_balance_top": "31.261", "expert1_balance_bottom": "17.374", "unused_expert1_count": "0.487", "expert2_balance_top": "32.289", "expert2_balance_bottom": "16.877", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.909", "ppl": "15.02", "wps": "15294.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3300", "lr": "1.34e-05", "gnorm": "1.138", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "62292"}
2023-02-01 15:36:44 | INFO | train_inner | {"epoch": 5, "loss": "4.058", "moe_gate_loss": "12.8418", "overflow_expert1": "0.007", "overflow_expert2": "17.408", "entropy_gating": "0.403", "expert1_balance_top": "31.303", "expert1_balance_bottom": "17.376", "unused_expert1_count": "0.488", "expert2_balance_top": "32.215", "expert2_balance_bottom": "16.901", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.873", "ppl": "14.65", "wps": "15292.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3310", "lr": "1.338e-05", "gnorm": "1.144", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "62464"}
2023-02-01 15:39:35 | INFO | train_inner | {"epoch": 5, "loss": "4.067", "moe_gate_loss": "12.8274", "overflow_expert1": "0.005", "overflow_expert2": "17.143", "entropy_gating": "0.403", "expert1_balance_top": "31.221", "expert1_balance_bottom": "17.436", "unused_expert1_count": "0.487", "expert2_balance_top": "32.128", "expert2_balance_bottom": "17.02", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.882", "ppl": "14.75", "wps": "15289.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3320", "lr": "1.336e-05", "gnorm": "1.149", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "62635"}
2023-02-01 15:42:27 | INFO | train_inner | {"epoch": 5, "loss": "4.078", "moe_gate_loss": "12.8363", "overflow_expert1": "0.006", "overflow_expert2": "16.99", "entropy_gating": "0.402", "expert1_balance_top": "31.253", "expert1_balance_bottom": "17.424", "unused_expert1_count": "0.483", "expert2_balance_top": "32.061", "expert2_balance_bottom": "17.094", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.893", "ppl": "14.85", "wps": "15293.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3330", "lr": "1.334e-05", "gnorm": "1.159", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "62807"}
2023-02-01 15:45:18 | INFO | train_inner | {"epoch": 5, "loss": "4.13", "moe_gate_loss": "12.8306", "overflow_expert1": "0.006", "overflow_expert2": "17.126", "entropy_gating": "0.403", "expert1_balance_top": "31.222", "expert1_balance_bottom": "17.452", "unused_expert1_count": "0.485", "expert2_balance_top": "32.159", "expert2_balance_bottom": "17.017", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.945", "ppl": "15.4", "wps": "15288.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3340", "lr": "1.332e-05", "gnorm": "1.15", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "62978"}
2023-02-01 15:48:10 | INFO | train_inner | {"epoch": 5, "loss": "4.11", "moe_gate_loss": "12.8284", "overflow_expert1": "0.005", "overflow_expert2": "17.066", "entropy_gating": "0.404", "expert1_balance_top": "31.187", "expert1_balance_bottom": "17.456", "unused_expert1_count": "0.485", "expert2_balance_top": "32.071", "expert2_balance_bottom": "17.03", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.925", "ppl": "15.19", "wps": "15292.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3350", "lr": "1.33e-05", "gnorm": "1.149", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "63150"}
2023-02-01 15:51:01 | INFO | train_inner | {"epoch": 5, "loss": "4.095", "moe_gate_loss": "12.8367", "overflow_expert1": "0.005", "overflow_expert2": "17.13", "entropy_gating": "0.404", "expert1_balance_top": "31.263", "expert1_balance_bottom": "17.421", "unused_expert1_count": "0.49", "expert2_balance_top": "32.082", "expert2_balance_bottom": "17.027", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.91", "ppl": "15.03", "wps": "15289.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3360", "lr": "1.328e-05", "gnorm": "1.149", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "63321"}
2023-02-01 15:53:53 | INFO | train_inner | {"epoch": 5, "loss": "4.076", "moe_gate_loss": "12.8332", "overflow_expert1": "0.007", "overflow_expert2": "17.015", "entropy_gating": "0.402", "expert1_balance_top": "31.222", "expert1_balance_bottom": "17.451", "unused_expert1_count": "0.49", "expert2_balance_top": "32.058", "expert2_balance_bottom": "17.061", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.891", "ppl": "14.83", "wps": "15281.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3370", "lr": "1.326e-05", "gnorm": "1.15", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "63493"}
2023-02-01 15:56:44 | INFO | train_inner | {"epoch": 5, "loss": "4.097", "moe_gate_loss": "12.8329", "overflow_expert1": "0.006", "overflow_expert2": "17.15", "entropy_gating": "0.403", "expert1_balance_top": "31.221", "expert1_balance_bottom": "17.466", "unused_expert1_count": "0.488", "expert2_balance_top": "32.176", "expert2_balance_bottom": "17.042", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.912", "ppl": "15.06", "wps": "15294", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3380", "lr": "1.324e-05", "gnorm": "1.167", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "63664"}
2023-02-01 15:59:36 | INFO | train_inner | {"epoch": 5, "loss": "4.092", "moe_gate_loss": "12.8391", "overflow_expert1": "0.007", "overflow_expert2": "17.055", "entropy_gating": "0.402", "expert1_balance_top": "31.3", "expert1_balance_bottom": "17.427", "unused_expert1_count": "0.488", "expert2_balance_top": "32.014", "expert2_balance_bottom": "17.092", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.907", "ppl": "15", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3390", "lr": "1.322e-05", "gnorm": "1.175", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "63835"}
2023-02-01 16:02:27 | INFO | train_inner | {"epoch": 5, "loss": "4.142", "moe_gate_loss": "12.8445", "overflow_expert1": "0.01", "overflow_expert2": "17.172", "entropy_gating": "0.402", "expert1_balance_top": "31.294", "expert1_balance_bottom": "17.41", "unused_expert1_count": "0.483", "expert2_balance_top": "32.105", "expert2_balance_bottom": "17.059", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.957", "ppl": "15.53", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3400", "lr": "1.32e-05", "gnorm": "1.169", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "64007"}
2023-02-01 16:05:18 | INFO | train_inner | {"epoch": 5, "loss": "4.099", "moe_gate_loss": "12.8263", "overflow_expert1": "0.009", "overflow_expert2": "17.001", "entropy_gating": "0.402", "expert1_balance_top": "31.17", "expert1_balance_bottom": "17.511", "unused_expert1_count": "0.489", "expert2_balance_top": "32.056", "expert2_balance_bottom": "17.093", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.914", "ppl": "15.07", "wps": "15289.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3410", "lr": "1.318e-05", "gnorm": "1.181", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "64178"}
2023-02-01 16:08:10 | INFO | train_inner | {"epoch": 5, "loss": "4.093", "moe_gate_loss": "12.8369", "overflow_expert1": "0.009", "overflow_expert2": "17.042", "entropy_gating": "0.402", "expert1_balance_top": "31.245", "expert1_balance_bottom": "17.457", "unused_expert1_count": "0.487", "expert2_balance_top": "32.071", "expert2_balance_bottom": "17.102", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.908", "ppl": "15.01", "wps": "15282.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3420", "lr": "1.316e-05", "gnorm": "1.167", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "64350"}
2023-02-01 16:11:01 | INFO | train_inner | {"epoch": 5, "loss": "4.185", "moe_gate_loss": "12.8644", "overflow_expert1": "0.01", "overflow_expert2": "17.444", "entropy_gating": "0.403", "expert1_balance_top": "31.415", "expert1_balance_bottom": "17.313", "unused_expert1_count": "0.489", "expert2_balance_top": "32.187", "expert2_balance_bottom": "16.966", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "4", "ppl": "16", "wps": "15288.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3430", "lr": "1.314e-05", "gnorm": "2.021", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "64521"}
2023-02-01 16:13:53 | INFO | train_inner | {"epoch": 5, "loss": "4.096", "moe_gate_loss": "12.841", "overflow_expert1": "0.009", "overflow_expert2": "17.125", "entropy_gating": "0.402", "expert1_balance_top": "31.287", "expert1_balance_bottom": "17.44", "unused_expert1_count": "0.486", "expert2_balance_top": "32.137", "expert2_balance_bottom": "17.131", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.91", "ppl": "15.04", "wps": "15283.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3440", "lr": "1.312e-05", "gnorm": "1.159", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "64693"}
2023-02-01 16:16:45 | INFO | train_inner | {"epoch": 5, "loss": "4.111", "moe_gate_loss": "12.8246", "overflow_expert1": "0.006", "overflow_expert2": "16.756", "entropy_gating": "0.401", "expert1_balance_top": "31.175", "expert1_balance_bottom": "17.532", "unused_expert1_count": "0.488", "expert2_balance_top": "31.915", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.926", "ppl": "15.2", "wps": "15278.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3450", "lr": "1.31e-05", "gnorm": "1.156", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "64865"}
2023-02-01 16:19:36 | INFO | train_inner | {"epoch": 5, "loss": "4.097", "moe_gate_loss": "12.8445", "overflow_expert1": "0.005", "overflow_expert2": "17.249", "entropy_gating": "0.402", "expert1_balance_top": "31.307", "expert1_balance_bottom": "17.394", "unused_expert1_count": "0.489", "expert2_balance_top": "32.199", "expert2_balance_bottom": "17.03", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.912", "ppl": "15.05", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3460", "lr": "1.308e-05", "gnorm": "1.157", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "65036"}
2023-02-01 16:22:28 | INFO | train_inner | {"epoch": 5, "loss": "4.089", "moe_gate_loss": "12.8495", "overflow_expert1": "0.009", "overflow_expert2": "17.206", "entropy_gating": "0.401", "expert1_balance_top": "31.32", "expert1_balance_bottom": "17.403", "unused_expert1_count": "0.487", "expert2_balance_top": "32.123", "expert2_balance_bottom": "17.067", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.904", "ppl": "14.97", "wps": "15283.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3470", "lr": "1.306e-05", "gnorm": "1.164", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "65207"}
2023-02-01 16:25:19 | INFO | train_inner | {"epoch": 5, "loss": "4.132", "moe_gate_loss": "12.8248", "overflow_expert1": "0.008", "overflow_expert2": "16.693", "entropy_gating": "0.401", "expert1_balance_top": "31.165", "expert1_balance_bottom": "17.518", "unused_expert1_count": "0.485", "expert2_balance_top": "31.902", "expert2_balance_bottom": "17.224", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.947", "ppl": "15.42", "wps": "15281.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3480", "lr": "1.304e-05", "gnorm": "1.15", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "65379"}
2023-02-01 16:28:11 | INFO | train_inner | {"epoch": 5, "loss": "4.116", "moe_gate_loss": "12.8323", "overflow_expert1": "0.008", "overflow_expert2": "17.069", "entropy_gating": "0.402", "expert1_balance_top": "31.209", "expert1_balance_bottom": "17.492", "unused_expert1_count": "0.486", "expert2_balance_top": "32.154", "expert2_balance_bottom": "17.095", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.931", "ppl": "15.25", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3490", "lr": "1.302e-05", "gnorm": "1.189", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "65551"}
2023-02-01 16:31:02 | INFO | train_inner | {"epoch": 5, "loss": "4.081", "moe_gate_loss": "12.8369", "overflow_expert1": "0.007", "overflow_expert2": "16.949", "entropy_gating": "0.401", "expert1_balance_top": "31.243", "expert1_balance_bottom": "17.449", "unused_expert1_count": "0.488", "expert2_balance_top": "32.022", "expert2_balance_bottom": "17.147", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.896", "ppl": "14.88", "wps": "15284.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3500", "lr": "1.3e-05", "gnorm": "1.154", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "65722"}
2023-02-01 16:32:52 | INFO | valid_c4_small/C4_small | {"epoch": 5, "valid_c4_small/C4_small_loss": "4.208", "valid_c4_small/C4_small_moe_gate_loss": "12.5169", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.465", "valid_c4_small/C4_small_entropy_gating": "0.433", "valid_c4_small/C4_small_expert1_balance_top": "31.097", "valid_c4_small/C4_small_expert1_balance_bottom": "18.72", "valid_c4_small/C4_small_unused_expert1_count": "0.464", "valid_c4_small/C4_small_expert2_balance_top": "31.585", "valid_c4_small/C4_small_expert2_balance_bottom": "18.061", "valid_c4_small/C4_small_unused_expert2_count": "0.387", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.027", "valid_c4_small/C4_small_ppl": "16.3", "valid_c4_small/C4_small_wps": "51975.2", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "3500", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 16:32:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 3500 updates
2023-02-01 16:32:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 5 @ 3500 updates, score 4.208) (writing took 7.539099447894841 seconds)
2023-02-01 16:35:52 | INFO | train_inner | {"epoch": 5, "loss": "4.126", "moe_gate_loss": "12.8265", "overflow_expert1": "0.007", "overflow_expert2": "17.039", "entropy_gating": "0.402", "expert1_balance_top": "31.182", "expert1_balance_bottom": "17.51", "unused_expert1_count": "0.488", "expert2_balance_top": "32.114", "expert2_balance_bottom": "17.106", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.941", "ppl": "15.36", "wps": "9051.6", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "3510", "lr": "1.298e-05", "gnorm": "1.163", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "66012"}
2023-02-01 16:38:43 | INFO | train_inner | {"epoch": 5, "loss": "4.075", "moe_gate_loss": "12.8261", "overflow_expert1": "0.008", "overflow_expert2": "16.798", "entropy_gating": "0.4", "expert1_balance_top": "31.189", "expert1_balance_bottom": "17.518", "unused_expert1_count": "0.487", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.19", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.89", "ppl": "14.82", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3520", "lr": "1.296e-05", "gnorm": "1.157", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "66183"}
2023-02-01 16:41:35 | INFO | train_inner | {"epoch": 5, "loss": "4.132", "moe_gate_loss": "12.8309", "overflow_expert1": "0.005", "overflow_expert2": "17.075", "entropy_gating": "0.401", "expert1_balance_top": "31.228", "expert1_balance_bottom": "17.492", "unused_expert1_count": "0.486", "expert2_balance_top": "32.103", "expert2_balance_bottom": "17.076", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.947", "ppl": "15.42", "wps": "15282.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3530", "lr": "1.294e-05", "gnorm": "1.171", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "66355"}
2023-02-01 16:44:26 | INFO | train_inner | {"epoch": 5, "loss": "4.084", "moe_gate_loss": "12.8447", "overflow_expert1": "0.008", "overflow_expert2": "17.048", "entropy_gating": "0.401", "expert1_balance_top": "31.313", "expert1_balance_bottom": "17.433", "unused_expert1_count": "0.489", "expert2_balance_top": "32.112", "expert2_balance_bottom": "17.1", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.91", "wps": "15287.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3540", "lr": "1.292e-05", "gnorm": "1.163", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "66526"}
2023-02-01 16:47:18 | INFO | train_inner | {"epoch": 5, "loss": "4.098", "moe_gate_loss": "12.831", "overflow_expert1": "0.009", "overflow_expert2": "17.066", "entropy_gating": "0.402", "expert1_balance_top": "31.213", "expert1_balance_bottom": "17.487", "unused_expert1_count": "0.488", "expert2_balance_top": "32.076", "expert2_balance_bottom": "17.091", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.912", "ppl": "15.06", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3550", "lr": "1.29e-05", "gnorm": "1.15", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "66698"}
2023-02-01 16:50:09 | INFO | train_inner | {"epoch": 5, "loss": "4.148", "moe_gate_loss": "12.8165", "overflow_expert1": "0.006", "overflow_expert2": "16.759", "entropy_gating": "0.401", "expert1_balance_top": "31.091", "expert1_balance_bottom": "17.59", "unused_expert1_count": "0.49", "expert2_balance_top": "31.982", "expert2_balance_bottom": "17.174", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.963", "ppl": "15.59", "wps": "15292.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3560", "lr": "1.288e-05", "gnorm": "1.161", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "66869"}
2023-02-01 16:53:01 | INFO | train_inner | {"epoch": 5, "loss": "4.124", "moe_gate_loss": "12.8491", "overflow_expert1": "0.01", "overflow_expert2": "17.079", "entropy_gating": "0.401", "expert1_balance_top": "31.342", "expert1_balance_bottom": "17.421", "unused_expert1_count": "0.491", "expert2_balance_top": "32.088", "expert2_balance_bottom": "17.128", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.939", "ppl": "15.34", "wps": "15283.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3570", "lr": "1.286e-05", "gnorm": "1.181", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "67041"}
2023-02-01 16:55:52 | INFO | train_inner | {"epoch": 5, "loss": "4.104", "moe_gate_loss": "12.8431", "overflow_expert1": "0.01", "overflow_expert2": "17.156", "entropy_gating": "0.4", "expert1_balance_top": "31.293", "expert1_balance_bottom": "17.439", "unused_expert1_count": "0.489", "expert2_balance_top": "32.168", "expert2_balance_bottom": "17.07", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.919", "ppl": "15.12", "wps": "15281.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3580", "lr": "1.284e-05", "gnorm": "1.168", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "67212"}
2023-02-01 16:58:44 | INFO | train_inner | {"epoch": 5, "loss": "4.086", "moe_gate_loss": "12.8254", "overflow_expert1": "0.007", "overflow_expert2": "16.924", "entropy_gating": "0.4", "expert1_balance_top": "31.175", "expert1_balance_bottom": "17.522", "unused_expert1_count": "0.49", "expert2_balance_top": "32.035", "expert2_balance_bottom": "17.147", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.901", "ppl": "14.93", "wps": "15290.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3590", "lr": "1.282e-05", "gnorm": "1.181", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "67384"}
2023-02-01 17:01:35 | INFO | train_inner | {"epoch": 5, "loss": "4.106", "moe_gate_loss": "12.8229", "overflow_expert1": "0.009", "overflow_expert2": "16.929", "entropy_gating": "0.401", "expert1_balance_top": "31.142", "expert1_balance_bottom": "17.556", "unused_expert1_count": "0.488", "expert2_balance_top": "32.032", "expert2_balance_bottom": "17.116", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.921", "ppl": "15.15", "wps": "15293.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3600", "lr": "1.28e-05", "gnorm": "1.163", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "67555"}
2023-02-01 17:04:26 | INFO | train_inner | {"epoch": 5, "loss": "4.112", "moe_gate_loss": "12.8362", "overflow_expert1": "0.014", "overflow_expert2": "16.971", "entropy_gating": "0.401", "expert1_balance_top": "31.247", "expert1_balance_bottom": "17.49", "unused_expert1_count": "0.491", "expert2_balance_top": "32.036", "expert2_balance_bottom": "17.147", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.927", "ppl": "15.21", "wps": "15296.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3610", "lr": "1.278e-05", "gnorm": "1.16", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "67726"}
2023-02-01 17:07:18 | INFO | train_inner | {"epoch": 5, "loss": "4.141", "moe_gate_loss": "12.822", "overflow_expert1": "0.007", "overflow_expert2": "16.949", "entropy_gating": "0.402", "expert1_balance_top": "31.156", "expert1_balance_bottom": "17.529", "unused_expert1_count": "0.487", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.112", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.956", "ppl": "15.52", "wps": "15289.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3620", "lr": "1.276e-05", "gnorm": "1.162", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "67898"}
2023-02-01 17:10:09 | INFO | train_inner | {"epoch": 5, "loss": "4.087", "moe_gate_loss": "12.8373", "overflow_expert1": "0.012", "overflow_expert2": "17.021", "entropy_gating": "0.401", "expert1_balance_top": "31.246", "expert1_balance_bottom": "17.492", "unused_expert1_count": "0.487", "expert2_balance_top": "32.086", "expert2_balance_bottom": "17.105", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.902", "ppl": "14.95", "wps": "15287", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3630", "lr": "1.274e-05", "gnorm": "1.17", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "68069"}
2023-02-01 17:13:01 | INFO | train_inner | {"epoch": 5, "loss": "4.103", "moe_gate_loss": "12.8268", "overflow_expert1": "0.005", "overflow_expert2": "17.032", "entropy_gating": "0.401", "expert1_balance_top": "31.196", "expert1_balance_bottom": "17.52", "unused_expert1_count": "0.488", "expert2_balance_top": "32.062", "expert2_balance_bottom": "17.106", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.918", "ppl": "15.11", "wps": "15286.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3640", "lr": "1.272e-05", "gnorm": "1.166", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "68241"}
2023-02-01 17:15:52 | INFO | train_inner | {"epoch": 5, "loss": "4.089", "moe_gate_loss": "12.8263", "overflow_expert1": "0.007", "overflow_expert2": "16.782", "entropy_gating": "0.399", "expert1_balance_top": "31.202", "expert1_balance_bottom": "17.52", "unused_expert1_count": "0.484", "expert2_balance_top": "31.94", "expert2_balance_bottom": "17.193", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.904", "ppl": "14.97", "wps": "15292.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3650", "lr": "1.27e-05", "gnorm": "1.163", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "68412"}
2023-02-01 17:18:44 | INFO | train_inner | {"epoch": 5, "loss": "4.084", "moe_gate_loss": "12.8371", "overflow_expert1": "0.013", "overflow_expert2": "17.11", "entropy_gating": "0.401", "expert1_balance_top": "31.238", "expert1_balance_bottom": "17.469", "unused_expert1_count": "0.484", "expert2_balance_top": "32.155", "expert2_balance_bottom": "17.066", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.91", "wps": "15285.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3660", "lr": "1.268e-05", "gnorm": "1.171", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "68584"}
2023-02-01 17:21:35 | INFO | train_inner | {"epoch": 5, "loss": "4.096", "moe_gate_loss": "12.8358", "overflow_expert1": "0.01", "overflow_expert2": "17.045", "entropy_gating": "0.4", "expert1_balance_top": "31.241", "expert1_balance_bottom": "17.5", "unused_expert1_count": "0.485", "expert2_balance_top": "32.112", "expert2_balance_bottom": "17.081", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.911", "ppl": "15.04", "wps": "15292.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3670", "lr": "1.266e-05", "gnorm": "1.164", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "68755"}
2023-02-01 17:24:27 | INFO | train_inner | {"epoch": 5, "loss": "4.14", "moe_gate_loss": "12.8462", "overflow_expert1": "0.012", "overflow_expert2": "17.088", "entropy_gating": "0.4", "expert1_balance_top": "31.298", "expert1_balance_bottom": "17.431", "unused_expert1_count": "0.487", "expert2_balance_top": "32.095", "expert2_balance_bottom": "17.069", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.955", "ppl": "15.51", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3680", "lr": "1.264e-05", "gnorm": "1.172", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "68927"}
2023-02-01 17:27:18 | INFO | train_inner | {"epoch": 5, "loss": "4.075", "moe_gate_loss": "12.8324", "overflow_expert1": "0.012", "overflow_expert2": "16.937", "entropy_gating": "0.4", "expert1_balance_top": "31.207", "expert1_balance_bottom": "17.518", "unused_expert1_count": "0.487", "expert2_balance_top": "32.064", "expert2_balance_bottom": "17.12", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.889", "ppl": "14.82", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3690", "lr": "1.262e-05", "gnorm": "1.152", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "69098"}
2023-02-01 17:30:10 | INFO | train_inner | {"epoch": 5, "loss": "4.143", "moe_gate_loss": "12.8154", "overflow_expert1": "0.007", "overflow_expert2": "16.789", "entropy_gating": "0.4", "expert1_balance_top": "31.102", "expert1_balance_bottom": "17.596", "unused_expert1_count": "0.489", "expert2_balance_top": "32.029", "expert2_balance_bottom": "17.157", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.958", "ppl": "15.54", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3700", "lr": "1.26e-05", "gnorm": "1.165", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "69270"}
2023-02-01 17:33:01 | INFO | train_inner | {"epoch": 5, "loss": "4.176", "moe_gate_loss": "12.8393", "overflow_expert1": "0.007", "overflow_expert2": "17.21", "entropy_gating": "0.4", "expert1_balance_top": "31.279", "expert1_balance_bottom": "17.453", "unused_expert1_count": "0.487", "expert2_balance_top": "32.199", "expert2_balance_bottom": "17.051", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.991", "ppl": "15.9", "wps": "15280.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3710", "lr": "1.258e-05", "gnorm": "1.177", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "69441"}
2023-02-01 17:35:53 | INFO | train_inner | {"epoch": 5, "loss": "4.107", "moe_gate_loss": "12.8213", "overflow_expert1": "0.005", "overflow_expert2": "16.906", "entropy_gating": "0.4", "expert1_balance_top": "31.161", "expert1_balance_bottom": "17.541", "unused_expert1_count": "0.486", "expert2_balance_top": "32.057", "expert2_balance_bottom": "17.093", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.16", "wps": "15280.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3720", "lr": "1.256e-05", "gnorm": "1.159", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "69613"}
2023-02-01 17:38:44 | INFO | train_inner | {"epoch": 5, "loss": "4.125", "moe_gate_loss": "12.8338", "overflow_expert1": "0.008", "overflow_expert2": "17.094", "entropy_gating": "0.4", "expert1_balance_top": "31.214", "expert1_balance_bottom": "17.486", "unused_expert1_count": "0.489", "expert2_balance_top": "32.175", "expert2_balance_bottom": "17.068", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.94", "ppl": "15.35", "wps": "15284.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3730", "lr": "1.254e-05", "gnorm": "1.175", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "69784"}
2023-02-01 17:41:36 | INFO | train_inner | {"epoch": 5, "loss": "4.1", "moe_gate_loss": "12.8409", "overflow_expert1": "0.01", "overflow_expert2": "16.985", "entropy_gating": "0.4", "expert1_balance_top": "31.275", "expert1_balance_bottom": "17.485", "unused_expert1_count": "0.485", "expert2_balance_top": "32.095", "expert2_balance_bottom": "17.159", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.915", "ppl": "15.08", "wps": "15290.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3740", "lr": "1.252e-05", "gnorm": "1.182", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "69956"}
2023-02-01 17:44:27 | INFO | train_inner | {"epoch": 5, "loss": "4.112", "moe_gate_loss": "12.8178", "overflow_expert1": "0.005", "overflow_expert2": "16.857", "entropy_gating": "0.4", "expert1_balance_top": "31.136", "expert1_balance_bottom": "17.583", "unused_expert1_count": "0.488", "expert2_balance_top": "31.99", "expert2_balance_bottom": "17.154", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.927", "ppl": "15.21", "wps": "15288.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3750", "lr": "1.25e-05", "gnorm": "1.155", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "70127"}
2023-02-01 17:46:17 | INFO | valid_c4_small/C4_small | {"epoch": 5, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.5286", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.451", "valid_c4_small/C4_small_entropy_gating": "0.429", "valid_c4_small/C4_small_expert1_balance_top": "31.304", "valid_c4_small/C4_small_expert1_balance_bottom": "18.686", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.661", "valid_c4_small/C4_small_expert2_balance_bottom": "18.159", "valid_c4_small/C4_small_unused_expert2_count": "0.365", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.029", "valid_c4_small/C4_small_ppl": "16.32", "valid_c4_small/C4_small_wps": "51941.6", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "3750", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 17:46:17 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 3750 updates
2023-02-01 17:46:24 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 5 @ 3750 updates, score 4.21) (writing took 7.478436877951026 seconds)
2023-02-01 17:49:17 | INFO | train_inner | {"epoch": 5, "loss": "4.061", "moe_gate_loss": "12.8216", "overflow_expert1": "0.008", "overflow_expert2": "16.876", "entropy_gating": "0.399", "expert1_balance_top": "31.182", "expert1_balance_bottom": "17.574", "unused_expert1_count": "0.489", "expert2_balance_top": "32.102", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.876", "ppl": "14.68", "wps": "9047.5", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "3760", "lr": "1.248e-05", "gnorm": "1.16", "clip": "100", "loss_scale": "4", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "70417"}
2023-02-01 17:52:25 | INFO | train_inner | {"epoch": 5, "loss": "4.065", "moe_gate_loss": "12.8436", "overflow_expert1": "0.017", "overflow_expert2": "17.058", "entropy_gating": "0.398", "expert1_balance_top": "31.278", "expert1_balance_bottom": "17.45", "unused_expert1_count": "0.491", "expert2_balance_top": "32.159", "expert2_balance_bottom": "17.076", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.72", "wps": "13910.9", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "3770", "lr": "1.246e-05", "gnorm": "1.188", "clip": "100", "loss_scale": "2", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "70605"}
2023-02-01 17:55:17 | INFO | train_inner | {"epoch": 5, "loss": "4.098", "moe_gate_loss": "12.8252", "overflow_expert1": "0.008", "overflow_expert2": "17.06", "entropy_gating": "0.399", "expert1_balance_top": "31.186", "expert1_balance_bottom": "17.534", "unused_expert1_count": "0.487", "expert2_balance_top": "32.161", "expert2_balance_bottom": "17.098", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.913", "ppl": "15.06", "wps": "15293.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3780", "lr": "1.244e-05", "gnorm": "1.161", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "70777"}
2023-02-01 17:58:08 | INFO | train_inner | {"epoch": 5, "loss": "4.124", "moe_gate_loss": "12.8135", "overflow_expert1": "0.005", "overflow_expert2": "16.79", "entropy_gating": "0.4", "expert1_balance_top": "31.108", "expert1_balance_bottom": "17.62", "unused_expert1_count": "0.488", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.182", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.939", "ppl": "15.34", "wps": "15301.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3790", "lr": "1.242e-05", "gnorm": "1.174", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "70948"}
2023-02-01 18:01:00 | INFO | train_inner | {"epoch": 5, "loss": "4.075", "moe_gate_loss": "12.8292", "overflow_expert1": "0.01", "overflow_expert2": "16.983", "entropy_gating": "0.4", "expert1_balance_top": "31.226", "expert1_balance_bottom": "17.536", "unused_expert1_count": "0.487", "expert2_balance_top": "32.124", "expert2_balance_bottom": "17.123", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.89", "ppl": "14.83", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3800", "lr": "1.24e-05", "gnorm": "1.16", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "71119"}
2023-02-01 18:03:51 | INFO | train_inner | {"epoch": 5, "loss": "4.091", "moe_gate_loss": "12.8252", "overflow_expert1": "0.009", "overflow_expert2": "16.854", "entropy_gating": "0.399", "expert1_balance_top": "31.198", "expert1_balance_bottom": "17.558", "unused_expert1_count": "0.492", "expert2_balance_top": "32.124", "expert2_balance_bottom": "17.158", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.906", "ppl": "14.99", "wps": "15288.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3810", "lr": "1.238e-05", "gnorm": "1.183", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "71291"}
2023-02-01 18:06:42 | INFO | train_inner | {"epoch": 5, "loss": "4.06", "moe_gate_loss": "12.836", "overflow_expert1": "0.006", "overflow_expert2": "17.045", "entropy_gating": "0.399", "expert1_balance_top": "31.257", "expert1_balance_bottom": "17.488", "unused_expert1_count": "0.487", "expert2_balance_top": "32.164", "expert2_balance_bottom": "17.12", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.875", "ppl": "14.67", "wps": "15293.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3820", "lr": "1.236e-05", "gnorm": "1.152", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "71462"}
2023-02-01 18:09:34 | INFO | train_inner | {"epoch": 5, "loss": "4.083", "moe_gate_loss": "12.8075", "overflow_expert1": "0.005", "overflow_expert2": "16.784", "entropy_gating": "0.399", "expert1_balance_top": "31.081", "expert1_balance_bottom": "17.636", "unused_expert1_count": "0.488", "expert2_balance_top": "32.052", "expert2_balance_bottom": "17.162", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.91", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3830", "lr": "1.234e-05", "gnorm": "1.162", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "71634"}
2023-02-01 18:12:25 | INFO | train_inner | {"epoch": 5, "loss": "4.059", "moe_gate_loss": "12.8168", "overflow_expert1": "0.007", "overflow_expert2": "16.82", "entropy_gating": "0.4", "expert1_balance_top": "31.119", "expert1_balance_bottom": "17.599", "unused_expert1_count": "0.488", "expert2_balance_top": "32.036", "expert2_balance_bottom": "17.172", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.875", "ppl": "14.67", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3840", "lr": "1.232e-05", "gnorm": "1.16", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "71805"}
2023-02-01 18:15:17 | INFO | train_inner | {"epoch": 5, "loss": "4.063", "moe_gate_loss": "12.8219", "overflow_expert1": "0.009", "overflow_expert2": "16.685", "entropy_gating": "0.399", "expert1_balance_top": "31.151", "expert1_balance_bottom": "17.565", "unused_expert1_count": "0.492", "expert2_balance_top": "32.008", "expert2_balance_bottom": "17.197", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.878", "ppl": "14.7", "wps": "15295.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3850", "lr": "1.23e-05", "gnorm": "1.168", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "71977"}
2023-02-01 18:18:08 | INFO | train_inner | {"epoch": 5, "loss": "4.134", "moe_gate_loss": "12.8296", "overflow_expert1": "0.008", "overflow_expert2": "17.003", "entropy_gating": "0.4", "expert1_balance_top": "31.222", "expert1_balance_bottom": "17.503", "unused_expert1_count": "0.491", "expert2_balance_top": "32.111", "expert2_balance_bottom": "17.111", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.949", "ppl": "15.45", "wps": "15295.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3860", "lr": "1.228e-05", "gnorm": "1.171", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "72148"}
2023-02-01 18:20:59 | INFO | train_inner | {"epoch": 5, "loss": "4.055", "moe_gate_loss": "12.8058", "overflow_expert1": "0.007", "overflow_expert2": "16.64", "entropy_gating": "0.399", "expert1_balance_top": "31.059", "expert1_balance_bottom": "17.662", "unused_expert1_count": "0.486", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.205", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.871", "ppl": "14.63", "wps": "15293", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3870", "lr": "1.226e-05", "gnorm": "1.146", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "72319"}
2023-02-01 18:23:51 | INFO | train_inner | {"epoch": 5, "loss": "4.137", "moe_gate_loss": "12.8089", "overflow_expert1": "0.006", "overflow_expert2": "16.791", "entropy_gating": "0.4", "expert1_balance_top": "31.093", "expert1_balance_bottom": "17.636", "unused_expert1_count": "0.488", "expert2_balance_top": "32.065", "expert2_balance_bottom": "17.148", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.953", "ppl": "15.48", "wps": "15292.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3880", "lr": "1.224e-05", "gnorm": "1.156", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "72491"}
2023-02-01 18:26:42 | INFO | train_inner | {"epoch": 5, "loss": "4.116", "moe_gate_loss": "12.8265", "overflow_expert1": "0.011", "overflow_expert2": "16.811", "entropy_gating": "0.4", "expert1_balance_top": "31.182", "expert1_balance_bottom": "17.551", "unused_expert1_count": "0.486", "expert2_balance_top": "32.077", "expert2_balance_bottom": "17.167", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.931", "ppl": "15.25", "wps": "15295.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3890", "lr": "1.222e-05", "gnorm": "1.173", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "72662"}
2023-02-01 18:29:34 | INFO | train_inner | {"epoch": 5, "loss": "4.16", "moe_gate_loss": "12.8087", "overflow_expert1": "0.006", "overflow_expert2": "16.712", "entropy_gating": "0.401", "expert1_balance_top": "31.065", "expert1_balance_bottom": "17.643", "unused_expert1_count": "0.49", "expert2_balance_top": "32.01", "expert2_balance_bottom": "17.189", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.975", "ppl": "15.72", "wps": "15292.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3900", "lr": "1.22e-05", "gnorm": "1.172", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "72834"}
2023-02-01 18:32:25 | INFO | train_inner | {"epoch": 5, "loss": "4.136", "moe_gate_loss": "12.8116", "overflow_expert1": "0.006", "overflow_expert2": "16.754", "entropy_gating": "0.399", "expert1_balance_top": "31.101", "expert1_balance_bottom": "17.604", "unused_expert1_count": "0.488", "expert2_balance_top": "32.038", "expert2_balance_bottom": "17.184", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.951", "ppl": "15.47", "wps": "15298.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3910", "lr": "1.218e-05", "gnorm": "1.173", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "73005"}
2023-02-01 18:35:16 | INFO | train_inner | {"epoch": 5, "loss": "4.123", "moe_gate_loss": "12.8029", "overflow_expert1": "0.004", "overflow_expert2": "16.678", "entropy_gating": "0.399", "expert1_balance_top": "31.044", "expert1_balance_bottom": "17.646", "unused_expert1_count": "0.488", "expert2_balance_top": "32.052", "expert2_balance_bottom": "17.167", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.938", "ppl": "15.33", "wps": "15297.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3920", "lr": "1.216e-05", "gnorm": "1.151", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "73176"}
2023-02-01 18:38:08 | INFO | train_inner | {"epoch": 5, "loss": "4.137", "moe_gate_loss": "12.8085", "overflow_expert1": "0.005", "overflow_expert2": "16.694", "entropy_gating": "0.401", "expert1_balance_top": "31.071", "expert1_balance_bottom": "17.623", "unused_expert1_count": "0.491", "expert2_balance_top": "32.026", "expert2_balance_bottom": "17.18", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.952", "ppl": "15.48", "wps": "15302.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3930", "lr": "1.214e-05", "gnorm": "1.157", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "73348"}
2023-02-01 18:40:59 | INFO | train_inner | {"epoch": 5, "loss": "4.103", "moe_gate_loss": "12.8158", "overflow_expert1": "0.011", "overflow_expert2": "16.811", "entropy_gating": "0.4", "expert1_balance_top": "31.104", "expert1_balance_bottom": "17.616", "unused_expert1_count": "0.49", "expert2_balance_top": "32.059", "expert2_balance_bottom": "17.148", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.918", "ppl": "15.12", "wps": "15302.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3940", "lr": "1.212e-05", "gnorm": "1.15", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "73519"}
2023-02-01 18:43:50 | INFO | train_inner | {"epoch": 5, "loss": "4.123", "moe_gate_loss": "12.8091", "overflow_expert1": "0.006", "overflow_expert2": "16.621", "entropy_gating": "0.399", "expert1_balance_top": "31.065", "expert1_balance_bottom": "17.629", "unused_expert1_count": "0.486", "expert2_balance_top": "32.017", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.938", "ppl": "15.33", "wps": "15291.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3950", "lr": "1.21e-05", "gnorm": "1.154", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "73690"}
2023-02-01 18:46:42 | INFO | train_inner | {"epoch": 5, "loss": "4.098", "moe_gate_loss": "12.8177", "overflow_expert1": "0.008", "overflow_expert2": "16.986", "entropy_gating": "0.4", "expert1_balance_top": "31.122", "expert1_balance_bottom": "17.589", "unused_expert1_count": "0.488", "expert2_balance_top": "32.151", "expert2_balance_bottom": "17.066", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.913", "ppl": "15.07", "wps": "15292.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3960", "lr": "1.208e-05", "gnorm": "1.164", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "73862"}
2023-02-01 18:49:33 | INFO | train_inner | {"epoch": 5, "loss": "4.123", "moe_gate_loss": "12.8121", "overflow_expert1": "0.007", "overflow_expert2": "16.686", "entropy_gating": "0.399", "expert1_balance_top": "31.103", "expert1_balance_bottom": "17.619", "unused_expert1_count": "0.488", "expert2_balance_top": "32.051", "expert2_balance_bottom": "17.201", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.938", "ppl": "15.33", "wps": "15294.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3970", "lr": "1.206e-05", "gnorm": "1.149", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "74033"}
2023-02-01 18:52:25 | INFO | train_inner | {"epoch": 5, "loss": "4.099", "moe_gate_loss": "12.7978", "overflow_expert1": "0.003", "overflow_expert2": "16.546", "entropy_gating": "0.4", "expert1_balance_top": "31.006", "expert1_balance_bottom": "17.7", "unused_expert1_count": "0.488", "expert2_balance_top": "31.981", "expert2_balance_bottom": "17.237", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.915", "ppl": "15.08", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3980", "lr": "1.204e-05", "gnorm": "1.144", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "74205"}
2023-02-01 18:55:16 | INFO | train_inner | {"epoch": 5, "loss": "4.166", "moe_gate_loss": "12.8044", "overflow_expert1": "0.006", "overflow_expert2": "16.646", "entropy_gating": "0.4", "expert1_balance_top": "31.041", "expert1_balance_bottom": "17.669", "unused_expert1_count": "0.489", "expert2_balance_top": "32.012", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.982", "ppl": "15.8", "wps": "15292.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "3990", "lr": "1.202e-05", "gnorm": "1.156", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "74376"}
2023-02-01 18:58:08 | INFO | train_inner | {"epoch": 5, "loss": "4.084", "moe_gate_loss": "12.8183", "overflow_expert1": "0.008", "overflow_expert2": "16.895", "entropy_gating": "0.399", "expert1_balance_top": "31.114", "expert1_balance_bottom": "17.585", "unused_expert1_count": "0.489", "expert2_balance_top": "32.114", "expert2_balance_bottom": "17.121", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.91", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4000", "lr": "1.2e-05", "gnorm": "1.159", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "74547"}
2023-02-01 18:59:57 | INFO | valid_c4_small/C4_small | {"epoch": 5, "valid_c4_small/C4_small_loss": "4.207", "valid_c4_small/C4_small_moe_gate_loss": "12.5084", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.062", "valid_c4_small/C4_small_entropy_gating": "0.43", "valid_c4_small/C4_small_expert1_balance_top": "31.059", "valid_c4_small/C4_small_expert1_balance_bottom": "18.795", "valid_c4_small/C4_small_unused_expert1_count": "0.455", "valid_c4_small/C4_small_expert2_balance_top": "31.495", "valid_c4_small/C4_small_expert2_balance_bottom": "18.166", "valid_c4_small/C4_small_unused_expert2_count": "0.376", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.026", "valid_c4_small/C4_small_ppl": "16.29", "valid_c4_small/C4_small_wps": "52070", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "4000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 18:59:57 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 4000 updates
2023-02-01 19:00:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 5 @ 4000 updates, score 4.207) (writing took 7.561001408845186 seconds)
2023-02-01 19:02:57 | INFO | train_inner | {"epoch": 5, "loss": "4.139", "moe_gate_loss": "12.817", "overflow_expert1": "0.007", "overflow_expert2": "16.833", "entropy_gating": "0.4", "expert1_balance_top": "31.112", "expert1_balance_bottom": "17.607", "unused_expert1_count": "0.483", "expert2_balance_top": "32.083", "expert2_balance_bottom": "17.132", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.954", "ppl": "15.5", "wps": "9061.4", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "4010", "lr": "1.198e-05", "gnorm": "1.146", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "74837"}
2023-02-01 19:05:48 | INFO | train_inner | {"epoch": 5, "loss": "4.099", "moe_gate_loss": "12.8174", "overflow_expert1": "0.006", "overflow_expert2": "16.957", "entropy_gating": "0.399", "expert1_balance_top": "31.129", "expert1_balance_bottom": "17.593", "unused_expert1_count": "0.484", "expert2_balance_top": "32.118", "expert2_balance_bottom": "17.08", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.915", "ppl": "15.08", "wps": "15287.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4020", "lr": "1.196e-05", "gnorm": "1.153", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "75008"}
2023-02-01 19:08:40 | INFO | train_inner | {"epoch": 5, "loss": "4.094", "moe_gate_loss": "12.8156", "overflow_expert1": "0.007", "overflow_expert2": "16.786", "entropy_gating": "0.4", "expert1_balance_top": "31.124", "expert1_balance_bottom": "17.613", "unused_expert1_count": "0.485", "expert2_balance_top": "32.053", "expert2_balance_bottom": "17.151", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.909", "ppl": "15.03", "wps": "15282.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4030", "lr": "1.194e-05", "gnorm": "1.142", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "75180"}
2023-02-01 19:11:31 | INFO | train_inner | {"epoch": 5, "loss": "4.107", "moe_gate_loss": "12.8354", "overflow_expert1": "0.008", "overflow_expert2": "17.084", "entropy_gating": "0.399", "expert1_balance_top": "31.257", "expert1_balance_bottom": "17.51", "unused_expert1_count": "0.486", "expert2_balance_top": "32.125", "expert2_balance_bottom": "17.079", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.15", "wps": "15289.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4040", "lr": "1.192e-05", "gnorm": "1.157", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "75351"}
2023-02-01 19:14:23 | INFO | train_inner | {"epoch": 5, "loss": "4.107", "moe_gate_loss": "12.7965", "overflow_expert1": "0.006", "overflow_expert2": "16.529", "entropy_gating": "0.401", "expert1_balance_top": "30.996", "expert1_balance_bottom": "17.735", "unused_expert1_count": "0.483", "expert2_balance_top": "31.953", "expert2_balance_bottom": "17.234", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.923", "ppl": "15.17", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4050", "lr": "1.19e-05", "gnorm": "1.139", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "75523"}
2023-02-01 19:17:14 | INFO | train_inner | {"epoch": 5, "loss": "4.128", "moe_gate_loss": "12.8054", "overflow_expert1": "0.007", "overflow_expert2": "16.68", "entropy_gating": "0.4", "expert1_balance_top": "31.056", "expert1_balance_bottom": "17.672", "unused_expert1_count": "0.485", "expert2_balance_top": "32.065", "expert2_balance_bottom": "17.17", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.944", "ppl": "15.39", "wps": "15295.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4060", "lr": "1.188e-05", "gnorm": "1.149", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "75694"}
2023-02-01 19:20:06 | INFO | train_inner | {"epoch": 5, "loss": "4.136", "moe_gate_loss": "12.7949", "overflow_expert1": "0.005", "overflow_expert2": "16.493", "entropy_gating": "0.4", "expert1_balance_top": "30.971", "expert1_balance_bottom": "17.705", "unused_expert1_count": "0.487", "expert2_balance_top": "31.953", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.951", "ppl": "15.47", "wps": "15286.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4070", "lr": "1.186e-05", "gnorm": "1.147", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "75866"}
2023-02-01 19:23:46 | INFO | valid_c4_small/C4_small | {"epoch": 5, "valid_c4_small/C4_small_loss": "4.206", "valid_c4_small/C4_small_moe_gate_loss": "12.5216", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.287", "valid_c4_small/C4_small_entropy_gating": "0.431", "valid_c4_small/C4_small_expert1_balance_top": "31.099", "valid_c4_small/C4_small_expert1_balance_bottom": "18.885", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.669", "valid_c4_small/C4_small_expert2_balance_bottom": "18.059", "valid_c4_small/C4_small_unused_expert2_count": "0.375", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.025", "valid_c4_small/C4_small_ppl": "16.28", "valid_c4_small/C4_small_wps": "52009.7", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "4076", "valid_c4_small/C4_small_best_loss": "4.206"}
2023-02-01 19:23:46 | INFO | fairseq_cli.train | end of epoch 5 (average epoch stats below)
2023-02-01 19:23:46 | INFO | train | {"epoch": 5, "train_loss": "4.107", "train_moe_gate_loss": "12.8261", "train_overflow_expert1": "0.008", "train_overflow_expert2": "16.949", "train_entropy_gating": "0.401", "train_expert1_balance_top": "31.184", "train_expert1_balance_bottom": "17.526", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "32.084", "train_expert2_balance_bottom": "17.114", "train_unused_expert2_count": "0.448", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.922", "train_ppl": "15.16", "train_wps": "14773.9", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "4076", "train_lr": "1.1848e-05", "train_gnorm": "1.17", "train_clip": "100", "train_loss_scale": "2", "train_train_wall": "13570", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "76086"}
2023-02-01 19:23:46 | INFO | fairseq.trainer | begin training epoch 6
2023-02-01 19:24:55 | INFO | train_inner | {"epoch": 6, "loss": "4.107", "moe_gate_loss": "12.8082", "overflow_expert1": "0.009", "overflow_expert2": "16.752", "entropy_gating": "0.4", "expert1_balance_top": "31.061", "expert1_balance_bottom": "17.661", "unused_expert1_count": "0.486", "expert2_balance_top": "32.096", "expert2_balance_bottom": "17.143", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.16", "wps": "9069", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "4080", "lr": "1.184e-05", "gnorm": "1.155", "clip": "100", "loss_scale": "2", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "76155"}
2023-02-01 19:27:46 | INFO | train_inner | {"epoch": 6, "loss": "4.148", "moe_gate_loss": "12.8005", "overflow_expert1": "0.009", "overflow_expert2": "16.685", "entropy_gating": "0.402", "expert1_balance_top": "31.015", "expert1_balance_bottom": "17.675", "unused_expert1_count": "0.49", "expert2_balance_top": "32.123", "expert2_balance_bottom": "17.161", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.964", "ppl": "15.6", "wps": "15290.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4090", "lr": "1.182e-05", "gnorm": "1.149", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "76326"}
2023-02-01 19:30:38 | INFO | train_inner | {"epoch": 6, "loss": "4.077", "moe_gate_loss": "12.8173", "overflow_expert1": "0.006", "overflow_expert2": "17.381", "entropy_gating": "0.401", "expert1_balance_top": "31.145", "expert1_balance_bottom": "17.522", "unused_expert1_count": "0.488", "expert2_balance_top": "32.409", "expert2_balance_bottom": "16.913", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.893", "ppl": "14.85", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4100", "lr": "1.18e-05", "gnorm": "1.161", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "76498"}
2023-02-01 19:33:29 | INFO | train_inner | {"epoch": 6, "loss": "4.064", "moe_gate_loss": "12.8218", "overflow_expert1": "0.006", "overflow_expert2": "17.189", "entropy_gating": "0.4", "expert1_balance_top": "31.195", "expert1_balance_bottom": "17.483", "unused_expert1_count": "0.487", "expert2_balance_top": "32.219", "expert2_balance_bottom": "16.961", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.71", "wps": "15291.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4110", "lr": "1.178e-05", "gnorm": "1.164", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "76669"}
2023-02-01 19:36:20 | INFO | train_inner | {"epoch": 6, "loss": "4.073", "moe_gate_loss": "12.8206", "overflow_expert1": "0.005", "overflow_expert2": "17.269", "entropy_gating": "0.4", "expert1_balance_top": "31.161", "expert1_balance_bottom": "17.462", "unused_expert1_count": "0.487", "expert2_balance_top": "32.204", "expert2_balance_bottom": "16.943", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.888", "ppl": "14.81", "wps": "15292.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4120", "lr": "1.176e-05", "gnorm": "1.176", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "76840"}
2023-02-01 19:39:12 | INFO | train_inner | {"epoch": 6, "loss": "4.009", "moe_gate_loss": "12.8224", "overflow_expert1": "0.007", "overflow_expert2": "17.118", "entropy_gating": "0.399", "expert1_balance_top": "31.184", "expert1_balance_bottom": "17.508", "unused_expert1_count": "0.484", "expert2_balance_top": "32.101", "expert2_balance_bottom": "17.018", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15286.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4130", "lr": "1.174e-05", "gnorm": "1.157", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "77012"}
2023-02-01 19:42:03 | INFO | train_inner | {"epoch": 6, "loss": "4.047", "moe_gate_loss": "12.8142", "overflow_expert1": "0.006", "overflow_expert2": "16.905", "entropy_gating": "0.399", "expert1_balance_top": "31.106", "expert1_balance_bottom": "17.514", "unused_expert1_count": "0.483", "expert2_balance_top": "32.079", "expert2_balance_bottom": "17.07", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.862", "ppl": "14.54", "wps": "15290.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4140", "lr": "1.172e-05", "gnorm": "1.167", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "77183"}
2023-02-01 19:44:55 | INFO | train_inner | {"epoch": 6, "loss": "4.065", "moe_gate_loss": "12.8218", "overflow_expert1": "0.004", "overflow_expert2": "16.978", "entropy_gating": "0.399", "expert1_balance_top": "31.166", "expert1_balance_bottom": "17.531", "unused_expert1_count": "0.489", "expert2_balance_top": "32.177", "expert2_balance_bottom": "17.102", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.88", "ppl": "14.72", "wps": "15291.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4150", "lr": "1.17e-05", "gnorm": "1.169", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "77355"}
2023-02-01 19:47:46 | INFO | train_inner | {"epoch": 6, "loss": "4.087", "moe_gate_loss": "12.8135", "overflow_expert1": "0.006", "overflow_expert2": "16.937", "entropy_gating": "0.399", "expert1_balance_top": "31.098", "expert1_balance_bottom": "17.543", "unused_expert1_count": "0.488", "expert2_balance_top": "32.072", "expert2_balance_bottom": "17.094", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.902", "ppl": "14.95", "wps": "15300.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4160", "lr": "1.168e-05", "gnorm": "1.173", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "77526"}
2023-02-01 19:50:38 | INFO | train_inner | {"epoch": 6, "loss": "4.054", "moe_gate_loss": "12.815", "overflow_expert1": "0.003", "overflow_expert2": "16.921", "entropy_gating": "0.4", "expert1_balance_top": "31.106", "expert1_balance_bottom": "17.547", "unused_expert1_count": "0.485", "expert2_balance_top": "32.099", "expert2_balance_bottom": "17.076", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.87", "ppl": "14.62", "wps": "15295.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4170", "lr": "1.166e-05", "gnorm": "1.185", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "77697"}
2023-02-01 19:53:29 | INFO | train_inner | {"epoch": 6, "loss": "4.078", "moe_gate_loss": "12.8126", "overflow_expert1": "0.005", "overflow_expert2": "16.904", "entropy_gating": "0.4", "expert1_balance_top": "31.102", "expert1_balance_bottom": "17.578", "unused_expert1_count": "0.489", "expert2_balance_top": "32.076", "expert2_balance_bottom": "17.109", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.893", "ppl": "14.86", "wps": "15279.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4180", "lr": "1.164e-05", "gnorm": "1.165", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "77869"}
2023-02-01 19:56:21 | INFO | train_inner | {"epoch": 6, "loss": "4.051", "moe_gate_loss": "12.8225", "overflow_expert1": "0.008", "overflow_expert2": "16.899", "entropy_gating": "0.398", "expert1_balance_top": "31.161", "expert1_balance_bottom": "17.549", "unused_expert1_count": "0.486", "expert2_balance_top": "32.044", "expert2_balance_bottom": "17.117", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.866", "ppl": "14.58", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4190", "lr": "1.162e-05", "gnorm": "1.186", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "78040"}
2023-02-01 19:59:12 | INFO | train_inner | {"epoch": 6, "loss": "4.07", "moe_gate_loss": "12.8157", "overflow_expert1": "0.006", "overflow_expert2": "16.963", "entropy_gating": "0.399", "expert1_balance_top": "31.125", "expert1_balance_bottom": "17.563", "unused_expert1_count": "0.488", "expert2_balance_top": "32.11", "expert2_balance_bottom": "17.098", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.885", "ppl": "14.77", "wps": "15287.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4200", "lr": "1.16e-05", "gnorm": "1.177", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "78212"}
2023-02-01 20:02:03 | INFO | train_inner | {"epoch": 6, "loss": "4.041", "moe_gate_loss": "12.8379", "overflow_expert1": "0.007", "overflow_expert2": "17.09", "entropy_gating": "0.4", "expert1_balance_top": "31.301", "expert1_balance_bottom": "17.438", "unused_expert1_count": "0.49", "expert2_balance_top": "32.069", "expert2_balance_bottom": "17.078", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.856", "ppl": "14.48", "wps": "15292", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4210", "lr": "1.158e-05", "gnorm": "1.199", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "78383"}
2023-02-01 20:04:55 | INFO | train_inner | {"epoch": 6, "loss": "4.118", "moe_gate_loss": "12.816", "overflow_expert1": "0.006", "overflow_expert2": "16.878", "entropy_gating": "0.399", "expert1_balance_top": "31.118", "expert1_balance_bottom": "17.568", "unused_expert1_count": "0.487", "expert2_balance_top": "32.045", "expert2_balance_bottom": "17.143", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.933", "ppl": "15.28", "wps": "15292.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4220", "lr": "1.156e-05", "gnorm": "1.19", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "78555"}
2023-02-01 20:07:46 | INFO | train_inner | {"epoch": 6, "loss": "4.068", "moe_gate_loss": "12.8206", "overflow_expert1": "0.009", "overflow_expert2": "16.991", "entropy_gating": "0.397", "expert1_balance_top": "31.141", "expert1_balance_bottom": "17.541", "unused_expert1_count": "0.484", "expert2_balance_top": "32.052", "expert2_balance_bottom": "17.125", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.883", "ppl": "14.75", "wps": "15290.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4230", "lr": "1.154e-05", "gnorm": "1.329", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "78726"}
2023-02-01 20:10:38 | INFO | train_inner | {"epoch": 6, "loss": "4.086", "moe_gate_loss": "12.8202", "overflow_expert1": "0.008", "overflow_expert2": "16.786", "entropy_gating": "0.398", "expert1_balance_top": "31.157", "expert1_balance_bottom": "17.567", "unused_expert1_count": "0.487", "expert2_balance_top": "32.04", "expert2_balance_bottom": "17.185", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.901", "ppl": "14.94", "wps": "15290.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4240", "lr": "1.152e-05", "gnorm": "1.186", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "78898"}
2023-02-01 20:13:29 | INFO | train_inner | {"epoch": 6, "loss": "4.139", "moe_gate_loss": "12.8567", "overflow_expert1": "0.011", "overflow_expert2": "17.428", "entropy_gating": "0.401", "expert1_balance_top": "31.405", "expert1_balance_bottom": "17.373", "unused_expert1_count": "0.488", "expert2_balance_top": "32.233", "expert2_balance_bottom": "16.981", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.954", "ppl": "15.5", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4250", "lr": "1.15e-05", "gnorm": "1.315", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "79069"}
2023-02-01 20:15:19 | INFO | valid_c4_small/C4_small | {"epoch": 6, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.545", "valid_c4_small/C4_small_overflow_expert1": "0.005", "valid_c4_small/C4_small_overflow_expert2": "12.48", "valid_c4_small/C4_small_entropy_gating": "0.429", "valid_c4_small/C4_small_expert1_balance_top": "31.309", "valid_c4_small/C4_small_expert1_balance_bottom": "18.638", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.643", "valid_c4_small/C4_small_expert2_balance_bottom": "18.127", "valid_c4_small/C4_small_unused_expert2_count": "0.378", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.34", "valid_c4_small/C4_small_wps": "51994.9", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "4250", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 20:15:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 4250 updates
2023-02-01 20:15:26 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 6 @ 4250 updates, score 4.211) (writing took 7.524759048130363 seconds)
2023-02-01 20:18:19 | INFO | train_inner | {"epoch": 6, "loss": "4.084", "moe_gate_loss": "12.8222", "overflow_expert1": "0.008", "overflow_expert2": "16.729", "entropy_gating": "0.398", "expert1_balance_top": "31.174", "expert1_balance_bottom": "17.569", "unused_expert1_count": "0.49", "expert2_balance_top": "32.034", "expert2_balance_bottom": "17.235", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.92", "wps": "9053.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "4260", "lr": "1.148e-05", "gnorm": "1.182", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "79359"}
2023-02-01 20:21:10 | INFO | train_inner | {"epoch": 6, "loss": "4.081", "moe_gate_loss": "12.8103", "overflow_expert1": "0.003", "overflow_expert2": "16.769", "entropy_gating": "0.4", "expert1_balance_top": "31.103", "expert1_balance_bottom": "17.623", "unused_expert1_count": "0.488", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.897", "ppl": "14.89", "wps": "15292.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4270", "lr": "1.146e-05", "gnorm": "1.17", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "79530"}
2023-02-01 20:24:02 | INFO | train_inner | {"epoch": 6, "loss": "4.052", "moe_gate_loss": "12.8352", "overflow_expert1": "0.004", "overflow_expert2": "17.1", "entropy_gating": "0.399", "expert1_balance_top": "31.255", "expert1_balance_bottom": "17.46", "unused_expert1_count": "0.483", "expert2_balance_top": "32.184", "expert2_balance_bottom": "17.066", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.867", "ppl": "14.59", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4280", "lr": "1.144e-05", "gnorm": "1.177", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "79702"}
2023-02-01 20:26:53 | INFO | train_inner | {"epoch": 6, "loss": "4.069", "moe_gate_loss": "12.8316", "overflow_expert1": "0.01", "overflow_expert2": "16.957", "entropy_gating": "0.398", "expert1_balance_top": "31.198", "expert1_balance_bottom": "17.512", "unused_expert1_count": "0.485", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.125", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.884", "ppl": "14.76", "wps": "15293.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4290", "lr": "1.142e-05", "gnorm": "1.182", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "79873"}
2023-02-01 20:29:45 | INFO | train_inner | {"epoch": 6, "loss": "4.089", "moe_gate_loss": "12.812", "overflow_expert1": "0.006", "overflow_expert2": "16.695", "entropy_gating": "0.398", "expert1_balance_top": "31.088", "expert1_balance_bottom": "17.614", "unused_expert1_count": "0.487", "expert2_balance_top": "31.937", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.904", "ppl": "14.97", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4300", "lr": "1.14e-05", "gnorm": "1.174", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "80044"}
2023-02-01 20:32:36 | INFO | train_inner | {"epoch": 6, "loss": "4.079", "moe_gate_loss": "12.8179", "overflow_expert1": "0.011", "overflow_expert2": "16.81", "entropy_gating": "0.4", "expert1_balance_top": "31.117", "expert1_balance_bottom": "17.598", "unused_expert1_count": "0.489", "expert2_balance_top": "32.102", "expert2_balance_bottom": "17.163", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.894", "ppl": "14.87", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4310", "lr": "1.138e-05", "gnorm": "1.179", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "80216"}
2023-02-01 20:35:27 | INFO | train_inner | {"epoch": 6, "loss": "4.055", "moe_gate_loss": "12.8351", "overflow_expert1": "0.009", "overflow_expert2": "16.961", "entropy_gating": "0.398", "expert1_balance_top": "31.235", "expert1_balance_bottom": "17.501", "unused_expert1_count": "0.491", "expert2_balance_top": "32.087", "expert2_balance_bottom": "17.132", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.87", "ppl": "14.62", "wps": "15295.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4320", "lr": "1.136e-05", "gnorm": "1.171", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "80387"}
2023-02-01 20:38:19 | INFO | train_inner | {"epoch": 6, "loss": "4.064", "moe_gate_loss": "12.8155", "overflow_expert1": "0.008", "overflow_expert2": "16.854", "entropy_gating": "0.398", "expert1_balance_top": "31.093", "expert1_balance_bottom": "17.6", "unused_expert1_count": "0.486", "expert2_balance_top": "32.073", "expert2_balance_bottom": "17.16", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.71", "wps": "15297.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4330", "lr": "1.134e-05", "gnorm": "1.169", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "80559"}
2023-02-01 20:41:10 | INFO | train_inner | {"epoch": 6, "loss": "4.068", "moe_gate_loss": "12.8111", "overflow_expert1": "0.006", "overflow_expert2": "16.63", "entropy_gating": "0.398", "expert1_balance_top": "31.107", "expert1_balance_bottom": "17.626", "unused_expert1_count": "0.487", "expert2_balance_top": "31.928", "expert2_balance_bottom": "17.246", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.883", "ppl": "14.76", "wps": "15294.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4340", "lr": "1.132e-05", "gnorm": "1.18", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "80730"}
2023-02-01 20:44:02 | INFO | train_inner | {"epoch": 6, "loss": "4.111", "moe_gate_loss": "12.8166", "overflow_expert1": "0.006", "overflow_expert2": "16.846", "entropy_gating": "0.399", "expert1_balance_top": "31.126", "expert1_balance_bottom": "17.584", "unused_expert1_count": "0.488", "expert2_balance_top": "32.043", "expert2_balance_bottom": "17.149", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.926", "ppl": "15.2", "wps": "15285.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4350", "lr": "1.13e-05", "gnorm": "1.175", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "80902"}
2023-02-01 20:46:53 | INFO | train_inner | {"epoch": 6, "loss": "4.039", "moe_gate_loss": "12.8317", "overflow_expert1": "0.007", "overflow_expert2": "17.021", "entropy_gating": "0.399", "expert1_balance_top": "31.234", "expert1_balance_bottom": "17.501", "unused_expert1_count": "0.483", "expert2_balance_top": "32.134", "expert2_balance_bottom": "17.108", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.854", "ppl": "14.46", "wps": "15295.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4360", "lr": "1.128e-05", "gnorm": "1.175", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "81073"}
2023-02-01 20:49:44 | INFO | train_inner | {"epoch": 6, "loss": "4.113", "moe_gate_loss": "12.8163", "overflow_expert1": "0.008", "overflow_expert2": "16.754", "entropy_gating": "0.399", "expert1_balance_top": "31.121", "expert1_balance_bottom": "17.603", "unused_expert1_count": "0.486", "expert2_balance_top": "31.996", "expert2_balance_bottom": "17.176", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.929", "ppl": "15.23", "wps": "15292.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4370", "lr": "1.126e-05", "gnorm": "1.173", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "81244"}
2023-02-01 20:52:36 | INFO | train_inner | {"epoch": 6, "loss": "4.118", "moe_gate_loss": "12.8058", "overflow_expert1": "0.006", "overflow_expert2": "16.629", "entropy_gating": "0.398", "expert1_balance_top": "31.039", "expert1_balance_bottom": "17.664", "unused_expert1_count": "0.485", "expert2_balance_top": "31.981", "expert2_balance_bottom": "17.214", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.933", "ppl": "15.27", "wps": "15293.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4380", "lr": "1.124e-05", "gnorm": "1.186", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "81416"}
2023-02-01 20:55:27 | INFO | train_inner | {"epoch": 6, "loss": "4.097", "moe_gate_loss": "12.8332", "overflow_expert1": "0.009", "overflow_expert2": "16.85", "entropy_gating": "0.397", "expert1_balance_top": "31.229", "expert1_balance_bottom": "17.512", "unused_expert1_count": "0.485", "expert2_balance_top": "32.058", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.912", "ppl": "15.06", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4390", "lr": "1.122e-05", "gnorm": "1.203", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "81587"}
2023-02-01 20:58:19 | INFO | train_inner | {"epoch": 6, "loss": "4.042", "moe_gate_loss": "12.8276", "overflow_expert1": "0.011", "overflow_expert2": "16.88", "entropy_gating": "0.397", "expert1_balance_top": "31.174", "expert1_balance_bottom": "17.549", "unused_expert1_count": "0.488", "expert2_balance_top": "32.094", "expert2_balance_bottom": "17.158", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15290.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4400", "lr": "1.12e-05", "gnorm": "1.178", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "81759"}
2023-02-01 21:01:10 | INFO | train_inner | {"epoch": 6, "loss": "4.051", "moe_gate_loss": "12.8036", "overflow_expert1": "0.005", "overflow_expert2": "16.68", "entropy_gating": "0.398", "expert1_balance_top": "31.028", "expert1_balance_bottom": "17.655", "unused_expert1_count": "0.483", "expert2_balance_top": "32.028", "expert2_balance_bottom": "17.186", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.867", "ppl": "14.59", "wps": "15292.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4410", "lr": "1.118e-05", "gnorm": "1.182", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "81930"}
2023-02-01 21:04:02 | INFO | train_inner | {"epoch": 6, "loss": "4.075", "moe_gate_loss": "12.8162", "overflow_expert1": "0.007", "overflow_expert2": "16.738", "entropy_gating": "0.398", "expert1_balance_top": "31.104", "expert1_balance_bottom": "17.602", "unused_expert1_count": "0.488", "expert2_balance_top": "32", "expert2_balance_bottom": "17.175", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.89", "ppl": "14.82", "wps": "15292.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4420", "lr": "1.116e-05", "gnorm": "1.188", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "82102"}
2023-02-01 21:06:53 | INFO | train_inner | {"epoch": 6, "loss": "4.119", "moe_gate_loss": "12.8206", "overflow_expert1": "0.012", "overflow_expert2": "16.829", "entropy_gating": "0.398", "expert1_balance_top": "31.14", "expert1_balance_bottom": "17.577", "unused_expert1_count": "0.49", "expert2_balance_top": "32.063", "expert2_balance_bottom": "17.153", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.934", "ppl": "15.28", "wps": "15289.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4430", "lr": "1.114e-05", "gnorm": "1.174", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "82273"}
2023-02-01 21:09:45 | INFO | train_inner | {"epoch": 6, "loss": "4.081", "moe_gate_loss": "12.8154", "overflow_expert1": "0.01", "overflow_expert2": "16.811", "entropy_gating": "0.399", "expert1_balance_top": "31.095", "expert1_balance_bottom": "17.606", "unused_expert1_count": "0.489", "expert2_balance_top": "32.068", "expert2_balance_bottom": "17.151", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.896", "ppl": "14.89", "wps": "15288.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4440", "lr": "1.112e-05", "gnorm": "1.172", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "82444"}
2023-02-01 21:12:36 | INFO | train_inner | {"epoch": 6, "loss": "4.077", "moe_gate_loss": "12.8218", "overflow_expert1": "0.007", "overflow_expert2": "16.815", "entropy_gating": "0.398", "expert1_balance_top": "31.167", "expert1_balance_bottom": "17.577", "unused_expert1_count": "0.488", "expert2_balance_top": "32.079", "expert2_balance_bottom": "17.178", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.892", "ppl": "14.85", "wps": "15280.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4450", "lr": "1.11e-05", "gnorm": "1.188", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "82616"}
2023-02-01 21:15:28 | INFO | train_inner | {"epoch": 6, "loss": "4.063", "moe_gate_loss": "12.8165", "overflow_expert1": "0.004", "overflow_expert2": "16.925", "entropy_gating": "0.398", "expert1_balance_top": "31.132", "expert1_balance_bottom": "17.596", "unused_expert1_count": "0.487", "expert2_balance_top": "32.096", "expert2_balance_bottom": "17.126", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.71", "wps": "15282.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4460", "lr": "1.108e-05", "gnorm": "1.179", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "82788"}
2023-02-01 21:18:19 | INFO | train_inner | {"epoch": 6, "loss": "4.086", "moe_gate_loss": "12.8165", "overflow_expert1": "0.005", "overflow_expert2": "16.665", "entropy_gating": "0.397", "expert1_balance_top": "31.125", "expert1_balance_bottom": "17.599", "unused_expert1_count": "0.489", "expert2_balance_top": "31.988", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.901", "ppl": "14.94", "wps": "15285.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4470", "lr": "1.106e-05", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "82959"}
2023-02-01 21:21:11 | INFO | train_inner | {"epoch": 6, "loss": "4.06", "moe_gate_loss": "12.8187", "overflow_expert1": "0.01", "overflow_expert2": "16.976", "entropy_gating": "0.398", "expert1_balance_top": "31.103", "expert1_balance_bottom": "17.581", "unused_expert1_count": "0.487", "expert2_balance_top": "32.126", "expert2_balance_bottom": "17.096", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.875", "ppl": "14.67", "wps": "15285.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4480", "lr": "1.104e-05", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "83131"}
2023-02-01 21:24:02 | INFO | train_inner | {"epoch": 6, "loss": "4.057", "moe_gate_loss": "12.8292", "overflow_expert1": "0.011", "overflow_expert2": "16.891", "entropy_gating": "0.397", "expert1_balance_top": "31.179", "expert1_balance_bottom": "17.547", "unused_expert1_count": "0.487", "expert2_balance_top": "32.106", "expert2_balance_bottom": "17.146", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15287", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4490", "lr": "1.102e-05", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "83302"}
2023-02-01 21:26:54 | INFO | train_inner | {"epoch": 6, "loss": "4.09", "moe_gate_loss": "12.8247", "overflow_expert1": "0.007", "overflow_expert2": "16.892", "entropy_gating": "0.397", "expert1_balance_top": "31.176", "expert1_balance_bottom": "17.551", "unused_expert1_count": "0.489", "expert2_balance_top": "32.062", "expert2_balance_bottom": "17.148", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.905", "ppl": "14.98", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4500", "lr": "1.1e-05", "gnorm": "1.179", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "83474"}
2023-02-01 21:28:43 | INFO | valid_c4_small/C4_small | {"epoch": 6, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.5221", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.372", "valid_c4_small/C4_small_entropy_gating": "0.428", "valid_c4_small/C4_small_expert1_balance_top": "31.128", "valid_c4_small/C4_small_expert1_balance_bottom": "18.784", "valid_c4_small/C4_small_unused_expert1_count": "0.458", "valid_c4_small/C4_small_expert2_balance_top": "31.686", "valid_c4_small/C4_small_expert2_balance_bottom": "18.082", "valid_c4_small/C4_small_unused_expert2_count": "0.376", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.029", "valid_c4_small/C4_small_ppl": "16.33", "valid_c4_small/C4_small_wps": "52028.5", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "4500", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 21:28:43 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 4500 updates
2023-02-01 21:28:51 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 6 @ 4500 updates, score 4.21) (writing took 7.5093087470158935 seconds)
2023-02-01 21:31:43 | INFO | train_inner | {"epoch": 6, "loss": "4.079", "moe_gate_loss": "12.821", "overflow_expert1": "0.012", "overflow_expert2": "16.775", "entropy_gating": "0.397", "expert1_balance_top": "31.136", "expert1_balance_bottom": "17.594", "unused_expert1_count": "0.487", "expert2_balance_top": "32.042", "expert2_balance_bottom": "17.178", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.894", "ppl": "14.87", "wps": "9054.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "4510", "lr": "1.098e-05", "gnorm": "1.187", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "83763"}
2023-02-01 21:34:35 | INFO | train_inner | {"epoch": 6, "loss": "4.083", "moe_gate_loss": "12.8132", "overflow_expert1": "0.006", "overflow_expert2": "16.749", "entropy_gating": "0.397", "expert1_balance_top": "31.106", "expert1_balance_bottom": "17.635", "unused_expert1_count": "0.489", "expert2_balance_top": "32.05", "expert2_balance_bottom": "17.193", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.9", "wps": "15283.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4520", "lr": "1.096e-05", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "83935"}
2023-02-01 21:37:26 | INFO | train_inner | {"epoch": 6, "loss": "4.158", "moe_gate_loss": "12.8234", "overflow_expert1": "0.006", "overflow_expert2": "17.048", "entropy_gating": "0.398", "expert1_balance_top": "31.182", "expert1_balance_bottom": "17.572", "unused_expert1_count": "0.485", "expert2_balance_top": "32.17", "expert2_balance_bottom": "17.089", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.973", "ppl": "15.7", "wps": "15285.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4530", "lr": "1.094e-05", "gnorm": "1.181", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "84106"}
2023-02-01 21:40:18 | INFO | train_inner | {"epoch": 6, "loss": "4.103", "moe_gate_loss": "12.8045", "overflow_expert1": "0.003", "overflow_expert2": "16.644", "entropy_gating": "0.397", "expert1_balance_top": "31.043", "expert1_balance_bottom": "17.644", "unused_expert1_count": "0.486", "expert2_balance_top": "32.028", "expert2_balance_bottom": "17.166", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.918", "ppl": "15.11", "wps": "15282.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4540", "lr": "1.092e-05", "gnorm": "1.178", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "84278"}
2023-02-01 21:43:09 | INFO | train_inner | {"epoch": 6, "loss": "4.047", "moe_gate_loss": "12.8189", "overflow_expert1": "0.008", "overflow_expert2": "16.94", "entropy_gating": "0.397", "expert1_balance_top": "31.135", "expert1_balance_bottom": "17.59", "unused_expert1_count": "0.486", "expert2_balance_top": "32.116", "expert2_balance_bottom": "17.137", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.862", "ppl": "14.54", "wps": "15290.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4550", "lr": "1.09e-05", "gnorm": "1.188", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "84449"}
2023-02-01 21:46:00 | INFO | train_inner | {"epoch": 6, "loss": "4.084", "moe_gate_loss": "12.8329", "overflow_expert1": "0.009", "overflow_expert2": "16.983", "entropy_gating": "0.398", "expert1_balance_top": "31.231", "expert1_balance_bottom": "17.521", "unused_expert1_count": "0.49", "expert2_balance_top": "32.144", "expert2_balance_bottom": "17.115", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.92", "wps": "15294.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4560", "lr": "1.088e-05", "gnorm": "1.213", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "84620"}
2023-02-01 21:48:52 | INFO | train_inner | {"epoch": 6, "loss": "4.08", "moe_gate_loss": "12.8079", "overflow_expert1": "0.006", "overflow_expert2": "16.712", "entropy_gating": "0.397", "expert1_balance_top": "31.068", "expert1_balance_bottom": "17.664", "unused_expert1_count": "0.489", "expert2_balance_top": "32.005", "expert2_balance_bottom": "17.209", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.895", "ppl": "14.88", "wps": "15286", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4570", "lr": "1.086e-05", "gnorm": "1.176", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "84792"}
2023-02-01 21:51:43 | INFO | train_inner | {"epoch": 6, "loss": "4.051", "moe_gate_loss": "12.8043", "overflow_expert1": "0.006", "overflow_expert2": "16.807", "entropy_gating": "0.397", "expert1_balance_top": "31.037", "expert1_balance_bottom": "17.679", "unused_expert1_count": "0.489", "expert2_balance_top": "32.142", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.867", "ppl": "14.59", "wps": "15291.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4580", "lr": "1.084e-05", "gnorm": "1.172", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "84963"}
2023-02-01 21:54:35 | INFO | train_inner | {"epoch": 6, "loss": "4.054", "moe_gate_loss": "12.8401", "overflow_expert1": "0.015", "overflow_expert2": "17.07", "entropy_gating": "0.396", "expert1_balance_top": "31.23", "expert1_balance_bottom": "17.481", "unused_expert1_count": "0.485", "expert2_balance_top": "32.17", "expert2_balance_bottom": "17.062", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.869", "ppl": "14.61", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4590", "lr": "1.082e-05", "gnorm": "1.216", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "85135"}
2023-02-01 21:57:26 | INFO | train_inner | {"epoch": 6, "loss": "4.067", "moe_gate_loss": "12.8125", "overflow_expert1": "0.006", "overflow_expert2": "16.777", "entropy_gating": "0.397", "expert1_balance_top": "31.105", "expert1_balance_bottom": "17.637", "unused_expert1_count": "0.486", "expert2_balance_top": "32.081", "expert2_balance_bottom": "17.161", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.882", "ppl": "14.74", "wps": "15294.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4600", "lr": "1.08e-05", "gnorm": "1.18", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "85306"}
2023-02-01 22:00:18 | INFO | train_inner | {"epoch": 6, "loss": "4.081", "moe_gate_loss": "12.8042", "overflow_expert1": "0.004", "overflow_expert2": "16.623", "entropy_gating": "0.397", "expert1_balance_top": "31.055", "expert1_balance_bottom": "17.681", "unused_expert1_count": "0.484", "expert2_balance_top": "32.01", "expert2_balance_bottom": "17.243", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.896", "ppl": "14.89", "wps": "15276.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4610", "lr": "1.078e-05", "gnorm": "1.19", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "85478"}
2023-02-01 22:03:09 | INFO | train_inner | {"epoch": 6, "loss": "4.057", "moe_gate_loss": "12.8266", "overflow_expert1": "0.01", "overflow_expert2": "16.911", "entropy_gating": "0.397", "expert1_balance_top": "31.214", "expert1_balance_bottom": "17.568", "unused_expert1_count": "0.488", "expert2_balance_top": "32.153", "expert2_balance_bottom": "17.152", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15278.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4620", "lr": "1.076e-05", "gnorm": "1.176", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "85649"}
2023-02-01 22:06:01 | INFO | train_inner | {"epoch": 6, "loss": "4.066", "moe_gate_loss": "12.8087", "overflow_expert1": "0.008", "overflow_expert2": "16.681", "entropy_gating": "0.397", "expert1_balance_top": "31.064", "expert1_balance_bottom": "17.659", "unused_expert1_count": "0.484", "expert2_balance_top": "32.096", "expert2_balance_bottom": "17.197", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.881", "ppl": "14.74", "wps": "15292.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4630", "lr": "1.074e-05", "gnorm": "1.204", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "85821"}
2023-02-01 22:08:52 | INFO | train_inner | {"epoch": 6, "loss": "4.027", "moe_gate_loss": "12.8261", "overflow_expert1": "0.005", "overflow_expert2": "16.895", "entropy_gating": "0.396", "expert1_balance_top": "31.181", "expert1_balance_bottom": "17.549", "unused_expert1_count": "0.481", "expert2_balance_top": "32.114", "expert2_balance_bottom": "17.175", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4640", "lr": "1.072e-05", "gnorm": "1.165", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "85992"}
2023-02-01 22:11:44 | INFO | train_inner | {"epoch": 6, "loss": "4.038", "moe_gate_loss": "12.8098", "overflow_expert1": "0.005", "overflow_expert2": "16.71", "entropy_gating": "0.397", "expert1_balance_top": "31.089", "expert1_balance_bottom": "17.635", "unused_expert1_count": "0.487", "expert2_balance_top": "32.062", "expert2_balance_bottom": "17.193", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15280.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4650", "lr": "1.07e-05", "gnorm": "1.169", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "86164"}
2023-02-01 22:14:35 | INFO | train_inner | {"epoch": 6, "loss": "4.021", "moe_gate_loss": "12.8061", "overflow_expert1": "0.009", "overflow_expert2": "16.692", "entropy_gating": "0.397", "expert1_balance_top": "31.021", "expert1_balance_bottom": "17.658", "unused_expert1_count": "0.489", "expert2_balance_top": "31.987", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15294.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4660", "lr": "1.068e-05", "gnorm": "1.189", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "86335"}
2023-02-01 22:17:44 | INFO | train_inner | {"epoch": 6, "loss": "4.072", "moe_gate_loss": "12.8087", "overflow_expert1": "0.007", "overflow_expert2": "16.611", "entropy_gating": "0.396", "expert1_balance_top": "31.052", "expert1_balance_bottom": "17.648", "unused_expert1_count": "0.49", "expert2_balance_top": "31.973", "expert2_balance_bottom": "17.201", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.887", "ppl": "14.8", "wps": "13903.7", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "4670", "lr": "1.066e-05", "gnorm": "1.161", "clip": "100", "loss_scale": "4", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "86524"}
2023-02-01 22:20:35 | INFO | train_inner | {"epoch": 6, "loss": "4.079", "moe_gate_loss": "12.804", "overflow_expert1": "0.007", "overflow_expert2": "16.609", "entropy_gating": "0.396", "expert1_balance_top": "31.028", "expert1_balance_bottom": "17.666", "unused_expert1_count": "0.489", "expert2_balance_top": "32.005", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.894", "ppl": "14.86", "wps": "15290.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4680", "lr": "1.064e-05", "gnorm": "1.176", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "86695"}
2023-02-01 22:23:27 | INFO | train_inner | {"epoch": 6, "loss": "4.09", "moe_gate_loss": "12.7981", "overflow_expert1": "0.005", "overflow_expert2": "16.631", "entropy_gating": "0.398", "expert1_balance_top": "30.995", "expert1_balance_bottom": "17.709", "unused_expert1_count": "0.487", "expert2_balance_top": "32.067", "expert2_balance_bottom": "17.192", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.905", "ppl": "14.98", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4690", "lr": "1.062e-05", "gnorm": "1.17", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "86867"}
2023-02-01 22:26:18 | INFO | train_inner | {"epoch": 6, "loss": "4.094", "moe_gate_loss": "12.8044", "overflow_expert1": "0.01", "overflow_expert2": "16.662", "entropy_gating": "0.396", "expert1_balance_top": "31.03", "expert1_balance_bottom": "17.688", "unused_expert1_count": "0.489", "expert2_balance_top": "32.015", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.909", "ppl": "15.02", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4700", "lr": "1.06e-05", "gnorm": "1.179", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "87038"}
2023-02-01 22:29:10 | INFO | train_inner | {"epoch": 6, "loss": "4.074", "moe_gate_loss": "12.8093", "overflow_expert1": "0.006", "overflow_expert2": "16.732", "entropy_gating": "0.397", "expert1_balance_top": "31.061", "expert1_balance_bottom": "17.627", "unused_expert1_count": "0.487", "expert2_balance_top": "32.015", "expert2_balance_bottom": "17.192", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.889", "ppl": "14.82", "wps": "15298.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4710", "lr": "1.058e-05", "gnorm": "1.199", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "87209"}
2023-02-01 22:32:01 | INFO | train_inner | {"epoch": 6, "loss": "4.127", "moe_gate_loss": "12.8086", "overflow_expert1": "0.007", "overflow_expert2": "16.804", "entropy_gating": "0.398", "expert1_balance_top": "31.075", "expert1_balance_bottom": "17.655", "unused_expert1_count": "0.483", "expert2_balance_top": "32.092", "expert2_balance_bottom": "17.177", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.943", "ppl": "15.38", "wps": "15294.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4720", "lr": "1.056e-05", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "87381"}
2023-02-01 22:34:52 | INFO | train_inner | {"epoch": 6, "loss": "4.128", "moe_gate_loss": "12.7917", "overflow_expert1": "0.003", "overflow_expert2": "16.472", "entropy_gating": "0.397", "expert1_balance_top": "30.97", "expert1_balance_bottom": "17.722", "unused_expert1_count": "0.488", "expert2_balance_top": "32.013", "expert2_balance_bottom": "17.247", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.943", "ppl": "15.38", "wps": "15295.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4730", "lr": "1.054e-05", "gnorm": "1.18", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "87552"}
2023-02-01 22:37:44 | INFO | train_inner | {"epoch": 6, "loss": "4.088", "moe_gate_loss": "12.7957", "overflow_expert1": "0.004", "overflow_expert2": "16.494", "entropy_gating": "0.397", "expert1_balance_top": "30.996", "expert1_balance_bottom": "17.724", "unused_expert1_count": "0.491", "expert2_balance_top": "31.969", "expert2_balance_bottom": "17.236", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.903", "ppl": "14.96", "wps": "15293.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4740", "lr": "1.052e-05", "gnorm": "1.173", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "87724"}
2023-02-01 22:40:35 | INFO | train_inner | {"epoch": 6, "loss": "4.127", "moe_gate_loss": "12.8002", "overflow_expert1": "0.007", "overflow_expert2": "16.679", "entropy_gating": "0.398", "expert1_balance_top": "30.987", "expert1_balance_bottom": "17.686", "unused_expert1_count": "0.491", "expert2_balance_top": "32.063", "expert2_balance_bottom": "17.173", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.943", "ppl": "15.38", "wps": "15296.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4750", "lr": "1.05e-05", "gnorm": "1.186", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "87895"}
2023-02-01 22:42:25 | INFO | valid_c4_small/C4_small | {"epoch": 6, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.514", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.081", "valid_c4_small/C4_small_entropy_gating": "0.427", "valid_c4_small/C4_small_expert1_balance_top": "31.083", "valid_c4_small/C4_small_expert1_balance_bottom": "18.901", "valid_c4_small/C4_small_unused_expert1_count": "0.456", "valid_c4_small/C4_small_expert2_balance_top": "31.585", "valid_c4_small/C4_small_expert2_balance_bottom": "18.139", "valid_c4_small/C4_small_unused_expert2_count": "0.384", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.029", "valid_c4_small/C4_small_ppl": "16.33", "valid_c4_small/C4_small_wps": "52046.4", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "4750", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 22:42:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 4750 updates
2023-02-01 22:42:32 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 6 @ 4750 updates, score 4.21) (writing took 7.53910576319322 seconds)
2023-02-01 22:45:25 | INFO | train_inner | {"epoch": 6, "loss": "4.063", "moe_gate_loss": "12.8108", "overflow_expert1": "0.008", "overflow_expert2": "16.785", "entropy_gating": "0.397", "expert1_balance_top": "31.067", "expert1_balance_bottom": "17.643", "unused_expert1_count": "0.486", "expert2_balance_top": "31.996", "expert2_balance_bottom": "17.165", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.878", "ppl": "14.71", "wps": "9050", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "4760", "lr": "1.048e-05", "gnorm": "1.18", "clip": "100", "loss_scale": "4", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "88185"}
2023-02-01 22:48:16 | INFO | train_inner | {"epoch": 6, "loss": "4.085", "moe_gate_loss": "12.8081", "overflow_expert1": "0.01", "overflow_expert2": "16.609", "entropy_gating": "0.396", "expert1_balance_top": "31.058", "expert1_balance_bottom": "17.648", "unused_expert1_count": "0.489", "expert2_balance_top": "31.991", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.9", "ppl": "14.93", "wps": "15280", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4770", "lr": "1.046e-05", "gnorm": "1.171", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "88356"}
2023-02-01 22:51:08 | INFO | train_inner | {"epoch": 6, "loss": "4.077", "moe_gate_loss": "12.8083", "overflow_expert1": "0.007", "overflow_expert2": "16.831", "entropy_gating": "0.398", "expert1_balance_top": "31.073", "expert1_balance_bottom": "17.654", "unused_expert1_count": "0.488", "expert2_balance_top": "32.116", "expert2_balance_bottom": "17.157", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.893", "ppl": "14.85", "wps": "15288.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4780", "lr": "1.044e-05", "gnorm": "1.177", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "88528"}
2023-02-01 22:53:59 | INFO | train_inner | {"epoch": 6, "loss": "4.084", "moe_gate_loss": "12.7985", "overflow_expert1": "0.005", "overflow_expert2": "16.575", "entropy_gating": "0.397", "expert1_balance_top": "31.001", "expert1_balance_bottom": "17.709", "unused_expert1_count": "0.489", "expert2_balance_top": "32.012", "expert2_balance_bottom": "17.214", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.92", "wps": "15278.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4790", "lr": "1.042e-05", "gnorm": "1.17", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "88699"}
2023-02-01 22:56:51 | INFO | train_inner | {"epoch": 6, "loss": "4.089", "moe_gate_loss": "12.7956", "overflow_expert1": "0.005", "overflow_expert2": "16.554", "entropy_gating": "0.398", "expert1_balance_top": "30.98", "expert1_balance_bottom": "17.732", "unused_expert1_count": "0.489", "expert2_balance_top": "32.024", "expert2_balance_bottom": "17.254", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.904", "ppl": "14.97", "wps": "15286.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4800", "lr": "1.04e-05", "gnorm": "1.17", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "88871"}
2023-02-01 22:59:42 | INFO | train_inner | {"epoch": 6, "loss": "4.117", "moe_gate_loss": "12.794", "overflow_expert1": "0.005", "overflow_expert2": "16.498", "entropy_gating": "0.397", "expert1_balance_top": "30.955", "expert1_balance_bottom": "17.721", "unused_expert1_count": "0.485", "expert2_balance_top": "32.015", "expert2_balance_bottom": "17.214", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.932", "ppl": "15.26", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4810", "lr": "1.038e-05", "gnorm": "1.169", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "89042"}
2023-02-01 23:02:34 | INFO | train_inner | {"epoch": 6, "loss": "4.092", "moe_gate_loss": "12.8326", "overflow_expert1": "0.01", "overflow_expert2": "17.128", "entropy_gating": "0.396", "expert1_balance_top": "31.211", "expert1_balance_bottom": "17.529", "unused_expert1_count": "0.487", "expert2_balance_top": "32.175", "expert2_balance_bottom": "17.067", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.907", "ppl": "15", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4820", "lr": "1.036e-05", "gnorm": "1.182", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "89214"}
2023-02-01 23:05:25 | INFO | train_inner | {"epoch": 6, "loss": "4.087", "moe_gate_loss": "12.7993", "overflow_expert1": "0.007", "overflow_expert2": "16.501", "entropy_gating": "0.397", "expert1_balance_top": "31.003", "expert1_balance_bottom": "17.717", "unused_expert1_count": "0.489", "expert2_balance_top": "31.977", "expert2_balance_bottom": "17.24", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.902", "ppl": "14.95", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4830", "lr": "1.034e-05", "gnorm": "1.166", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "89385"}
2023-02-01 23:08:17 | INFO | train_inner | {"epoch": 6, "loss": "4.053", "moe_gate_loss": "12.8117", "overflow_expert1": "0.005", "overflow_expert2": "16.827", "entropy_gating": "0.398", "expert1_balance_top": "31.097", "expert1_balance_bottom": "17.642", "unused_expert1_count": "0.488", "expert2_balance_top": "32.078", "expert2_balance_bottom": "17.116", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.868", "ppl": "14.6", "wps": "15280.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4840", "lr": "1.032e-05", "gnorm": "1.182", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "89557"}
2023-02-01 23:11:08 | INFO | train_inner | {"epoch": 6, "loss": "4.099", "moe_gate_loss": "12.8139", "overflow_expert1": "0.005", "overflow_expert2": "16.752", "entropy_gating": "0.397", "expert1_balance_top": "31.107", "expert1_balance_bottom": "17.618", "unused_expert1_count": "0.49", "expert2_balance_top": "32.047", "expert2_balance_bottom": "17.188", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.914", "ppl": "15.07", "wps": "15280.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4850", "lr": "1.03e-05", "gnorm": "1.176", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "89728"}
2023-02-01 23:14:00 | INFO | train_inner | {"epoch": 6, "loss": "4.079", "moe_gate_loss": "12.8159", "overflow_expert1": "0.007", "overflow_expert2": "16.936", "entropy_gating": "0.397", "expert1_balance_top": "31.121", "expert1_balance_bottom": "17.63", "unused_expert1_count": "0.484", "expert2_balance_top": "32.114", "expert2_balance_bottom": "17.114", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.894", "ppl": "14.87", "wps": "15278.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4860", "lr": "1.028e-05", "gnorm": "1.173", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "89900"}
2023-02-01 23:16:52 | INFO | train_inner | {"epoch": 6, "loss": "4.083", "moe_gate_loss": "12.7967", "overflow_expert1": "0.007", "overflow_expert2": "16.485", "entropy_gating": "0.398", "expert1_balance_top": "30.973", "expert1_balance_bottom": "17.736", "unused_expert1_count": "0.486", "expert2_balance_top": "31.949", "expert2_balance_bottom": "17.239", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.91", "wps": "15281.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4870", "lr": "1.026e-05", "gnorm": "1.168", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "90071"}
2023-02-01 23:19:43 | INFO | train_inner | {"epoch": 6, "loss": "4.117", "moe_gate_loss": "12.7914", "overflow_expert1": "0.004", "overflow_expert2": "16.449", "entropy_gating": "0.398", "expert1_balance_top": "30.961", "expert1_balance_bottom": "17.754", "unused_expert1_count": "0.487", "expert2_balance_top": "31.951", "expert2_balance_bottom": "17.234", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.932", "ppl": "15.27", "wps": "15269", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4880", "lr": "1.024e-05", "gnorm": "1.173", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "90243"}
2023-02-01 23:22:35 | INFO | train_inner | {"epoch": 6, "loss": "4.083", "moe_gate_loss": "12.7915", "overflow_expert1": "0.007", "overflow_expert2": "16.392", "entropy_gating": "0.396", "expert1_balance_top": "30.931", "expert1_balance_bottom": "17.755", "unused_expert1_count": "0.486", "expert2_balance_top": "31.912", "expert2_balance_bottom": "17.263", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.91", "wps": "15279", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4890", "lr": "1.022e-05", "gnorm": "1.159", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "90415"}
2023-02-01 23:25:24 | INFO | valid_c4_small/C4_small | {"epoch": 6, "valid_c4_small/C4_small_loss": "4.207", "valid_c4_small/C4_small_moe_gate_loss": "12.5041", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.961", "valid_c4_small/C4_small_entropy_gating": "0.428", "valid_c4_small/C4_small_expert1_balance_top": "30.895", "valid_c4_small/C4_small_expert1_balance_bottom": "18.998", "valid_c4_small/C4_small_unused_expert1_count": "0.454", "valid_c4_small/C4_small_expert2_balance_top": "31.569", "valid_c4_small/C4_small_expert2_balance_bottom": "18.167", "valid_c4_small/C4_small_unused_expert2_count": "0.379", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.027", "valid_c4_small/C4_small_ppl": "16.3", "valid_c4_small/C4_small_wps": "52059.5", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "4893", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 23:25:24 | INFO | fairseq_cli.train | end of epoch 6 (average epoch stats below)
2023-02-01 23:25:24 | INFO | train | {"epoch": 6, "train_loss": "4.079", "train_moe_gate_loss": "12.8147", "train_overflow_expert1": "0.007", "train_overflow_expert2": "16.814", "train_entropy_gating": "0.398", "train_expert1_balance_top": "31.108", "train_expert1_balance_bottom": "17.603", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "32.067", "train_expert2_balance_bottom": "17.155", "train_unused_expert2_count": "0.448", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.894", "train_ppl": "14.87", "train_wps": "14772.9", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "4893", "train_lr": "1.0214e-05", "train_gnorm": "1.182", "train_clip": "100", "train_loss_scale": "2", "train_train_wall": "13572", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "90584"}
2023-02-01 23:25:24 | INFO | fairseq.trainer | begin training epoch 7
2023-02-01 23:27:24 | INFO | train_inner | {"epoch": 7, "loss": "4.1", "moe_gate_loss": "12.7938", "overflow_expert1": "0.007", "overflow_expert2": "16.584", "entropy_gating": "0.398", "expert1_balance_top": "30.956", "expert1_balance_bottom": "17.73", "unused_expert1_count": "0.48", "expert2_balance_top": "32.067", "expert2_balance_bottom": "17.186", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.915", "ppl": "15.09", "wps": "9067.1", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "4900", "lr": "1.02e-05", "gnorm": "1.168", "clip": "100", "loss_scale": "2", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "90704"}
2023-02-01 23:30:15 | INFO | train_inner | {"epoch": 7, "loss": "4.102", "moe_gate_loss": "12.7996", "overflow_expert1": "0.008", "overflow_expert2": "16.76", "entropy_gating": "0.399", "expert1_balance_top": "30.998", "expert1_balance_bottom": "17.694", "unused_expert1_count": "0.489", "expert2_balance_top": "32.124", "expert2_balance_bottom": "17.129", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.917", "ppl": "15.11", "wps": "15285.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4910", "lr": "1.018e-05", "gnorm": "1.178", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "90875"}
2023-02-01 23:33:07 | INFO | train_inner | {"epoch": 7, "loss": "4.037", "moe_gate_loss": "12.8077", "overflow_expert1": "0.006", "overflow_expert2": "17.173", "entropy_gating": "0.398", "expert1_balance_top": "31.061", "expert1_balance_bottom": "17.574", "unused_expert1_count": "0.489", "expert2_balance_top": "32.322", "expert2_balance_bottom": "16.949", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.852", "ppl": "14.44", "wps": "15279.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4920", "lr": "1.016e-05", "gnorm": "1.187", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "91047"}
2023-02-01 23:35:59 | INFO | train_inner | {"epoch": 7, "loss": "4.045", "moe_gate_loss": "12.8058", "overflow_expert1": "0.006", "overflow_expert2": "16.93", "entropy_gating": "0.397", "expert1_balance_top": "31.058", "expert1_balance_bottom": "17.585", "unused_expert1_count": "0.488", "expert2_balance_top": "32.078", "expert2_balance_bottom": "17.025", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "15276", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4930", "lr": "1.014e-05", "gnorm": "1.189", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "91218"}
2023-02-01 23:38:50 | INFO | train_inner | {"epoch": 7, "loss": "4.027", "moe_gate_loss": "12.8147", "overflow_expert1": "0.004", "overflow_expert2": "17.26", "entropy_gating": "0.398", "expert1_balance_top": "31.133", "expert1_balance_bottom": "17.518", "unused_expert1_count": "0.483", "expert2_balance_top": "32.214", "expert2_balance_bottom": "16.965", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15280.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4940", "lr": "1.012e-05", "gnorm": "1.193", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "91390"}
2023-02-01 23:41:42 | INFO | train_inner | {"epoch": 7, "loss": "4.008", "moe_gate_loss": "12.8164", "overflow_expert1": "0.007", "overflow_expert2": "17.093", "entropy_gating": "0.398", "expert1_balance_top": "31.137", "expert1_balance_bottom": "17.546", "unused_expert1_count": "0.486", "expert2_balance_top": "32.183", "expert2_balance_bottom": "17.019", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.16", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4950", "lr": "1.01e-05", "gnorm": "1.187", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "91561"}
2023-02-01 23:44:33 | INFO | train_inner | {"epoch": 7, "loss": "3.997", "moe_gate_loss": "12.8027", "overflow_expert1": "0.005", "overflow_expert2": "16.632", "entropy_gating": "0.397", "expert1_balance_top": "31.034", "expert1_balance_bottom": "17.621", "unused_expert1_count": "0.489", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.184", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.813", "ppl": "14.05", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4960", "lr": "1.008e-05", "gnorm": "1.193", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "91733"}
2023-02-01 23:47:25 | INFO | train_inner | {"epoch": 7, "loss": "4.074", "moe_gate_loss": "12.8116", "overflow_expert1": "0.004", "overflow_expert2": "16.89", "entropy_gating": "0.396", "expert1_balance_top": "31.078", "expert1_balance_bottom": "17.6", "unused_expert1_count": "0.487", "expert2_balance_top": "32.13", "expert2_balance_bottom": "17.102", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.889", "ppl": "14.82", "wps": "15285.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4970", "lr": "1.006e-05", "gnorm": "1.196", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "91904"}
2023-02-01 23:50:16 | INFO | train_inner | {"epoch": 7, "loss": "4.046", "moe_gate_loss": "12.8075", "overflow_expert1": "0.006", "overflow_expert2": "16.841", "entropy_gating": "0.397", "expert1_balance_top": "31.054", "expert1_balance_bottom": "17.604", "unused_expert1_count": "0.488", "expert2_balance_top": "32.035", "expert2_balance_bottom": "17.091", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.861", "ppl": "14.53", "wps": "15288", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4980", "lr": "1.004e-05", "gnorm": "1.205", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "92076"}
2023-02-01 23:53:08 | INFO | train_inner | {"epoch": 7, "loss": "4.05", "moe_gate_loss": "12.8065", "overflow_expert1": "0.004", "overflow_expert2": "16.828", "entropy_gating": "0.397", "expert1_balance_top": "31.035", "expert1_balance_bottom": "17.607", "unused_expert1_count": "0.486", "expert2_balance_top": "32.085", "expert2_balance_bottom": "17.077", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.865", "ppl": "14.57", "wps": "15273.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "4990", "lr": "1.002e-05", "gnorm": "1.209", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "92248"}
2023-02-01 23:55:59 | INFO | train_inner | {"epoch": 7, "loss": "4.022", "moe_gate_loss": "12.8125", "overflow_expert1": "0.005", "overflow_expert2": "16.869", "entropy_gating": "0.397", "expert1_balance_top": "31.093", "expert1_balance_bottom": "17.599", "unused_expert1_count": "0.489", "expert2_balance_top": "32.08", "expert2_balance_bottom": "17.101", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.838", "ppl": "14.3", "wps": "15271.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5000", "lr": "1e-05", "gnorm": "1.181", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "92419"}
2023-02-01 23:57:49 | INFO | valid_c4_small/C4_small | {"epoch": 7, "valid_c4_small/C4_small_loss": "4.213", "valid_c4_small/C4_small_moe_gate_loss": "12.5223", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.123", "valid_c4_small/C4_small_entropy_gating": "0.427", "valid_c4_small/C4_small_expert1_balance_top": "31.152", "valid_c4_small/C4_small_expert1_balance_bottom": "18.742", "valid_c4_small/C4_small_unused_expert1_count": "0.456", "valid_c4_small/C4_small_expert2_balance_top": "31.421", "valid_c4_small/C4_small_expert2_balance_bottom": "18.155", "valid_c4_small/C4_small_unused_expert2_count": "0.384", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.033", "valid_c4_small/C4_small_ppl": "16.36", "valid_c4_small/C4_small_wps": "52030.2", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "5000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-01 23:57:49 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 5000 updates
2023-02-01 23:57:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 7 @ 5000 updates, score 4.213) (writing took 7.474505434278399 seconds)
2023-02-02 00:00:49 | INFO | train_inner | {"epoch": 7, "loss": "4.056", "moe_gate_loss": "12.81", "overflow_expert1": "0.007", "overflow_expert2": "16.718", "entropy_gating": "0.397", "expert1_balance_top": "31.067", "expert1_balance_bottom": "17.631", "unused_expert1_count": "0.49", "expert2_balance_top": "32.03", "expert2_balance_bottom": "17.15", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.871", "ppl": "14.63", "wps": "9050.7", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "5010", "lr": "9.98e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "92709"}
2023-02-02 00:03:41 | INFO | train_inner | {"epoch": 7, "loss": "4.044", "moe_gate_loss": "12.8008", "overflow_expert1": "0.004", "overflow_expert2": "16.695", "entropy_gating": "0.397", "expert1_balance_top": "31.014", "expert1_balance_bottom": "17.667", "unused_expert1_count": "0.487", "expert2_balance_top": "32.024", "expert2_balance_bottom": "17.174", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.859", "ppl": "14.51", "wps": "15279.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5020", "lr": "9.96e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "92880"}
2023-02-02 00:06:32 | INFO | train_inner | {"epoch": 7, "loss": "4.027", "moe_gate_loss": "12.8254", "overflow_expert1": "0.007", "overflow_expert2": "16.88", "entropy_gating": "0.398", "expert1_balance_top": "31.196", "expert1_balance_bottom": "17.526", "unused_expert1_count": "0.484", "expert2_balance_top": "32.038", "expert2_balance_bottom": "17.133", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15287.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5030", "lr": "9.94e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "93052"}
2023-02-02 00:09:23 | INFO | train_inner | {"epoch": 7, "loss": "4.085", "moe_gate_loss": "12.8101", "overflow_expert1": "0.008", "overflow_expert2": "16.78", "entropy_gating": "0.397", "expert1_balance_top": "31.063", "expert1_balance_bottom": "17.626", "unused_expert1_count": "0.489", "expert2_balance_top": "32.051", "expert2_balance_bottom": "17.162", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.9", "ppl": "14.93", "wps": "15288", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5040", "lr": "9.92e-06", "gnorm": "1.229", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "93223"}
2023-02-02 00:12:15 | INFO | train_inner | {"epoch": 7, "loss": "4.057", "moe_gate_loss": "12.8068", "overflow_expert1": "0.006", "overflow_expert2": "16.805", "entropy_gating": "0.396", "expert1_balance_top": "31.054", "expert1_balance_bottom": "17.631", "unused_expert1_count": "0.486", "expert2_balance_top": "31.994", "expert2_balance_bottom": "17.158", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.873", "ppl": "14.65", "wps": "15295.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5050", "lr": "9.9e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "93395"}
2023-02-02 00:15:06 | INFO | train_inner | {"epoch": 7, "loss": "4.057", "moe_gate_loss": "12.8195", "overflow_expert1": "0.008", "overflow_expert2": "16.706", "entropy_gating": "0.396", "expert1_balance_top": "31.159", "expert1_balance_bottom": "17.56", "unused_expert1_count": "0.49", "expert2_balance_top": "32.011", "expert2_balance_bottom": "17.199", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15287.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5060", "lr": "9.88e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "93566"}
2023-02-02 00:17:58 | INFO | train_inner | {"epoch": 7, "loss": "4.097", "moe_gate_loss": "12.8356", "overflow_expert1": "0.007", "overflow_expert2": "17.214", "entropy_gating": "0.397", "expert1_balance_top": "31.266", "expert1_balance_bottom": "17.483", "unused_expert1_count": "0.484", "expert2_balance_top": "32.176", "expert2_balance_bottom": "17.038", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.912", "ppl": "15.05", "wps": "15289.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5070", "lr": "9.86e-06", "gnorm": "1.222", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "93738"}
2023-02-02 00:20:49 | INFO | train_inner | {"epoch": 7, "loss": "4.065", "moe_gate_loss": "12.8131", "overflow_expert1": "0.006", "overflow_expert2": "16.561", "entropy_gating": "0.396", "expert1_balance_top": "31.101", "expert1_balance_bottom": "17.632", "unused_expert1_count": "0.486", "expert2_balance_top": "31.987", "expert2_balance_bottom": "17.279", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.88", "ppl": "14.72", "wps": "15281.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5080", "lr": "9.84e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "93909"}
2023-02-02 00:23:41 | INFO | train_inner | {"epoch": 7, "loss": "4.05", "moe_gate_loss": "12.8017", "overflow_expert1": "0.002", "overflow_expert2": "16.772", "entropy_gating": "0.397", "expert1_balance_top": "31.029", "expert1_balance_bottom": "17.649", "unused_expert1_count": "0.483", "expert2_balance_top": "32.053", "expert2_balance_bottom": "17.187", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.866", "ppl": "14.58", "wps": "15293.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5090", "lr": "9.82e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "94081"}
2023-02-02 00:26:32 | INFO | train_inner | {"epoch": 7, "loss": "4", "moe_gate_loss": "12.8256", "overflow_expert1": "0.006", "overflow_expert2": "16.889", "entropy_gating": "0.396", "expert1_balance_top": "31.183", "expert1_balance_bottom": "17.541", "unused_expert1_count": "0.486", "expert2_balance_top": "32.082", "expert2_balance_bottom": "17.146", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.815", "ppl": "14.08", "wps": "15289.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5100", "lr": "9.8e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "94252"}
2023-02-02 00:29:24 | INFO | train_inner | {"epoch": 7, "loss": "4.083", "moe_gate_loss": "12.8232", "overflow_expert1": "0.01", "overflow_expert2": "16.795", "entropy_gating": "0.396", "expert1_balance_top": "31.146", "expert1_balance_bottom": "17.587", "unused_expert1_count": "0.487", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.174", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.91", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5110", "lr": "9.78e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "94424"}
2023-02-02 00:32:15 | INFO | train_inner | {"epoch": 7, "loss": "4.054", "moe_gate_loss": "12.8049", "overflow_expert1": "0.008", "overflow_expert2": "16.668", "entropy_gating": "0.397", "expert1_balance_top": "31.036", "expert1_balance_bottom": "17.681", "unused_expert1_count": "0.486", "expert2_balance_top": "31.972", "expert2_balance_bottom": "17.217", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.869", "ppl": "14.62", "wps": "15285.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5120", "lr": "9.76e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "94595"}
2023-02-02 00:35:07 | INFO | train_inner | {"epoch": 7, "loss": "4.053", "moe_gate_loss": "12.8005", "overflow_expert1": "0.004", "overflow_expert2": "16.559", "entropy_gating": "0.396", "expert1_balance_top": "31.011", "expert1_balance_bottom": "17.679", "unused_expert1_count": "0.486", "expert2_balance_top": "31.998", "expert2_balance_bottom": "17.233", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.868", "ppl": "14.6", "wps": "15294.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5130", "lr": "9.74e-06", "gnorm": "1.185", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "94766"}
2023-02-02 00:37:58 | INFO | train_inner | {"epoch": 7, "loss": "4.04", "moe_gate_loss": "12.8277", "overflow_expert1": "0.008", "overflow_expert2": "16.895", "entropy_gating": "0.396", "expert1_balance_top": "31.202", "expert1_balance_bottom": "17.554", "unused_expert1_count": "0.488", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.128", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.855", "ppl": "14.47", "wps": "15287", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5140", "lr": "9.72e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "94938"}
2023-02-02 00:40:49 | INFO | train_inner | {"epoch": 7, "loss": "4.048", "moe_gate_loss": "12.808", "overflow_expert1": "0.008", "overflow_expert2": "16.75", "entropy_gating": "0.397", "expert1_balance_top": "31.055", "expert1_balance_bottom": "17.652", "unused_expert1_count": "0.487", "expert2_balance_top": "32.013", "expert2_balance_bottom": "17.177", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.863", "ppl": "14.55", "wps": "15297.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5150", "lr": "9.7e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "95109"}
2023-02-02 00:43:41 | INFO | train_inner | {"epoch": 7, "loss": "4.072", "moe_gate_loss": "12.808", "overflow_expert1": "0.005", "overflow_expert2": "16.696", "entropy_gating": "0.396", "expert1_balance_top": "31.066", "expert1_balance_bottom": "17.647", "unused_expert1_count": "0.488", "expert2_balance_top": "32.024", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.887", "ppl": "14.8", "wps": "15297.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5160", "lr": "9.68e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "95281"}
2023-02-02 00:46:32 | INFO | train_inner | {"epoch": 7, "loss": "4.062", "moe_gate_loss": "12.8025", "overflow_expert1": "0.004", "overflow_expert2": "16.624", "entropy_gating": "0.396", "expert1_balance_top": "31.021", "expert1_balance_bottom": "17.656", "unused_expert1_count": "0.487", "expert2_balance_top": "31.99", "expert2_balance_bottom": "17.215", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.877", "ppl": "14.69", "wps": "15288.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5170", "lr": "9.66e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "95452"}
2023-02-02 00:49:24 | INFO | train_inner | {"epoch": 7, "loss": "4.003", "moe_gate_loss": "12.8164", "overflow_expert1": "0.007", "overflow_expert2": "16.777", "entropy_gating": "0.395", "expert1_balance_top": "31.126", "expert1_balance_bottom": "17.6", "unused_expert1_count": "0.489", "expert2_balance_top": "32.033", "expert2_balance_bottom": "17.182", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.818", "ppl": "14.1", "wps": "15295.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5180", "lr": "9.64e-06", "gnorm": "1.187", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "95623"}
2023-02-02 00:52:15 | INFO | train_inner | {"epoch": 7, "loss": "4.083", "moe_gate_loss": "12.8091", "overflow_expert1": "0.007", "overflow_expert2": "16.735", "entropy_gating": "0.397", "expert1_balance_top": "31.062", "expert1_balance_bottom": "17.654", "unused_expert1_count": "0.488", "expert2_balance_top": "31.998", "expert2_balance_bottom": "17.166", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.898", "ppl": "14.91", "wps": "15293.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5190", "lr": "9.62e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "95795"}
2023-02-02 00:55:06 | INFO | train_inner | {"epoch": 7, "loss": "4.084", "moe_gate_loss": "12.8146", "overflow_expert1": "0.005", "overflow_expert2": "16.771", "entropy_gating": "0.396", "expert1_balance_top": "31.103", "expert1_balance_bottom": "17.621", "unused_expert1_count": "0.488", "expert2_balance_top": "32.039", "expert2_balance_bottom": "17.165", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.92", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5200", "lr": "9.6e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "95966"}
2023-02-02 00:57:58 | INFO | train_inner | {"epoch": 7, "loss": "4.077", "moe_gate_loss": "12.8094", "overflow_expert1": "0.006", "overflow_expert2": "16.663", "entropy_gating": "0.395", "expert1_balance_top": "31.079", "expert1_balance_bottom": "17.62", "unused_expert1_count": "0.484", "expert2_balance_top": "32.01", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.892", "ppl": "14.85", "wps": "15284.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5210", "lr": "9.58e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "96138"}
2023-02-02 01:00:49 | INFO | train_inner | {"epoch": 7, "loss": "4.003", "moe_gate_loss": "12.8211", "overflow_expert1": "0.009", "overflow_expert2": "16.763", "entropy_gating": "0.395", "expert1_balance_top": "31.136", "expert1_balance_bottom": "17.588", "unused_expert1_count": "0.483", "expert2_balance_top": "32.026", "expert2_balance_bottom": "17.188", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.818", "ppl": "14.11", "wps": "15292.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5220", "lr": "9.56e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "96309"}
2023-02-02 01:03:41 | INFO | train_inner | {"epoch": 7, "loss": "4.07", "moe_gate_loss": "12.8068", "overflow_expert1": "0.007", "overflow_expert2": "16.703", "entropy_gating": "0.395", "expert1_balance_top": "31.038", "expert1_balance_bottom": "17.658", "unused_expert1_count": "0.486", "expert2_balance_top": "31.974", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.885", "ppl": "14.77", "wps": "15300.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5230", "lr": "9.54e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "96481"}
2023-02-02 01:06:32 | INFO | train_inner | {"epoch": 7, "loss": "4.046", "moe_gate_loss": "12.803", "overflow_expert1": "0.005", "overflow_expert2": "16.504", "entropy_gating": "0.396", "expert1_balance_top": "31.026", "expert1_balance_bottom": "17.667", "unused_expert1_count": "0.488", "expert2_balance_top": "31.935", "expert2_balance_bottom": "17.26", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.861", "ppl": "14.53", "wps": "15291.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5240", "lr": "9.52e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "96652"}
2023-02-02 01:09:24 | INFO | train_inner | {"epoch": 7, "loss": "4.111", "moe_gate_loss": "12.815", "overflow_expert1": "0.012", "overflow_expert2": "16.717", "entropy_gating": "0.396", "expert1_balance_top": "31.077", "expert1_balance_bottom": "17.635", "unused_expert1_count": "0.486", "expert2_balance_top": "32", "expert2_balance_bottom": "17.169", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.926", "ppl": "15.2", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5250", "lr": "9.5e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "96824"}
2023-02-02 01:11:13 | INFO | valid_c4_small/C4_small | {"epoch": 7, "valid_c4_small/C4_small_loss": "4.212", "valid_c4_small/C4_small_moe_gate_loss": "12.5116", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.262", "valid_c4_small/C4_small_entropy_gating": "0.425", "valid_c4_small/C4_small_expert1_balance_top": "31.047", "valid_c4_small/C4_small_expert1_balance_bottom": "18.864", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.559", "valid_c4_small/C4_small_expert2_balance_bottom": "18.074", "valid_c4_small/C4_small_unused_expert2_count": "0.375", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.031", "valid_c4_small/C4_small_ppl": "16.35", "valid_c4_small/C4_small_wps": "52021.4", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "5250", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 01:11:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 5250 updates
2023-02-02 01:11:21 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 7 @ 5250 updates, score 4.212) (writing took 7.552896851208061 seconds)
2023-02-02 01:14:13 | INFO | train_inner | {"epoch": 7, "loss": "4.032", "moe_gate_loss": "12.8031", "overflow_expert1": "0.007", "overflow_expert2": "16.739", "entropy_gating": "0.396", "expert1_balance_top": "31.008", "expert1_balance_bottom": "17.669", "unused_expert1_count": "0.489", "expert2_balance_top": "32.027", "expert2_balance_bottom": "17.154", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.847", "ppl": "14.39", "wps": "9049.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "5260", "lr": "9.48e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "97113"}
2023-02-02 01:17:05 | INFO | train_inner | {"epoch": 7, "loss": "4.049", "moe_gate_loss": "12.818", "overflow_expert1": "0.008", "overflow_expert2": "16.84", "entropy_gating": "0.395", "expert1_balance_top": "31.13", "expert1_balance_bottom": "17.607", "unused_expert1_count": "0.487", "expert2_balance_top": "32.075", "expert2_balance_bottom": "17.172", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.864", "ppl": "14.56", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5270", "lr": "9.46e-06", "gnorm": "1.199", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "97285"}
2023-02-02 01:19:56 | INFO | train_inner | {"epoch": 7, "loss": "4.048", "moe_gate_loss": "12.8009", "overflow_expert1": "0.004", "overflow_expert2": "16.575", "entropy_gating": "0.395", "expert1_balance_top": "31.014", "expert1_balance_bottom": "17.679", "unused_expert1_count": "0.489", "expert2_balance_top": "31.974", "expert2_balance_bottom": "17.227", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.863", "ppl": "14.55", "wps": "15287.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5280", "lr": "9.44e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "97456"}
2023-02-02 01:22:48 | INFO | train_inner | {"epoch": 7, "loss": "4.05", "moe_gate_loss": "12.8106", "overflow_expert1": "0.01", "overflow_expert2": "16.58", "entropy_gating": "0.394", "expert1_balance_top": "31.065", "expert1_balance_bottom": "17.655", "unused_expert1_count": "0.484", "expert2_balance_top": "31.964", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.865", "ppl": "14.57", "wps": "15285", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5290", "lr": "9.42e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "97628"}
2023-02-02 01:25:39 | INFO | train_inner | {"epoch": 7, "loss": "4.048", "moe_gate_loss": "12.8125", "overflow_expert1": "0.006", "overflow_expert2": "16.892", "entropy_gating": "0.395", "expert1_balance_top": "31.078", "expert1_balance_bottom": "17.624", "unused_expert1_count": "0.49", "expert2_balance_top": "32.103", "expert2_balance_bottom": "17.129", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.863", "ppl": "14.55", "wps": "15287.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5300", "lr": "9.4e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "97799"}
2023-02-02 01:28:31 | INFO | train_inner | {"epoch": 7, "loss": "4.053", "moe_gate_loss": "12.8303", "overflow_expert1": "0.01", "overflow_expert2": "16.804", "entropy_gating": "0.394", "expert1_balance_top": "31.207", "expert1_balance_bottom": "17.547", "unused_expert1_count": "0.488", "expert2_balance_top": "32.054", "expert2_balance_bottom": "17.185", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.868", "ppl": "14.6", "wps": "15292.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5310", "lr": "9.38e-06", "gnorm": "1.223", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "97971"}
2023-02-02 01:31:22 | INFO | train_inner | {"epoch": 7, "loss": "4.023", "moe_gate_loss": "12.8083", "overflow_expert1": "0.007", "overflow_expert2": "16.791", "entropy_gating": "0.396", "expert1_balance_top": "31.051", "expert1_balance_bottom": "17.646", "unused_expert1_count": "0.483", "expert2_balance_top": "32.056", "expert2_balance_bottom": "17.151", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.838", "ppl": "14.3", "wps": "15288.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5320", "lr": "9.36e-06", "gnorm": "1.187", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "98142"}
2023-02-02 01:34:14 | INFO | train_inner | {"epoch": 7, "loss": "4.085", "moe_gate_loss": "12.7984", "overflow_expert1": "0.006", "overflow_expert2": "16.484", "entropy_gating": "0.395", "expert1_balance_top": "30.974", "expert1_balance_bottom": "17.726", "unused_expert1_count": "0.485", "expert2_balance_top": "31.917", "expert2_balance_bottom": "17.247", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.901", "ppl": "14.94", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5330", "lr": "9.34e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "98314"}
2023-02-02 01:37:05 | INFO | train_inner | {"epoch": 7, "loss": "4.101", "moe_gate_loss": "12.8071", "overflow_expert1": "0.006", "overflow_expert2": "16.715", "entropy_gating": "0.395", "expert1_balance_top": "31.041", "expert1_balance_bottom": "17.644", "unused_expert1_count": "0.486", "expert2_balance_top": "32.03", "expert2_balance_bottom": "17.184", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.916", "ppl": "15.1", "wps": "15287.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5340", "lr": "9.32e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "98485"}
2023-02-02 01:39:57 | INFO | train_inner | {"epoch": 7, "loss": "4.093", "moe_gate_loss": "12.8125", "overflow_expert1": "0.005", "overflow_expert2": "16.913", "entropy_gating": "0.395", "expert1_balance_top": "31.093", "expert1_balance_bottom": "17.607", "unused_expert1_count": "0.486", "expert2_balance_top": "32.117", "expert2_balance_bottom": "17.11", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.908", "ppl": "15.01", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5350", "lr": "9.3e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "98657"}
2023-02-02 01:42:48 | INFO | train_inner | {"epoch": 7, "loss": "4.056", "moe_gate_loss": "12.8086", "overflow_expert1": "0.004", "overflow_expert2": "16.788", "entropy_gating": "0.394", "expert1_balance_top": "31.055", "expert1_balance_bottom": "17.632", "unused_expert1_count": "0.487", "expert2_balance_top": "32.103", "expert2_balance_bottom": "17.129", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.871", "ppl": "14.63", "wps": "15275.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5360", "lr": "9.28e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "98828"}
2023-02-02 01:45:40 | INFO | train_inner | {"epoch": 7, "loss": "4.042", "moe_gate_loss": "12.8176", "overflow_expert1": "0.007", "overflow_expert2": "16.871", "entropy_gating": "0.396", "expert1_balance_top": "31.093", "expert1_balance_bottom": "17.614", "unused_expert1_count": "0.487", "expert2_balance_top": "32.106", "expert2_balance_bottom": "17.151", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15281.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5370", "lr": "9.26e-06", "gnorm": "1.221", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "99000"}
2023-02-02 01:48:31 | INFO | train_inner | {"epoch": 7, "loss": "4.063", "moe_gate_loss": "12.8022", "overflow_expert1": "0.005", "overflow_expert2": "16.602", "entropy_gating": "0.396", "expert1_balance_top": "31.011", "expert1_balance_bottom": "17.696", "unused_expert1_count": "0.49", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.208", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.878", "ppl": "14.71", "wps": "15287.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5380", "lr": "9.24e-06", "gnorm": "1.184", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "99171"}
2023-02-02 01:51:23 | INFO | train_inner | {"epoch": 7, "loss": "4.055", "moe_gate_loss": "12.7998", "overflow_expert1": "0.005", "overflow_expert2": "16.593", "entropy_gating": "0.395", "expert1_balance_top": "30.988", "expert1_balance_bottom": "17.707", "unused_expert1_count": "0.488", "expert2_balance_top": "32.044", "expert2_balance_bottom": "17.227", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.871", "ppl": "14.63", "wps": "15291.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5390", "lr": "9.22e-06", "gnorm": "1.191", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "99343"}
2023-02-02 01:54:14 | INFO | train_inner | {"epoch": 7, "loss": "4.05", "moe_gate_loss": "12.8062", "overflow_expert1": "0.01", "overflow_expert2": "16.788", "entropy_gating": "0.395", "expert1_balance_top": "31.034", "expert1_balance_bottom": "17.681", "unused_expert1_count": "0.486", "expert2_balance_top": "32.153", "expert2_balance_bottom": "17.169", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.865", "ppl": "14.57", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5400", "lr": "9.2e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "99514"}
2023-02-02 01:57:23 | INFO | train_inner | {"epoch": 7, "loss": "4.036", "moe_gate_loss": "12.8223", "overflow_expert1": "0.008", "overflow_expert2": "16.886", "entropy_gating": "0.394", "expert1_balance_top": "31.144", "expert1_balance_bottom": "17.564", "unused_expert1_count": "0.485", "expert2_balance_top": "32.091", "expert2_balance_bottom": "17.114", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.851", "ppl": "14.43", "wps": "13912.5", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "5410", "lr": "9.18e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "4", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "99703"}
2023-02-02 02:00:14 | INFO | train_inner | {"epoch": 7, "loss": "4.031", "moe_gate_loss": "12.8023", "overflow_expert1": "0.004", "overflow_expert2": "16.627", "entropy_gating": "0.394", "expert1_balance_top": "31.031", "expert1_balance_bottom": "17.688", "unused_expert1_count": "0.484", "expert2_balance_top": "31.986", "expert2_balance_bottom": "17.237", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15281.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5420", "lr": "9.16e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "99874"}
2023-02-02 02:03:06 | INFO | train_inner | {"epoch": 7, "loss": "4.068", "moe_gate_loss": "12.8049", "overflow_expert1": "0.005", "overflow_expert2": "16.629", "entropy_gating": "0.394", "expert1_balance_top": "31.036", "expert1_balance_bottom": "17.701", "unused_expert1_count": "0.485", "expert2_balance_top": "32.02", "expert2_balance_bottom": "17.234", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.883", "ppl": "14.75", "wps": "15289.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5430", "lr": "9.14e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "100046"}
2023-02-02 02:05:57 | INFO | train_inner | {"epoch": 7, "loss": "4.008", "moe_gate_loss": "12.8093", "overflow_expert1": "0.007", "overflow_expert2": "16.85", "entropy_gating": "0.395", "expert1_balance_top": "31.086", "expert1_balance_bottom": "17.646", "unused_expert1_count": "0.485", "expert2_balance_top": "32.133", "expert2_balance_bottom": "17.133", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.15", "wps": "15289.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5440", "lr": "9.12e-06", "gnorm": "1.181", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "100217"}
2023-02-02 02:08:48 | INFO | train_inner | {"epoch": 7, "loss": "4.023", "moe_gate_loss": "12.8232", "overflow_expert1": "0.009", "overflow_expert2": "16.846", "entropy_gating": "0.395", "expert1_balance_top": "31.145", "expert1_balance_bottom": "17.581", "unused_expert1_count": "0.484", "expert2_balance_top": "32.128", "expert2_balance_bottom": "17.168", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.838", "ppl": "14.3", "wps": "15294.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5450", "lr": "9.1e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "100388"}
2023-02-02 02:11:40 | INFO | train_inner | {"epoch": 7, "loss": "4.018", "moe_gate_loss": "12.802", "overflow_expert1": "0.004", "overflow_expert2": "16.676", "entropy_gating": "0.394", "expert1_balance_top": "31.026", "expert1_balance_bottom": "17.667", "unused_expert1_count": "0.487", "expert2_balance_top": "32.059", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.834", "ppl": "14.26", "wps": "15284.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5460", "lr": "9.08e-06", "gnorm": "1.184", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "100560"}
2023-02-02 02:14:31 | INFO | train_inner | {"epoch": 7, "loss": "4.029", "moe_gate_loss": "12.8016", "overflow_expert1": "0.005", "overflow_expert2": "16.601", "entropy_gating": "0.394", "expert1_balance_top": "31.023", "expert1_balance_bottom": "17.7", "unused_expert1_count": "0.489", "expert2_balance_top": "31.946", "expert2_balance_bottom": "17.199", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15288.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5470", "lr": "9.06e-06", "gnorm": "1.182", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "100731"}
2023-02-02 02:17:23 | INFO | train_inner | {"epoch": 7, "loss": "4.005", "moe_gate_loss": "12.8006", "overflow_expert1": "0.008", "overflow_expert2": "16.652", "entropy_gating": "0.395", "expert1_balance_top": "30.982", "expert1_balance_bottom": "17.697", "unused_expert1_count": "0.488", "expert2_balance_top": "32.023", "expert2_balance_bottom": "17.159", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.12", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5480", "lr": "9.04e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "100903"}
2023-02-02 02:20:14 | INFO | train_inner | {"epoch": 7, "loss": "4.052", "moe_gate_loss": "12.8216", "overflow_expert1": "0.008", "overflow_expert2": "16.797", "entropy_gating": "0.395", "expert1_balance_top": "31.135", "expert1_balance_bottom": "17.589", "unused_expert1_count": "0.484", "expert2_balance_top": "32.066", "expert2_balance_bottom": "17.156", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.867", "ppl": "14.6", "wps": "15292.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5490", "lr": "9.02e-06", "gnorm": "1.185", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "101074"}
2023-02-02 02:23:06 | INFO | train_inner | {"epoch": 7, "loss": "4.043", "moe_gate_loss": "12.7922", "overflow_expert1": "0.005", "overflow_expert2": "16.531", "entropy_gating": "0.395", "expert1_balance_top": "30.957", "expert1_balance_bottom": "17.74", "unused_expert1_count": "0.484", "expert2_balance_top": "31.993", "expert2_balance_bottom": "17.233", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.859", "ppl": "14.51", "wps": "15281.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5500", "lr": "9e-06", "gnorm": "1.185", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "101246"}
2023-02-02 02:24:55 | INFO | valid_c4_small/C4_small | {"epoch": 7, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.4966", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.954", "valid_c4_small/C4_small_entropy_gating": "0.425", "valid_c4_small/C4_small_expert1_balance_top": "30.882", "valid_c4_small/C4_small_expert1_balance_bottom": "18.856", "valid_c4_small/C4_small_unused_expert1_count": "0.456", "valid_c4_small/C4_small_expert2_balance_top": "31.491", "valid_c4_small/C4_small_expert2_balance_bottom": "18.201", "valid_c4_small/C4_small_unused_expert2_count": "0.379", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.34", "valid_c4_small/C4_small_wps": "52001.1", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "5500", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 02:24:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 5500 updates
2023-02-02 02:25:03 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 7 @ 5500 updates, score 4.21) (writing took 7.60245431214571 seconds)
2023-02-02 02:27:55 | INFO | train_inner | {"epoch": 7, "loss": "4.076", "moe_gate_loss": "12.7899", "overflow_expert1": "0.005", "overflow_expert2": "16.572", "entropy_gating": "0.395", "expert1_balance_top": "30.929", "expert1_balance_bottom": "17.771", "unused_expert1_count": "0.485", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.174", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.891", "ppl": "14.84", "wps": "9053.4", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "5510", "lr": "8.98e-06", "gnorm": "1.187", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "101535"}
2023-02-02 02:30:47 | INFO | train_inner | {"epoch": 7, "loss": "4.078", "moe_gate_loss": "12.8081", "overflow_expert1": "0.01", "overflow_expert2": "16.652", "entropy_gating": "0.394", "expert1_balance_top": "31.039", "expert1_balance_bottom": "17.674", "unused_expert1_count": "0.49", "expert2_balance_top": "32.046", "expert2_balance_bottom": "17.187", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.893", "ppl": "14.86", "wps": "15275.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5520", "lr": "8.96e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "101707"}
2023-02-02 02:33:39 | INFO | train_inner | {"epoch": 7, "loss": "4.063", "moe_gate_loss": "12.7878", "overflow_expert1": "0.004", "overflow_expert2": "16.393", "entropy_gating": "0.396", "expert1_balance_top": "30.913", "expert1_balance_bottom": "17.753", "unused_expert1_count": "0.486", "expert2_balance_top": "31.926", "expert2_balance_bottom": "17.277", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.878", "ppl": "14.71", "wps": "15274.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5530", "lr": "8.94e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "101879"}
2023-02-02 02:36:30 | INFO | train_inner | {"epoch": 7, "loss": "4.119", "moe_gate_loss": "12.8017", "overflow_expert1": "0.005", "overflow_expert2": "16.678", "entropy_gating": "0.396", "expert1_balance_top": "31.005", "expert1_balance_bottom": "17.703", "unused_expert1_count": "0.486", "expert2_balance_top": "32.03", "expert2_balance_bottom": "17.162", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.934", "ppl": "15.28", "wps": "15287.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5540", "lr": "8.92e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "102050"}
2023-02-02 02:39:22 | INFO | train_inner | {"epoch": 7, "loss": "4.078", "moe_gate_loss": "12.7871", "overflow_expert1": "0.003", "overflow_expert2": "16.504", "entropy_gating": "0.394", "expert1_balance_top": "30.921", "expert1_balance_bottom": "17.766", "unused_expert1_count": "0.484", "expert2_balance_top": "32.006", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.893", "ppl": "14.86", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5550", "lr": "8.9e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "102221"}
2023-02-02 02:42:13 | INFO | train_inner | {"epoch": 7, "loss": "4.092", "moe_gate_loss": "12.7926", "overflow_expert1": "0.003", "overflow_expert2": "16.508", "entropy_gating": "0.395", "expert1_balance_top": "30.96", "expert1_balance_bottom": "17.745", "unused_expert1_count": "0.488", "expert2_balance_top": "31.99", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.908", "ppl": "15.01", "wps": "15291.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5560", "lr": "8.88e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "102393"}
2023-02-02 02:45:04 | INFO | train_inner | {"epoch": 7, "loss": "4.073", "moe_gate_loss": "12.7891", "overflow_expert1": "0.008", "overflow_expert2": "16.428", "entropy_gating": "0.396", "expert1_balance_top": "30.904", "expert1_balance_bottom": "17.759", "unused_expert1_count": "0.49", "expert2_balance_top": "31.966", "expert2_balance_bottom": "17.238", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.888", "ppl": "14.81", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5570", "lr": "8.86e-06", "gnorm": "1.183", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "102564"}
2023-02-02 02:47:56 | INFO | train_inner | {"epoch": 7, "loss": "4.06", "moe_gate_loss": "12.8039", "overflow_expert1": "0.007", "overflow_expert2": "16.671", "entropy_gating": "0.395", "expert1_balance_top": "31.013", "expert1_balance_bottom": "17.684", "unused_expert1_count": "0.485", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.167", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.875", "ppl": "14.68", "wps": "15277.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5580", "lr": "8.84e-06", "gnorm": "1.183", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "102736"}
2023-02-02 02:50:48 | INFO | train_inner | {"epoch": 7, "loss": "4.071", "moe_gate_loss": "12.7968", "overflow_expert1": "0.006", "overflow_expert2": "16.49", "entropy_gating": "0.394", "expert1_balance_top": "30.966", "expert1_balance_bottom": "17.733", "unused_expert1_count": "0.48", "expert2_balance_top": "32.005", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.886", "ppl": "14.79", "wps": "15288.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5590", "lr": "8.82e-06", "gnorm": "1.188", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "102907"}
2023-02-02 02:53:39 | INFO | train_inner | {"epoch": 7, "loss": "4.046", "moe_gate_loss": "12.8021", "overflow_expert1": "0.007", "overflow_expert2": "16.74", "entropy_gating": "0.395", "expert1_balance_top": "31.005", "expert1_balance_bottom": "17.691", "unused_expert1_count": "0.486", "expert2_balance_top": "32.105", "expert2_balance_bottom": "17.15", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.861", "ppl": "14.53", "wps": "15277.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5600", "lr": "8.8e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "103079"}
2023-02-02 02:56:31 | INFO | train_inner | {"epoch": 7, "loss": "4.058", "moe_gate_loss": "12.7898", "overflow_expert1": "0.003", "overflow_expert2": "16.433", "entropy_gating": "0.396", "expert1_balance_top": "30.937", "expert1_balance_bottom": "17.771", "unused_expert1_count": "0.492", "expert2_balance_top": "32.032", "expert2_balance_bottom": "17.257", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.874", "ppl": "14.66", "wps": "15279.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5610", "lr": "8.78e-06", "gnorm": "1.182", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "103251"}
2023-02-02 02:59:22 | INFO | train_inner | {"epoch": 7, "loss": "4.085", "moe_gate_loss": "12.7856", "overflow_expert1": "0.006", "overflow_expert2": "16.406", "entropy_gating": "0.395", "expert1_balance_top": "30.897", "expert1_balance_bottom": "17.793", "unused_expert1_count": "0.487", "expert2_balance_top": "31.968", "expert2_balance_bottom": "17.257", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.901", "ppl": "14.94", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5620", "lr": "8.76e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "103422"}
2023-02-02 03:02:14 | INFO | train_inner | {"epoch": 7, "loss": "4.074", "moe_gate_loss": "12.7999", "overflow_expert1": "0.006", "overflow_expert2": "16.592", "entropy_gating": "0.395", "expert1_balance_top": "30.982", "expert1_balance_bottom": "17.711", "unused_expert1_count": "0.484", "expert2_balance_top": "32", "expert2_balance_bottom": "17.211", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.889", "ppl": "14.81", "wps": "15273.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5630", "lr": "8.74e-06", "gnorm": "1.189", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "103594"}
2023-02-02 03:05:06 | INFO | train_inner | {"epoch": 7, "loss": "4.077", "moe_gate_loss": "12.8117", "overflow_expert1": "0.007", "overflow_expert2": "16.687", "entropy_gating": "0.395", "expert1_balance_top": "31.063", "expert1_balance_bottom": "17.646", "unused_expert1_count": "0.489", "expert2_balance_top": "32.082", "expert2_balance_bottom": "17.177", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.893", "ppl": "14.85", "wps": "15269.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5640", "lr": "8.72e-06", "gnorm": "1.171", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "103765"}
2023-02-02 03:07:57 | INFO | train_inner | {"epoch": 7, "loss": "4.058", "moe_gate_loss": "12.7916", "overflow_expert1": "0.005", "overflow_expert2": "16.566", "entropy_gating": "0.395", "expert1_balance_top": "30.944", "expert1_balance_bottom": "17.752", "unused_expert1_count": "0.483", "expert2_balance_top": "31.971", "expert2_balance_bottom": "17.17", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.874", "ppl": "14.66", "wps": "15289.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5650", "lr": "8.7e-06", "gnorm": "1.177", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "103937"}
2023-02-02 03:10:48 | INFO | train_inner | {"epoch": 7, "loss": "4.057", "moe_gate_loss": "12.8073", "overflow_expert1": "0.005", "overflow_expert2": "16.767", "entropy_gating": "0.396", "expert1_balance_top": "31.051", "expert1_balance_bottom": "17.669", "unused_expert1_count": "0.484", "expert2_balance_top": "32.057", "expert2_balance_bottom": "17.158", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5660", "lr": "8.68e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "104108"}
2023-02-02 03:13:40 | INFO | train_inner | {"epoch": 7, "loss": "4.048", "moe_gate_loss": "12.8147", "overflow_expert1": "0.005", "overflow_expert2": "16.724", "entropy_gating": "0.394", "expert1_balance_top": "31.099", "expert1_balance_bottom": "17.616", "unused_expert1_count": "0.485", "expert2_balance_top": "32.083", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.863", "ppl": "14.55", "wps": "15293.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5670", "lr": "8.66e-06", "gnorm": "1.189", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "104280"}
2023-02-02 03:16:31 | INFO | train_inner | {"epoch": 7, "loss": "4.063", "moe_gate_loss": "12.7924", "overflow_expert1": "0.006", "overflow_expert2": "16.531", "entropy_gating": "0.395", "expert1_balance_top": "30.939", "expert1_balance_bottom": "17.762", "unused_expert1_count": "0.489", "expert2_balance_top": "31.97", "expert2_balance_bottom": "17.215", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.878", "ppl": "14.7", "wps": "15280.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5680", "lr": "8.64e-06", "gnorm": "1.183", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "104451"}
2023-02-02 03:19:23 | INFO | train_inner | {"epoch": 7, "loss": "4.074", "moe_gate_loss": "12.7927", "overflow_expert1": "0.007", "overflow_expert2": "16.454", "entropy_gating": "0.396", "expert1_balance_top": "30.93", "expert1_balance_bottom": "17.77", "unused_expert1_count": "0.486", "expert2_balance_top": "31.948", "expert2_balance_bottom": "17.233", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.889", "ppl": "14.82", "wps": "15281.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5690", "lr": "8.62e-06", "gnorm": "1.177", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "104623"}
2023-02-02 03:22:15 | INFO | train_inner | {"epoch": 7, "loss": "4.096", "moe_gate_loss": "12.7842", "overflow_expert1": "0.004", "overflow_expert2": "16.339", "entropy_gating": "0.396", "expert1_balance_top": "30.889", "expert1_balance_bottom": "17.79", "unused_expert1_count": "0.488", "expert2_balance_top": "31.932", "expert2_balance_bottom": "17.277", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.912", "ppl": "15.05", "wps": "15281.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5700", "lr": "8.6e-06", "gnorm": "1.184", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "104794"}
2023-02-02 03:25:06 | INFO | train_inner | {"epoch": 7, "loss": "4.074", "moe_gate_loss": "12.7885", "overflow_expert1": "0.008", "overflow_expert2": "16.43", "entropy_gating": "0.396", "expert1_balance_top": "30.883", "expert1_balance_bottom": "17.774", "unused_expert1_count": "0.49", "expert2_balance_top": "32.006", "expert2_balance_bottom": "17.243", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.89", "ppl": "14.82", "wps": "15281.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5710", "lr": "8.58e-06", "gnorm": "1.17", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "104966"}
2023-02-02 03:27:04 | INFO | valid_c4_small/C4_small | {"epoch": 7, "valid_c4_small/C4_small_loss": "4.208", "valid_c4_small/C4_small_moe_gate_loss": "12.4948", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.817", "valid_c4_small/C4_small_entropy_gating": "0.426", "valid_c4_small/C4_small_expert1_balance_top": "30.813", "valid_c4_small/C4_small_expert1_balance_bottom": "19.007", "valid_c4_small/C4_small_unused_expert1_count": "0.46", "valid_c4_small/C4_small_expert2_balance_top": "31.473", "valid_c4_small/C4_small_expert2_balance_bottom": "18.196", "valid_c4_small/C4_small_unused_expert2_count": "0.384", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.028", "valid_c4_small/C4_small_ppl": "16.31", "valid_c4_small/C4_small_wps": "52067", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "5710", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 03:27:04 | INFO | fairseq_cli.train | end of epoch 7 (average epoch stats below)
2023-02-02 03:27:04 | INFO | train | {"epoch": 7, "train_loss": "4.056", "train_moe_gate_loss": "12.8065", "train_overflow_expert1": "0.006", "train_overflow_expert2": "16.71", "train_entropy_gating": "0.396", "train_expert1_balance_top": "31.045", "train_expert1_balance_bottom": "17.655", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "32.04", "train_expert2_balance_bottom": "17.175", "train_unused_expert2_count": "0.449", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.871", "train_ppl": "14.63", "train_wps": "14770.6", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "5710", "train_lr": "8.58e-06", "train_gnorm": "1.196", "train_clip": "100", "train_loss_scale": "4", "train_train_wall": "13576", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "105084"}
2023-02-02 03:27:04 | INFO | fairseq.trainer | begin training epoch 8
2023-02-02 03:29:55 | INFO | train_inner | {"epoch": 8, "loss": "4.096", "moe_gate_loss": "12.789", "overflow_expert1": "0.007", "overflow_expert2": "16.566", "entropy_gating": "0.396", "expert1_balance_top": "30.913", "expert1_balance_bottom": "17.76", "unused_expert1_count": "0.488", "expert2_balance_top": "32.06", "expert2_balance_bottom": "17.183", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.911", "ppl": "15.04", "wps": "9070.1", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "5720", "lr": "8.56e-06", "gnorm": "1.182", "clip": "100", "loss_scale": "4", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "105255"}
2023-02-02 03:32:47 | INFO | train_inner | {"epoch": 8, "loss": "4.04", "moe_gate_loss": "12.7952", "overflow_expert1": "0.007", "overflow_expert2": "16.848", "entropy_gating": "0.397", "expert1_balance_top": "30.939", "expert1_balance_bottom": "17.716", "unused_expert1_count": "0.489", "expert2_balance_top": "32.174", "expert2_balance_bottom": "17.082", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.855", "ppl": "14.47", "wps": "15281.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5730", "lr": "8.54e-06", "gnorm": "1.187", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "105427"}
2023-02-02 03:35:38 | INFO | train_inner | {"epoch": 8, "loss": "4.031", "moe_gate_loss": "12.8055", "overflow_expert1": "0.006", "overflow_expert2": "17.116", "entropy_gating": "0.396", "expert1_balance_top": "31.042", "expert1_balance_bottom": "17.585", "unused_expert1_count": "0.487", "expert2_balance_top": "32.286", "expert2_balance_bottom": "16.96", "unused_expert2_count": "0.459", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15276.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5740", "lr": "8.52e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "105598"}
2023-02-02 03:38:30 | INFO | train_inner | {"epoch": 8, "loss": "4.008", "moe_gate_loss": "12.8091", "overflow_expert1": "0.005", "overflow_expert2": "17.028", "entropy_gating": "0.395", "expert1_balance_top": "31.072", "expert1_balance_bottom": "17.574", "unused_expert1_count": "0.487", "expert2_balance_top": "32.139", "expert2_balance_bottom": "17.038", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.15", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5750", "lr": "8.5e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "105770"}
2023-02-02 03:40:19 | INFO | valid_c4_small/C4_small | {"epoch": 8, "valid_c4_small/C4_small_loss": "4.213", "valid_c4_small/C4_small_moe_gate_loss": "12.5049", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "12.345", "valid_c4_small/C4_small_entropy_gating": "0.425", "valid_c4_small/C4_small_expert1_balance_top": "30.985", "valid_c4_small/C4_small_expert1_balance_bottom": "18.825", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.61", "valid_c4_small/C4_small_expert2_balance_bottom": "17.983", "valid_c4_small/C4_small_unused_expert2_count": "0.38", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.033", "valid_c4_small/C4_small_ppl": "16.37", "valid_c4_small/C4_small_wps": "52010.4", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "5750", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 03:40:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 5750 updates
2023-02-02 03:40:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 8 @ 5750 updates, score 4.213) (writing took 14.263503211084753 seconds)
2023-02-02 03:43:25 | INFO | train_inner | {"epoch": 8, "loss": "4.006", "moe_gate_loss": "12.8081", "overflow_expert1": "0.005", "overflow_expert2": "17.075", "entropy_gating": "0.396", "expert1_balance_top": "31.066", "expert1_balance_bottom": "17.565", "unused_expert1_count": "0.485", "expert2_balance_top": "32.156", "expert2_balance_bottom": "16.988", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.822", "ppl": "14.14", "wps": "8889.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "5760", "lr": "8.48e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "106065"}
2023-02-02 03:46:16 | INFO | train_inner | {"epoch": 8, "loss": "3.981", "moe_gate_loss": "12.7997", "overflow_expert1": "0.004", "overflow_expert2": "16.824", "entropy_gating": "0.396", "expert1_balance_top": "31.009", "expert1_balance_bottom": "17.633", "unused_expert1_count": "0.488", "expert2_balance_top": "32.068", "expert2_balance_bottom": "17.072", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.796", "ppl": "13.89", "wps": "15272", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5770", "lr": "8.46e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "106236"}
2023-02-02 03:49:08 | INFO | train_inner | {"epoch": 8, "loss": "4.008", "moe_gate_loss": "12.8009", "overflow_expert1": "0.004", "overflow_expert2": "16.59", "entropy_gating": "0.395", "expert1_balance_top": "31.003", "expert1_balance_bottom": "17.638", "unused_expert1_count": "0.488", "expert2_balance_top": "32.017", "expert2_balance_bottom": "17.199", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15274.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5780", "lr": "8.44e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "106408"}
2023-02-02 03:51:59 | INFO | train_inner | {"epoch": 8, "loss": "4.053", "moe_gate_loss": "12.8075", "overflow_expert1": "0.005", "overflow_expert2": "16.756", "entropy_gating": "0.394", "expert1_balance_top": "31.053", "expert1_balance_bottom": "17.625", "unused_expert1_count": "0.486", "expert2_balance_top": "32.093", "expert2_balance_bottom": "17.137", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.868", "ppl": "14.6", "wps": "15276.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5790", "lr": "8.42e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "106579"}
2023-02-02 03:54:51 | INFO | train_inner | {"epoch": 8, "loss": "4.033", "moe_gate_loss": "12.7936", "overflow_expert1": "0.004", "overflow_expert2": "16.65", "entropy_gating": "0.394", "expert1_balance_top": "30.948", "expert1_balance_bottom": "17.679", "unused_expert1_count": "0.487", "expert2_balance_top": "32.042", "expert2_balance_bottom": "17.125", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.848", "ppl": "14.4", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5800", "lr": "8.4e-06", "gnorm": "1.222", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "106751"}
2023-02-02 03:57:43 | INFO | train_inner | {"epoch": 8, "loss": "4.033", "moe_gate_loss": "12.8028", "overflow_expert1": "0.004", "overflow_expert2": "16.795", "entropy_gating": "0.395", "expert1_balance_top": "30.998", "expert1_balance_bottom": "17.64", "unused_expert1_count": "0.489", "expert2_balance_top": "32.086", "expert2_balance_bottom": "17.098", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.849", "ppl": "14.41", "wps": "15280.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5810", "lr": "8.38e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "106922"}
2023-02-02 04:00:34 | INFO | train_inner | {"epoch": 8, "loss": "3.991", "moe_gate_loss": "12.8064", "overflow_expert1": "0.005", "overflow_expert2": "16.785", "entropy_gating": "0.395", "expert1_balance_top": "31.022", "expert1_balance_bottom": "17.63", "unused_expert1_count": "0.487", "expert2_balance_top": "32.074", "expert2_balance_bottom": "17.101", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.806", "ppl": "13.99", "wps": "15284.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5820", "lr": "8.36e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "107094"}
2023-02-02 04:03:26 | INFO | train_inner | {"epoch": 8, "loss": "4.029", "moe_gate_loss": "12.7959", "overflow_expert1": "0.004", "overflow_expert2": "16.638", "entropy_gating": "0.394", "expert1_balance_top": "30.964", "expert1_balance_bottom": "17.705", "unused_expert1_count": "0.489", "expert2_balance_top": "31.973", "expert2_balance_bottom": "17.159", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.845", "ppl": "14.37", "wps": "15278.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5830", "lr": "8.34e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "107266"}
2023-02-02 04:06:17 | INFO | train_inner | {"epoch": 8, "loss": "4.026", "moe_gate_loss": "12.8041", "overflow_expert1": "0.005", "overflow_expert2": "16.733", "entropy_gating": "0.395", "expert1_balance_top": "31.042", "expert1_balance_bottom": "17.654", "unused_expert1_count": "0.488", "expert2_balance_top": "32.055", "expert2_balance_bottom": "17.154", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.841", "ppl": "14.33", "wps": "15279.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5840", "lr": "8.32e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "107437"}
2023-02-02 04:09:09 | INFO | train_inner | {"epoch": 8, "loss": "4.038", "moe_gate_loss": "12.8151", "overflow_expert1": "0.007", "overflow_expert2": "16.726", "entropy_gating": "0.395", "expert1_balance_top": "31.119", "expert1_balance_bottom": "17.594", "unused_expert1_count": "0.49", "expert2_balance_top": "32.014", "expert2_balance_bottom": "17.155", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15278.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5850", "lr": "8.3e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "107609"}
2023-02-02 04:12:00 | INFO | train_inner | {"epoch": 8, "loss": "4.039", "moe_gate_loss": "12.7958", "overflow_expert1": "0.006", "overflow_expert2": "16.584", "entropy_gating": "0.394", "expert1_balance_top": "30.965", "expert1_balance_bottom": "17.705", "unused_expert1_count": "0.486", "expert2_balance_top": "32.003", "expert2_balance_bottom": "17.199", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.854", "ppl": "14.46", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5860", "lr": "8.28e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "107780"}
2023-02-02 04:14:52 | INFO | train_inner | {"epoch": 8, "loss": "4.026", "moe_gate_loss": "12.8121", "overflow_expert1": "0.007", "overflow_expert2": "16.77", "entropy_gating": "0.394", "expert1_balance_top": "31.077", "expert1_balance_bottom": "17.628", "unused_expert1_count": "0.488", "expert2_balance_top": "32.008", "expert2_balance_bottom": "17.172", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.841", "ppl": "14.33", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5870", "lr": "8.26e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "107952"}
2023-02-02 04:17:43 | INFO | train_inner | {"epoch": 8, "loss": "4.092", "moe_gate_loss": "12.8168", "overflow_expert1": "0.006", "overflow_expert2": "16.798", "entropy_gating": "0.395", "expert1_balance_top": "31.115", "expert1_balance_bottom": "17.601", "unused_expert1_count": "0.489", "expert2_balance_top": "32.076", "expert2_balance_bottom": "17.143", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.907", "ppl": "15.01", "wps": "15277.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5880", "lr": "8.24e-06", "gnorm": "1.237", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "108123"}
2023-02-02 04:20:35 | INFO | train_inner | {"epoch": 8, "loss": "4.021", "moe_gate_loss": "12.8131", "overflow_expert1": "0.006", "overflow_expert2": "16.873", "entropy_gating": "0.394", "expert1_balance_top": "31.092", "expert1_balance_bottom": "17.619", "unused_expert1_count": "0.489", "expert2_balance_top": "32.084", "expert2_balance_bottom": "17.123", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15279.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5890", "lr": "8.22e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "108295"}
2023-02-02 04:23:27 | INFO | train_inner | {"epoch": 8, "loss": "4.044", "moe_gate_loss": "12.8008", "overflow_expert1": "0.004", "overflow_expert2": "16.594", "entropy_gating": "0.395", "expert1_balance_top": "30.991", "expert1_balance_bottom": "17.688", "unused_expert1_count": "0.488", "expert2_balance_top": "32.012", "expert2_balance_bottom": "17.219", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.859", "ppl": "14.51", "wps": "15281.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5900", "lr": "8.2e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "108466"}
2023-02-02 04:26:18 | INFO | train_inner | {"epoch": 8, "loss": "4.035", "moe_gate_loss": "12.8066", "overflow_expert1": "0.003", "overflow_expert2": "16.736", "entropy_gating": "0.395", "expert1_balance_top": "31.05", "expert1_balance_bottom": "17.65", "unused_expert1_count": "0.485", "expert2_balance_top": "32.059", "expert2_balance_bottom": "17.184", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.85", "ppl": "14.42", "wps": "15284.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5910", "lr": "8.18e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "108638"}
2023-02-02 04:29:10 | INFO | train_inner | {"epoch": 8, "loss": "4.01", "moe_gate_loss": "12.8216", "overflow_expert1": "0.007", "overflow_expert2": "16.833", "entropy_gating": "0.394", "expert1_balance_top": "31.144", "expert1_balance_bottom": "17.59", "unused_expert1_count": "0.487", "expert2_balance_top": "32.079", "expert2_balance_bottom": "17.138", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.825", "ppl": "14.17", "wps": "15285.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5920", "lr": "8.16e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "108809"}
2023-02-02 04:32:01 | INFO | train_inner | {"epoch": 8, "loss": "4.056", "moe_gate_loss": "12.7942", "overflow_expert1": "0.006", "overflow_expert2": "16.521", "entropy_gating": "0.394", "expert1_balance_top": "30.933", "expert1_balance_bottom": "17.729", "unused_expert1_count": "0.487", "expert2_balance_top": "31.947", "expert2_balance_bottom": "17.224", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15282.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5930", "lr": "8.14e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "108981"}
2023-02-02 04:34:53 | INFO | train_inner | {"epoch": 8, "loss": "4.013", "moe_gate_loss": "12.8049", "overflow_expert1": "0.006", "overflow_expert2": "16.71", "entropy_gating": "0.396", "expert1_balance_top": "31.028", "expert1_balance_bottom": "17.695", "unused_expert1_count": "0.489", "expert2_balance_top": "32.067", "expert2_balance_bottom": "17.206", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.829", "ppl": "14.21", "wps": "15283.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5940", "lr": "8.12e-06", "gnorm": "1.219", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "109153"}
2023-02-02 04:37:44 | INFO | train_inner | {"epoch": 8, "loss": "4.029", "moe_gate_loss": "12.8027", "overflow_expert1": "0.005", "overflow_expert2": "16.509", "entropy_gating": "0.395", "expert1_balance_top": "30.997", "expert1_balance_bottom": "17.667", "unused_expert1_count": "0.489", "expert2_balance_top": "32.002", "expert2_balance_bottom": "17.235", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15278", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5950", "lr": "8.1e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "109324"}
2023-02-02 04:40:36 | INFO | train_inner | {"epoch": 8, "loss": "4.049", "moe_gate_loss": "12.8019", "overflow_expert1": "0.004", "overflow_expert2": "16.623", "entropy_gating": "0.394", "expert1_balance_top": "30.992", "expert1_balance_bottom": "17.688", "unused_expert1_count": "0.488", "expert2_balance_top": "32.005", "expert2_balance_bottom": "17.201", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.864", "ppl": "14.56", "wps": "15286.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5960", "lr": "8.08e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "109496"}
2023-02-02 04:43:27 | INFO | train_inner | {"epoch": 8, "loss": "4.018", "moe_gate_loss": "12.7967", "overflow_expert1": "0.007", "overflow_expert2": "16.512", "entropy_gating": "0.394", "expert1_balance_top": "30.96", "expert1_balance_bottom": "17.721", "unused_expert1_count": "0.486", "expert2_balance_top": "31.936", "expert2_balance_bottom": "17.232", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.833", "ppl": "14.25", "wps": "15282.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5970", "lr": "8.06e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "109667"}
2023-02-02 04:46:19 | INFO | train_inner | {"epoch": 8, "loss": "4.064", "moe_gate_loss": "12.802", "overflow_expert1": "0.004", "overflow_expert2": "16.61", "entropy_gating": "0.394", "expert1_balance_top": "31.007", "expert1_balance_bottom": "17.687", "unused_expert1_count": "0.488", "expert2_balance_top": "31.972", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.72", "wps": "15283", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5980", "lr": "8.04e-06", "gnorm": "1.191", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "109839"}
2023-02-02 04:49:10 | INFO | train_inner | {"epoch": 8, "loss": "4.017", "moe_gate_loss": "12.8001", "overflow_expert1": "0.004", "overflow_expert2": "16.701", "entropy_gating": "0.394", "expert1_balance_top": "31", "expert1_balance_bottom": "17.677", "unused_expert1_count": "0.483", "expert2_balance_top": "32.024", "expert2_balance_bottom": "17.172", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.832", "ppl": "14.25", "wps": "15282.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "5990", "lr": "8.02e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "110010"}
2023-02-02 04:52:02 | INFO | train_inner | {"epoch": 8, "loss": "4.021", "moe_gate_loss": "12.8135", "overflow_expert1": "0.006", "overflow_expert2": "16.751", "entropy_gating": "0.395", "expert1_balance_top": "31.096", "expert1_balance_bottom": "17.626", "unused_expert1_count": "0.488", "expert2_balance_top": "32.053", "expert2_balance_bottom": "17.168", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15281.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6000", "lr": "8e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "110182"}
2023-02-02 04:53:51 | INFO | valid_c4_small/C4_small | {"epoch": 8, "valid_c4_small/C4_small_loss": "4.212", "valid_c4_small/C4_small_moe_gate_loss": "12.5039", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.951", "valid_c4_small/C4_small_entropy_gating": "0.424", "valid_c4_small/C4_small_expert1_balance_top": "30.967", "valid_c4_small/C4_small_expert1_balance_bottom": "18.899", "valid_c4_small/C4_small_unused_expert1_count": "0.459", "valid_c4_small/C4_small_expert2_balance_top": "31.424", "valid_c4_small/C4_small_expert2_balance_bottom": "18.18", "valid_c4_small/C4_small_unused_expert2_count": "0.38", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.032", "valid_c4_small/C4_small_ppl": "16.36", "valid_c4_small/C4_small_wps": "52007.5", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "6000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 04:53:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 6000 updates
2023-02-02 04:54:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 8 @ 6000 updates, score 4.212) (writing took 9.332414358854294 seconds)
2023-02-02 04:56:54 | INFO | train_inner | {"epoch": 8, "loss": "4.053", "moe_gate_loss": "12.7942", "overflow_expert1": "0.005", "overflow_expert2": "16.563", "entropy_gating": "0.395", "expert1_balance_top": "30.936", "expert1_balance_bottom": "17.739", "unused_expert1_count": "0.484", "expert2_balance_top": "32.023", "expert2_balance_bottom": "17.202", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.868", "ppl": "14.6", "wps": "8959", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "6010", "lr": "7.98e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "8", "train_wall": "169", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "110474"}
2023-02-02 04:59:46 | INFO | train_inner | {"epoch": 8, "loss": "4.084", "moe_gate_loss": "12.8156", "overflow_expert1": "0.007", "overflow_expert2": "16.666", "entropy_gating": "0.394", "expert1_balance_top": "31.106", "expert1_balance_bottom": "17.636", "unused_expert1_count": "0.486", "expert2_balance_top": "31.975", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.92", "wps": "15251.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6020", "lr": "7.96e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "110646"}
2023-02-02 05:02:38 | INFO | train_inner | {"epoch": 8, "loss": "4.026", "moe_gate_loss": "12.8135", "overflow_expert1": "0.008", "overflow_expert2": "16.699", "entropy_gating": "0.393", "expert1_balance_top": "31.082", "expert1_balance_bottom": "17.625", "unused_expert1_count": "0.488", "expert2_balance_top": "32.049", "expert2_balance_bottom": "17.218", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.841", "ppl": "14.33", "wps": "15276.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6030", "lr": "7.94e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "110818"}
2023-02-02 05:05:29 | INFO | train_inner | {"epoch": 8, "loss": "4.011", "moe_gate_loss": "12.7966", "overflow_expert1": "0.003", "overflow_expert2": "16.581", "entropy_gating": "0.393", "expert1_balance_top": "30.977", "expert1_balance_bottom": "17.726", "unused_expert1_count": "0.49", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.213", "unused_expert2_count": "0.457", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.827", "ppl": "14.19", "wps": "15282.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6040", "lr": "7.92e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "110989"}
2023-02-02 05:08:21 | INFO | train_inner | {"epoch": 8, "loss": "4.047", "moe_gate_loss": "12.7946", "overflow_expert1": "0.005", "overflow_expert2": "16.575", "entropy_gating": "0.394", "expert1_balance_top": "30.939", "expert1_balance_bottom": "17.737", "unused_expert1_count": "0.491", "expert2_balance_top": "31.975", "expert2_balance_bottom": "17.18", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.863", "ppl": "14.55", "wps": "15279.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6050", "lr": "7.9e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "111161"}
2023-02-02 05:11:13 | INFO | train_inner | {"epoch": 8, "loss": "4.042", "moe_gate_loss": "12.8128", "overflow_expert1": "0.011", "overflow_expert2": "16.699", "entropy_gating": "0.394", "expert1_balance_top": "31.087", "expert1_balance_bottom": "17.64", "unused_expert1_count": "0.49", "expert2_balance_top": "32.03", "expert2_balance_bottom": "17.165", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6060", "lr": "7.88e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "111332"}
2023-02-02 05:14:04 | INFO | train_inner | {"epoch": 8, "loss": "4.063", "moe_gate_loss": "12.7933", "overflow_expert1": "0.005", "overflow_expert2": "16.456", "entropy_gating": "0.394", "expert1_balance_top": "30.945", "expert1_balance_bottom": "17.729", "unused_expert1_count": "0.49", "expert2_balance_top": "31.921", "expert2_balance_bottom": "17.247", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.878", "ppl": "14.71", "wps": "15276", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6070", "lr": "7.86e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "111504"}
2023-02-02 05:16:56 | INFO | train_inner | {"epoch": 8, "loss": "4.008", "moe_gate_loss": "12.8055", "overflow_expert1": "0.008", "overflow_expert2": "16.663", "entropy_gating": "0.395", "expert1_balance_top": "31.01", "expert1_balance_bottom": "17.672", "unused_expert1_count": "0.484", "expert2_balance_top": "32.059", "expert2_balance_bottom": "17.189", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15277.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6080", "lr": "7.84e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "111676"}
2023-02-02 05:19:47 | INFO | train_inner | {"epoch": 8, "loss": "4.048", "moe_gate_loss": "12.8063", "overflow_expert1": "0.006", "overflow_expert2": "16.723", "entropy_gating": "0.394", "expert1_balance_top": "31.041", "expert1_balance_bottom": "17.693", "unused_expert1_count": "0.487", "expert2_balance_top": "32.066", "expert2_balance_bottom": "17.179", "unused_expert2_count": "0.438", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.863", "ppl": "14.55", "wps": "15275.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6090", "lr": "7.82e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "111847"}
2023-02-02 05:22:39 | INFO | train_inner | {"epoch": 8, "loss": "4.035", "moe_gate_loss": "12.7988", "overflow_expert1": "0.005", "overflow_expert2": "16.517", "entropy_gating": "0.393", "expert1_balance_top": "30.993", "expert1_balance_bottom": "17.718", "unused_expert1_count": "0.486", "expert2_balance_top": "31.968", "expert2_balance_bottom": "17.25", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.85", "ppl": "14.42", "wps": "15273", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6100", "lr": "7.8e-06", "gnorm": "1.221", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "112019"}
2023-02-02 05:25:31 | INFO | train_inner | {"epoch": 8, "loss": "4.007", "moe_gate_loss": "12.8079", "overflow_expert1": "0.008", "overflow_expert2": "16.595", "entropy_gating": "0.393", "expert1_balance_top": "31.033", "expert1_balance_bottom": "17.667", "unused_expert1_count": "0.489", "expert2_balance_top": "31.987", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.15", "wps": "15282.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6110", "lr": "7.78e-06", "gnorm": "1.222", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "112190"}
2023-02-02 05:28:22 | INFO | train_inner | {"epoch": 8, "loss": "4.033", "moe_gate_loss": "12.8129", "overflow_expert1": "0.006", "overflow_expert2": "16.905", "entropy_gating": "0.394", "expert1_balance_top": "31.087", "expert1_balance_bottom": "17.627", "unused_expert1_count": "0.487", "expert2_balance_top": "32.122", "expert2_balance_bottom": "17.113", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.849", "ppl": "14.41", "wps": "15273.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6120", "lr": "7.76e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "112362"}
2023-02-02 05:31:14 | INFO | train_inner | {"epoch": 8, "loss": "4.046", "moe_gate_loss": "12.8238", "overflow_expert1": "0.01", "overflow_expert2": "16.718", "entropy_gating": "0.393", "expert1_balance_top": "31.16", "expert1_balance_bottom": "17.59", "unused_expert1_count": "0.486", "expert2_balance_top": "32.073", "expert2_balance_bottom": "17.193", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.861", "ppl": "14.53", "wps": "15278.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6130", "lr": "7.74e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "112534"}
2023-02-02 05:34:05 | INFO | train_inner | {"epoch": 8, "loss": "4.018", "moe_gate_loss": "12.8016", "overflow_expert1": "0.007", "overflow_expert2": "16.626", "entropy_gating": "0.394", "expert1_balance_top": "30.996", "expert1_balance_bottom": "17.707", "unused_expert1_count": "0.489", "expert2_balance_top": "32.013", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.833", "ppl": "14.25", "wps": "15280.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6140", "lr": "7.72e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "112705"}
2023-02-02 05:36:57 | INFO | train_inner | {"epoch": 8, "loss": "4.06", "moe_gate_loss": "12.7941", "overflow_expert1": "0.007", "overflow_expert2": "16.41", "entropy_gating": "0.393", "expert1_balance_top": "30.957", "expert1_balance_bottom": "17.744", "unused_expert1_count": "0.484", "expert2_balance_top": "31.928", "expert2_balance_bottom": "17.261", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.875", "ppl": "14.68", "wps": "15275", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6150", "lr": "7.7e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "112877"}
2023-02-02 05:40:06 | INFO | train_inner | {"epoch": 8, "loss": "4.108", "moe_gate_loss": "12.8086", "overflow_expert1": "0.004", "overflow_expert2": "16.775", "entropy_gating": "0.394", "expert1_balance_top": "31.055", "expert1_balance_bottom": "17.656", "unused_expert1_count": "0.485", "expert2_balance_top": "32.095", "expert2_balance_bottom": "17.148", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.923", "ppl": "15.17", "wps": "13888.6", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "6160", "lr": "7.68e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "4", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "113066"}
2023-02-02 05:42:57 | INFO | train_inner | {"epoch": 8, "loss": "4.039", "moe_gate_loss": "12.7951", "overflow_expert1": "0.005", "overflow_expert2": "16.605", "entropy_gating": "0.393", "expert1_balance_top": "30.952", "expert1_balance_bottom": "17.722", "unused_expert1_count": "0.484", "expert2_balance_top": "32.027", "expert2_balance_bottom": "17.199", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.855", "ppl": "14.47", "wps": "15270.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6170", "lr": "7.66e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "113237"}
2023-02-02 05:45:49 | INFO | train_inner | {"epoch": 8, "loss": "4.057", "moe_gate_loss": "12.8037", "overflow_expert1": "0.005", "overflow_expert2": "16.72", "entropy_gating": "0.393", "expert1_balance_top": "31.005", "expert1_balance_bottom": "17.686", "unused_expert1_count": "0.482", "expert2_balance_top": "32.112", "expert2_balance_bottom": "17.171", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15279.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6180", "lr": "7.64e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "113409"}
2023-02-02 05:48:40 | INFO | train_inner | {"epoch": 8, "loss": "4.033", "moe_gate_loss": "12.8117", "overflow_expert1": "0.005", "overflow_expert2": "16.86", "entropy_gating": "0.394", "expert1_balance_top": "31.067", "expert1_balance_bottom": "17.652", "unused_expert1_count": "0.489", "expert2_balance_top": "32.171", "expert2_balance_bottom": "17.113", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.848", "ppl": "14.4", "wps": "15279.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6190", "lr": "7.62e-06", "gnorm": "1.225", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "113580"}
2023-02-02 05:51:32 | INFO | train_inner | {"epoch": 8, "loss": "4.045", "moe_gate_loss": "12.7987", "overflow_expert1": "0.004", "overflow_expert2": "16.543", "entropy_gating": "0.395", "expert1_balance_top": "30.975", "expert1_balance_bottom": "17.714", "unused_expert1_count": "0.486", "expert2_balance_top": "32.025", "expert2_balance_bottom": "17.224", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6200", "lr": "7.6e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "113752"}
2023-02-02 05:54:23 | INFO | train_inner | {"epoch": 8, "loss": "3.994", "moe_gate_loss": "12.7945", "overflow_expert1": "0.006", "overflow_expert2": "16.523", "entropy_gating": "0.393", "expert1_balance_top": "30.937", "expert1_balance_bottom": "17.757", "unused_expert1_count": "0.486", "expert2_balance_top": "32.001", "expert2_balance_bottom": "17.252", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.81", "ppl": "14.02", "wps": "15283", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6210", "lr": "7.58e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "113923"}
2023-02-02 05:57:15 | INFO | train_inner | {"epoch": 8, "loss": "4.018", "moe_gate_loss": "12.8135", "overflow_expert1": "0.009", "overflow_expert2": "16.825", "entropy_gating": "0.393", "expert1_balance_top": "31.056", "expert1_balance_bottom": "17.608", "unused_expert1_count": "0.487", "expert2_balance_top": "32.141", "expert2_balance_bottom": "17.128", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.833", "ppl": "14.25", "wps": "15292.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6220", "lr": "7.56e-06", "gnorm": "1.223", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "114095"}
2023-02-02 06:00:06 | INFO | train_inner | {"epoch": 8, "loss": "4.032", "moe_gate_loss": "12.8065", "overflow_expert1": "0.007", "overflow_expert2": "16.606", "entropy_gating": "0.393", "expert1_balance_top": "31.046", "expert1_balance_bottom": "17.693", "unused_expert1_count": "0.484", "expert2_balance_top": "32.056", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.847", "ppl": "14.39", "wps": "15288", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6230", "lr": "7.54e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "114266"}
2023-02-02 06:02:58 | INFO | train_inner | {"epoch": 8, "loss": "4.057", "moe_gate_loss": "12.7946", "overflow_expert1": "0.005", "overflow_expert2": "16.504", "entropy_gating": "0.394", "expert1_balance_top": "30.941", "expert1_balance_bottom": "17.757", "unused_expert1_count": "0.486", "expert2_balance_top": "31.998", "expert2_balance_bottom": "17.243", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.873", "ppl": "14.65", "wps": "15288.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6240", "lr": "7.52e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "114438"}
2023-02-02 06:05:49 | INFO | train_inner | {"epoch": 8, "loss": "4.02", "moe_gate_loss": "12.8058", "overflow_expert1": "0.007", "overflow_expert2": "16.61", "entropy_gating": "0.392", "expert1_balance_top": "31.022", "expert1_balance_bottom": "17.688", "unused_expert1_count": "0.483", "expert2_balance_top": "32.045", "expert2_balance_bottom": "17.245", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.835", "ppl": "14.27", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6250", "lr": "7.5e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "114609"}
2023-02-02 06:07:39 | INFO | valid_c4_small/C4_small | {"epoch": 8, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.5087", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.867", "valid_c4_small/C4_small_entropy_gating": "0.422", "valid_c4_small/C4_small_expert1_balance_top": "30.981", "valid_c4_small/C4_small_expert1_balance_bottom": "18.941", "valid_c4_small/C4_small_unused_expert1_count": "0.454", "valid_c4_small/C4_small_expert2_balance_top": "31.556", "valid_c4_small/C4_small_expert2_balance_bottom": "18.225", "valid_c4_small/C4_small_unused_expert2_count": "0.381", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.34", "valid_c4_small/C4_small_wps": "52079", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "6250", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 06:07:39 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 6250 updates
2023-02-02 06:07:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 8 @ 6250 updates, score 4.21) (writing took 16.19750810507685 seconds)
2023-02-02 06:10:46 | INFO | train_inner | {"epoch": 8, "loss": "3.983", "moe_gate_loss": "12.7923", "overflow_expert1": "0.006", "overflow_expert2": "16.509", "entropy_gating": "0.393", "expert1_balance_top": "30.948", "expert1_balance_bottom": "17.742", "unused_expert1_count": "0.485", "expert2_balance_top": "32.029", "expert2_balance_bottom": "17.24", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.799", "ppl": "13.92", "wps": "8831.1", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "6260", "lr": "7.48e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "114906"}
2023-02-02 06:13:38 | INFO | train_inner | {"epoch": 8, "loss": "4.02", "moe_gate_loss": "12.8202", "overflow_expert1": "0.007", "overflow_expert2": "16.704", "entropy_gating": "0.393", "expert1_balance_top": "31.11", "expert1_balance_bottom": "17.618", "unused_expert1_count": "0.488", "expert2_balance_top": "32.069", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.835", "ppl": "14.27", "wps": "15273.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6270", "lr": "7.46e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "115078"}
2023-02-02 06:16:30 | INFO | train_inner | {"epoch": 8, "loss": "4.017", "moe_gate_loss": "12.7947", "overflow_expert1": "0.004", "overflow_expert2": "16.641", "entropy_gating": "0.393", "expert1_balance_top": "30.962", "expert1_balance_bottom": "17.734", "unused_expert1_count": "0.484", "expert2_balance_top": "32.089", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.832", "ppl": "14.24", "wps": "15264.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6280", "lr": "7.44e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "115249"}
2023-02-02 06:19:21 | INFO | train_inner | {"epoch": 8, "loss": "4.004", "moe_gate_loss": "12.7982", "overflow_expert1": "0.005", "overflow_expert2": "16.61", "entropy_gating": "0.393", "expert1_balance_top": "30.984", "expert1_balance_bottom": "17.72", "unused_expert1_count": "0.486", "expert2_balance_top": "32", "expert2_balance_bottom": "17.22", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.12", "wps": "15270.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6290", "lr": "7.42e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "115421"}
2023-02-02 06:22:13 | INFO | train_inner | {"epoch": 8, "loss": "3.974", "moe_gate_loss": "12.7957", "overflow_expert1": "0.008", "overflow_expert2": "16.494", "entropy_gating": "0.393", "expert1_balance_top": "30.935", "expert1_balance_bottom": "17.725", "unused_expert1_count": "0.487", "expert2_balance_top": "32.016", "expert2_balance_bottom": "17.204", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.79", "ppl": "13.83", "wps": "15283.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6300", "lr": "7.4e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "115593"}
2023-02-02 06:25:21 | INFO | train_inner | {"epoch": 8, "loss": "4.097", "moe_gate_loss": "12.8099", "overflow_expert1": "0.007", "overflow_expert2": "16.662", "entropy_gating": "0.393", "expert1_balance_top": "31.041", "expert1_balance_bottom": "17.659", "unused_expert1_count": "0.488", "expert2_balance_top": "31.989", "expert2_balance_bottom": "17.181", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.912", "ppl": "15.06", "wps": "13895.8", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "6310", "lr": "7.38e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "2", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "115781"}
2023-02-02 06:28:13 | INFO | train_inner | {"epoch": 8, "loss": "3.99", "moe_gate_loss": "12.7883", "overflow_expert1": "0.005", "overflow_expert2": "16.417", "entropy_gating": "0.394", "expert1_balance_top": "30.916", "expert1_balance_bottom": "17.786", "unused_expert1_count": "0.484", "expert2_balance_top": "31.98", "expert2_balance_bottom": "17.279", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.805", "ppl": "13.98", "wps": "15282.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6320", "lr": "7.36e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "115953"}
2023-02-02 06:31:04 | INFO | train_inner | {"epoch": 8, "loss": "4.072", "moe_gate_loss": "12.7891", "overflow_expert1": "0.005", "overflow_expert2": "16.473", "entropy_gating": "0.394", "expert1_balance_top": "30.914", "expert1_balance_bottom": "17.772", "unused_expert1_count": "0.489", "expert2_balance_top": "32.007", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.888", "ppl": "14.8", "wps": "15283.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6330", "lr": "7.34e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "116124"}
2023-02-02 06:33:56 | INFO | train_inner | {"epoch": 8, "loss": "4.05", "moe_gate_loss": "12.805", "overflow_expert1": "0.009", "overflow_expert2": "16.65", "entropy_gating": "0.393", "expert1_balance_top": "31.004", "expert1_balance_bottom": "17.686", "unused_expert1_count": "0.487", "expert2_balance_top": "32.077", "expert2_balance_bottom": "17.177", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.866", "ppl": "14.58", "wps": "15273.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6340", "lr": "7.32e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "116296"}
2023-02-02 06:36:48 | INFO | train_inner | {"epoch": 8, "loss": "4.096", "moe_gate_loss": "12.7904", "overflow_expert1": "0.005", "overflow_expert2": "16.422", "entropy_gating": "0.394", "expert1_balance_top": "30.932", "expert1_balance_bottom": "17.76", "unused_expert1_count": "0.486", "expert2_balance_top": "31.923", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.911", "ppl": "15.05", "wps": "15281.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6350", "lr": "7.3e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "116467"}
2023-02-02 06:39:39 | INFO | train_inner | {"epoch": 8, "loss": "4.071", "moe_gate_loss": "12.7888", "overflow_expert1": "0.003", "overflow_expert2": "16.454", "entropy_gating": "0.393", "expert1_balance_top": "30.916", "expert1_balance_bottom": "17.775", "unused_expert1_count": "0.483", "expert2_balance_top": "31.952", "expert2_balance_bottom": "17.237", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.887", "ppl": "14.79", "wps": "15280.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6360", "lr": "7.28e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "116639"}
2023-02-02 06:42:31 | INFO | train_inner | {"epoch": 8, "loss": "4.057", "moe_gate_loss": "12.7805", "overflow_expert1": "0.003", "overflow_expert2": "16.414", "entropy_gating": "0.393", "expert1_balance_top": "30.861", "expert1_balance_bottom": "17.817", "unused_expert1_count": "0.486", "expert2_balance_top": "32.021", "expert2_balance_bottom": "17.246", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.873", "ppl": "14.65", "wps": "15282.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6370", "lr": "7.26e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "116811"}
2023-02-02 06:45:22 | INFO | train_inner | {"epoch": 8, "loss": "4.072", "moe_gate_loss": "12.7877", "overflow_expert1": "0.004", "overflow_expert2": "16.401", "entropy_gating": "0.393", "expert1_balance_top": "30.908", "expert1_balance_bottom": "17.765", "unused_expert1_count": "0.486", "expert2_balance_top": "31.972", "expert2_balance_bottom": "17.24", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.887", "ppl": "14.8", "wps": "15286.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6380", "lr": "7.24e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "116982"}
2023-02-02 06:48:14 | INFO | train_inner | {"epoch": 8, "loss": "4.04", "moe_gate_loss": "12.7962", "overflow_expert1": "0.01", "overflow_expert2": "16.487", "entropy_gating": "0.394", "expert1_balance_top": "30.954", "expert1_balance_bottom": "17.747", "unused_expert1_count": "0.485", "expert2_balance_top": "31.985", "expert2_balance_bottom": "17.193", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.855", "ppl": "14.47", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6390", "lr": "7.22e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "117154"}
2023-02-02 06:51:05 | INFO | train_inner | {"epoch": 8, "loss": "4.059", "moe_gate_loss": "12.7885", "overflow_expert1": "0.005", "overflow_expert2": "16.41", "entropy_gating": "0.393", "expert1_balance_top": "30.909", "expert1_balance_bottom": "17.781", "unused_expert1_count": "0.487", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.255", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.875", "ppl": "14.67", "wps": "15288.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6400", "lr": "7.2e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "117325"}
2023-02-02 06:53:57 | INFO | train_inner | {"epoch": 8, "loss": "4.035", "moe_gate_loss": "12.7995", "overflow_expert1": "0.008", "overflow_expert2": "16.716", "entropy_gating": "0.393", "expert1_balance_top": "30.984", "expert1_balance_bottom": "17.718", "unused_expert1_count": "0.487", "expert2_balance_top": "32.089", "expert2_balance_bottom": "17.145", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.85", "ppl": "14.42", "wps": "15286.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6410", "lr": "7.18e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "117496"}
2023-02-02 06:56:48 | INFO | train_inner | {"epoch": 8, "loss": "4.059", "moe_gate_loss": "12.7933", "overflow_expert1": "0.006", "overflow_expert2": "16.651", "entropy_gating": "0.393", "expert1_balance_top": "30.945", "expert1_balance_bottom": "17.742", "unused_expert1_count": "0.486", "expert2_balance_top": "32.061", "expert2_balance_bottom": "17.156", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.874", "ppl": "14.66", "wps": "15278.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6420", "lr": "7.16e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "117668"}
2023-02-02 06:59:40 | INFO | train_inner | {"epoch": 8, "loss": "4.035", "moe_gate_loss": "12.7808", "overflow_expert1": "0.003", "overflow_expert2": "16.366", "entropy_gating": "0.394", "expert1_balance_top": "30.871", "expert1_balance_bottom": "17.828", "unused_expert1_count": "0.486", "expert2_balance_top": "31.974", "expert2_balance_bottom": "17.248", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.851", "ppl": "14.43", "wps": "15293", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6430", "lr": "7.14e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "117839"}
2023-02-02 07:02:31 | INFO | train_inner | {"epoch": 8, "loss": "4.104", "moe_gate_loss": "12.7872", "overflow_expert1": "0.006", "overflow_expert2": "16.376", "entropy_gating": "0.394", "expert1_balance_top": "30.903", "expert1_balance_bottom": "17.786", "unused_expert1_count": "0.488", "expert2_balance_top": "31.994", "expert2_balance_bottom": "17.267", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.919", "ppl": "15.13", "wps": "15283.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6440", "lr": "7.12e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "118011"}
2023-02-02 07:05:23 | INFO | train_inner | {"epoch": 8, "loss": "4.022", "moe_gate_loss": "12.8013", "overflow_expert1": "0.008", "overflow_expert2": "16.573", "entropy_gating": "0.393", "expert1_balance_top": "30.974", "expert1_balance_bottom": "17.713", "unused_expert1_count": "0.489", "expert2_balance_top": "32.03", "expert2_balance_bottom": "17.198", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.837", "ppl": "14.29", "wps": "15282.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6450", "lr": "7.1e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "118183"}
2023-02-02 07:08:14 | INFO | train_inner | {"epoch": 8, "loss": "4.076", "moe_gate_loss": "12.7996", "overflow_expert1": "0.005", "overflow_expert2": "16.679", "entropy_gating": "0.394", "expert1_balance_top": "30.973", "expert1_balance_bottom": "17.715", "unused_expert1_count": "0.487", "expert2_balance_top": "32.059", "expert2_balance_bottom": "17.167", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.891", "ppl": "14.84", "wps": "15283.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6460", "lr": "7.08e-06", "gnorm": "1.185", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "118354"}
2023-02-02 07:11:06 | INFO | train_inner | {"epoch": 8, "loss": "4.038", "moe_gate_loss": "12.8006", "overflow_expert1": "0.006", "overflow_expert2": "16.638", "entropy_gating": "0.394", "expert1_balance_top": "30.997", "expert1_balance_bottom": "17.704", "unused_expert1_count": "0.485", "expert2_balance_top": "32.059", "expert2_balance_bottom": "17.161", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6470", "lr": "7.06e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "118526"}
2023-02-02 07:13:57 | INFO | train_inner | {"epoch": 8, "loss": "4.032", "moe_gate_loss": "12.7991", "overflow_expert1": "0.004", "overflow_expert2": "16.573", "entropy_gating": "0.394", "expert1_balance_top": "30.989", "expert1_balance_bottom": "17.731", "unused_expert1_count": "0.488", "expert2_balance_top": "32.022", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.439", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.848", "ppl": "14.4", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6480", "lr": "7.04e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "118697"}
2023-02-02 07:16:49 | INFO | train_inner | {"epoch": 8, "loss": "4.042", "moe_gate_loss": "12.8149", "overflow_expert1": "0.006", "overflow_expert2": "16.78", "entropy_gating": "0.392", "expert1_balance_top": "31.086", "expert1_balance_bottom": "17.627", "unused_expert1_count": "0.484", "expert2_balance_top": "32.079", "expert2_balance_bottom": "17.157", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15279.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6490", "lr": "7.02e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "118869"}
2023-02-02 07:19:40 | INFO | train_inner | {"epoch": 8, "loss": "4.044", "moe_gate_loss": "12.7788", "overflow_expert1": "0.005", "overflow_expert2": "16.381", "entropy_gating": "0.393", "expert1_balance_top": "30.837", "expert1_balance_bottom": "17.829", "unused_expert1_count": "0.489", "expert2_balance_top": "31.904", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "15286.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6500", "lr": "7e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "119040"}
2023-02-02 07:21:30 | INFO | valid_c4_small/C4_small | {"epoch": 8, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.4926", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.842", "valid_c4_small/C4_small_entropy_gating": "0.423", "valid_c4_small/C4_small_expert1_balance_top": "30.842", "valid_c4_small/C4_small_expert1_balance_bottom": "18.977", "valid_c4_small/C4_small_unused_expert1_count": "0.455", "valid_c4_small/C4_small_expert2_balance_top": "31.417", "valid_c4_small/C4_small_expert2_balance_bottom": "18.136", "valid_c4_small/C4_small_unused_expert2_count": "0.383", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.34", "valid_c4_small/C4_small_wps": "52034.7", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "6500", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 07:21:30 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 6500 updates
2023-02-02 07:21:37 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 8 @ 6500 updates, score 4.21) (writing took 7.578851353842765 seconds)
2023-02-02 07:24:29 | INFO | train_inner | {"epoch": 8, "loss": "4.066", "moe_gate_loss": "12.7899", "overflow_expert1": "0.006", "overflow_expert2": "16.429", "entropy_gating": "0.393", "expert1_balance_top": "30.928", "expert1_balance_bottom": "17.78", "unused_expert1_count": "0.487", "expert2_balance_top": "31.956", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.881", "ppl": "14.74", "wps": "9063.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "6510", "lr": "6.98e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "119329"}
2023-02-02 07:27:21 | INFO | train_inner | {"epoch": 8, "loss": "4.075", "moe_gate_loss": "12.7768", "overflow_expert1": "0.004", "overflow_expert2": "16.242", "entropy_gating": "0.393", "expert1_balance_top": "30.819", "expert1_balance_bottom": "17.841", "unused_expert1_count": "0.489", "expert2_balance_top": "31.908", "expert2_balance_bottom": "17.295", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.891", "ppl": "14.83", "wps": "15266.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6520", "lr": "6.96e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "119501"}
2023-02-02 07:31:02 | INFO | valid_c4_small/C4_small | {"epoch": 8, "valid_c4_small/C4_small_loss": "4.209", "valid_c4_small/C4_small_moe_gate_loss": "12.4981", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.912", "valid_c4_small/C4_small_entropy_gating": "0.423", "valid_c4_small/C4_small_expert1_balance_top": "30.862", "valid_c4_small/C4_small_expert1_balance_bottom": "18.988", "valid_c4_small/C4_small_unused_expert1_count": "0.451", "valid_c4_small/C4_small_expert2_balance_top": "31.478", "valid_c4_small/C4_small_expert2_balance_bottom": "18.191", "valid_c4_small/C4_small_unused_expert2_count": "0.378", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.028", "valid_c4_small/C4_small_ppl": "16.32", "valid_c4_small/C4_small_wps": "52036.5", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "6526", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 07:31:02 | INFO | fairseq_cli.train | end of epoch 8 (average epoch stats below)
2023-02-02 07:31:02 | INFO | train | {"epoch": 8, "train_loss": "4.039", "train_moe_gate_loss": "12.8007", "train_overflow_expert1": "0.006", "train_overflow_expert2": "16.632", "train_entropy_gating": "0.394", "train_expert1_balance_top": "30.995", "train_expert1_balance_bottom": "17.695", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "32.032", "train_expert2_balance_bottom": "17.188", "train_unused_expert2_count": "0.449", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.854", "train_ppl": "14.46", "train_wps": "14613.3", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "6526", "train_lr": "6.948e-06", "train_gnorm": "1.204", "train_clip": "100", "train_loss_scale": "1", "train_train_wall": "13580", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "119721"}
2023-02-02 07:31:02 | INFO | fairseq.trainer | begin training epoch 9
2023-02-02 07:32:10 | INFO | train_inner | {"epoch": 9, "loss": "4.046", "moe_gate_loss": "12.7897", "overflow_expert1": "0.008", "overflow_expert2": "16.433", "entropy_gating": "0.393", "expert1_balance_top": "30.894", "expert1_balance_bottom": "17.783", "unused_expert1_count": "0.484", "expert2_balance_top": "31.996", "expert2_balance_bottom": "17.233", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.861", "ppl": "14.53", "wps": "9067", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "6530", "lr": "6.94e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "1", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "119790"}
2023-02-02 07:35:02 | INFO | train_inner | {"epoch": 9, "loss": "4.088", "moe_gate_loss": "12.7828", "overflow_expert1": "0.007", "overflow_expert2": "16.36", "entropy_gating": "0.394", "expert1_balance_top": "30.858", "expert1_balance_bottom": "17.808", "unused_expert1_count": "0.488", "expert2_balance_top": "31.999", "expert2_balance_bottom": "17.239", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.904", "ppl": "14.97", "wps": "15273.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6540", "lr": "6.92e-06", "gnorm": "1.185", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "119962"}
2023-02-02 07:37:53 | INFO | train_inner | {"epoch": 9, "loss": "4.018", "moe_gate_loss": "12.7933", "overflow_expert1": "0.006", "overflow_expert2": "17.031", "entropy_gating": "0.395", "expert1_balance_top": "30.926", "expert1_balance_bottom": "17.695", "unused_expert1_count": "0.486", "expert2_balance_top": "32.268", "expert2_balance_bottom": "16.965", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.833", "ppl": "14.26", "wps": "15275.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6550", "lr": "6.9e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "120133"}
2023-02-02 07:40:45 | INFO | train_inner | {"epoch": 9, "loss": "4.005", "moe_gate_loss": "12.8005", "overflow_expert1": "0.005", "overflow_expert2": "17.042", "entropy_gating": "0.394", "expert1_balance_top": "30.996", "expert1_balance_bottom": "17.641", "unused_expert1_count": "0.486", "expert2_balance_top": "32.25", "expert2_balance_bottom": "16.986", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.13", "wps": "15278.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6560", "lr": "6.88e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "120305"}
2023-02-02 07:43:37 | INFO | train_inner | {"epoch": 9, "loss": "4.014", "moe_gate_loss": "12.7995", "overflow_expert1": "0.004", "overflow_expert2": "16.853", "entropy_gating": "0.394", "expert1_balance_top": "31.001", "expert1_balance_bottom": "17.639", "unused_expert1_count": "0.486", "expert2_balance_top": "32.092", "expert2_balance_bottom": "17.061", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.83", "ppl": "14.22", "wps": "15284.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6570", "lr": "6.86e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "120476"}
2023-02-02 07:46:28 | INFO | train_inner | {"epoch": 9, "loss": "3.95", "moe_gate_loss": "12.8039", "overflow_expert1": "0.006", "overflow_expert2": "16.979", "entropy_gating": "0.394", "expert1_balance_top": "31.032", "expert1_balance_bottom": "17.613", "unused_expert1_count": "0.487", "expert2_balance_top": "32.121", "expert2_balance_bottom": "17.027", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.765", "ppl": "13.6", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6580", "lr": "6.84e-06", "gnorm": "1.199", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "120648"}
2023-02-02 07:49:20 | INFO | train_inner | {"epoch": 9, "loss": "3.989", "moe_gate_loss": "12.7916", "overflow_expert1": "0.003", "overflow_expert2": "16.698", "entropy_gating": "0.394", "expert1_balance_top": "30.929", "expert1_balance_bottom": "17.687", "unused_expert1_count": "0.489", "expert2_balance_top": "32.063", "expert2_balance_bottom": "17.094", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.804", "ppl": "13.97", "wps": "15287.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6590", "lr": "6.82e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "120819"}
2023-02-02 07:52:11 | INFO | train_inner | {"epoch": 9, "loss": "4.005", "moe_gate_loss": "12.7992", "overflow_expert1": "0.003", "overflow_expert2": "16.631", "entropy_gating": "0.393", "expert1_balance_top": "30.988", "expert1_balance_bottom": "17.665", "unused_expert1_count": "0.484", "expert2_balance_top": "32.072", "expert2_balance_bottom": "17.164", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.821", "ppl": "14.13", "wps": "15285.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6600", "lr": "6.8e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "120991"}
2023-02-02 07:55:03 | INFO | train_inner | {"epoch": 9, "loss": "4.03", "moe_gate_loss": "12.7908", "overflow_expert1": "0.006", "overflow_expert2": "16.697", "entropy_gating": "0.393", "expert1_balance_top": "30.925", "expert1_balance_bottom": "17.709", "unused_expert1_count": "0.485", "expert2_balance_top": "32.069", "expert2_balance_bottom": "17.124", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.845", "ppl": "14.37", "wps": "15283.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6610", "lr": "6.78e-06", "gnorm": "1.218", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "121162"}
2023-02-02 07:57:54 | INFO | train_inner | {"epoch": 9, "loss": "3.997", "moe_gate_loss": "12.7896", "overflow_expert1": "0.002", "overflow_expert2": "16.595", "entropy_gating": "0.393", "expert1_balance_top": "30.92", "expert1_balance_bottom": "17.696", "unused_expert1_count": "0.485", "expert2_balance_top": "32.008", "expert2_balance_bottom": "17.136", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.812", "ppl": "14.05", "wps": "15290.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6620", "lr": "6.76e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "121334"}
2023-02-02 08:00:45 | INFO | train_inner | {"epoch": 9, "loss": "4.02", "moe_gate_loss": "12.7886", "overflow_expert1": "0.004", "overflow_expert2": "16.605", "entropy_gating": "0.393", "expert1_balance_top": "30.908", "expert1_balance_bottom": "17.74", "unused_expert1_count": "0.486", "expert2_balance_top": "32.022", "expert2_balance_bottom": "17.142", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.835", "ppl": "14.27", "wps": "15286.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6630", "lr": "6.74e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "121505"}
2023-02-02 08:03:37 | INFO | train_inner | {"epoch": 9, "loss": "3.993", "moe_gate_loss": "12.8032", "overflow_expert1": "0.006", "overflow_expert2": "16.644", "entropy_gating": "0.393", "expert1_balance_top": "31.008", "expert1_balance_bottom": "17.658", "unused_expert1_count": "0.483", "expert2_balance_top": "32.036", "expert2_balance_bottom": "17.15", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.808", "ppl": "14", "wps": "15277.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6640", "lr": "6.72e-06", "gnorm": "1.22", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "121677"}
2023-02-02 08:06:29 | INFO | train_inner | {"epoch": 9, "loss": "4.013", "moe_gate_loss": "12.7923", "overflow_expert1": "0.004", "overflow_expert2": "16.654", "entropy_gating": "0.394", "expert1_balance_top": "30.926", "expert1_balance_bottom": "17.726", "unused_expert1_count": "0.485", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.142", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.828", "ppl": "14.2", "wps": "15281.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6650", "lr": "6.7e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "121849"}
2023-02-02 08:09:20 | INFO | train_inner | {"epoch": 9, "loss": "3.984", "moe_gate_loss": "12.809", "overflow_expert1": "0.004", "overflow_expert2": "16.792", "entropy_gating": "0.394", "expert1_balance_top": "31.079", "expert1_balance_bottom": "17.629", "unused_expert1_count": "0.484", "expert2_balance_top": "32.104", "expert2_balance_bottom": "17.124", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.799", "ppl": "13.92", "wps": "15292.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6660", "lr": "6.68e-06", "gnorm": "1.234", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "122020"}
2023-02-02 08:12:11 | INFO | train_inner | {"epoch": 9, "loss": "4.062", "moe_gate_loss": "12.792", "overflow_expert1": "0.006", "overflow_expert2": "16.384", "entropy_gating": "0.394", "expert1_balance_top": "30.936", "expert1_balance_bottom": "17.735", "unused_expert1_count": "0.486", "expert2_balance_top": "31.922", "expert2_balance_bottom": "17.248", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.877", "ppl": "14.69", "wps": "15287.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6670", "lr": "6.66e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "122191"}
2023-02-02 08:15:03 | INFO | train_inner | {"epoch": 9, "loss": "4.011", "moe_gate_loss": "12.7944", "overflow_expert1": "0.006", "overflow_expert2": "16.493", "entropy_gating": "0.392", "expert1_balance_top": "30.93", "expert1_balance_bottom": "17.724", "unused_expert1_count": "0.486", "expert2_balance_top": "31.935", "expert2_balance_bottom": "17.196", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15287", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6680", "lr": "6.64e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "122363"}
2023-02-02 08:17:55 | INFO | train_inner | {"epoch": 9, "loss": "4.029", "moe_gate_loss": "12.7975", "overflow_expert1": "0.007", "overflow_expert2": "16.644", "entropy_gating": "0.393", "expert1_balance_top": "30.957", "expert1_balance_bottom": "17.716", "unused_expert1_count": "0.486", "expert2_balance_top": "31.992", "expert2_balance_bottom": "17.181", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15280.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6690", "lr": "6.62e-06", "gnorm": "1.234", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "122534"}
2023-02-02 08:20:46 | INFO | train_inner | {"epoch": 9, "loss": "4.08", "moe_gate_loss": "12.8261", "overflow_expert1": "0.006", "overflow_expert2": "17.013", "entropy_gating": "0.394", "expert1_balance_top": "31.161", "expert1_balance_bottom": "17.539", "unused_expert1_count": "0.486", "expert2_balance_top": "32.158", "expert2_balance_bottom": "17.063", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.895", "ppl": "14.88", "wps": "15285.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6700", "lr": "6.6e-06", "gnorm": "1.258", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "122706"}
2023-02-02 08:23:37 | INFO | train_inner | {"epoch": 9, "loss": "4.027", "moe_gate_loss": "12.798", "overflow_expert1": "0.005", "overflow_expert2": "16.563", "entropy_gating": "0.393", "expert1_balance_top": "30.976", "expert1_balance_bottom": "17.715", "unused_expert1_count": "0.482", "expert2_balance_top": "32.001", "expert2_balance_bottom": "17.211", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.843", "ppl": "14.35", "wps": "15287.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6710", "lr": "6.58e-06", "gnorm": "1.22", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "122877"}
2023-02-02 08:26:29 | INFO | train_inner | {"epoch": 9, "loss": "4.025", "moe_gate_loss": "12.7877", "overflow_expert1": "0.004", "overflow_expert2": "16.364", "entropy_gating": "0.393", "expert1_balance_top": "30.91", "expert1_balance_bottom": "17.774", "unused_expert1_count": "0.487", "expert2_balance_top": "31.93", "expert2_balance_bottom": "17.286", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.841", "ppl": "14.33", "wps": "15288.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6720", "lr": "6.56e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "123049"}
2023-02-02 08:29:20 | INFO | train_inner | {"epoch": 9, "loss": "3.997", "moe_gate_loss": "12.8088", "overflow_expert1": "0.004", "overflow_expert2": "16.75", "entropy_gating": "0.393", "expert1_balance_top": "31.043", "expert1_balance_bottom": "17.623", "unused_expert1_count": "0.485", "expert2_balance_top": "32.113", "expert2_balance_bottom": "17.173", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.812", "ppl": "14.04", "wps": "15290.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6730", "lr": "6.54e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "123220"}
2023-02-02 08:32:12 | INFO | train_inner | {"epoch": 9, "loss": "4.014", "moe_gate_loss": "12.8057", "overflow_expert1": "0.006", "overflow_expert2": "16.676", "entropy_gating": "0.392", "expert1_balance_top": "31.009", "expert1_balance_bottom": "17.688", "unused_expert1_count": "0.486", "expert2_balance_top": "32.062", "expert2_balance_bottom": "17.163", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.829", "ppl": "14.22", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6740", "lr": "6.52e-06", "gnorm": "1.216", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "123392"}
2023-02-02 08:35:03 | INFO | train_inner | {"epoch": 9, "loss": "4.033", "moe_gate_loss": "12.7917", "overflow_expert1": "0.005", "overflow_expert2": "16.424", "entropy_gating": "0.392", "expert1_balance_top": "30.908", "expert1_balance_bottom": "17.745", "unused_expert1_count": "0.482", "expert2_balance_top": "31.922", "expert2_balance_bottom": "17.238", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.849", "ppl": "14.41", "wps": "15288.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6750", "lr": "6.5e-06", "gnorm": "1.222", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "123563"}
2023-02-02 08:36:53 | INFO | valid_c4_small/C4_small | {"epoch": 9, "valid_c4_small/C4_small_loss": "4.213", "valid_c4_small/C4_small_moe_gate_loss": "12.4927", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.89", "valid_c4_small/C4_small_entropy_gating": "0.423", "valid_c4_small/C4_small_expert1_balance_top": "30.869", "valid_c4_small/C4_small_expert1_balance_bottom": "18.919", "valid_c4_small/C4_small_unused_expert1_count": "0.451", "valid_c4_small/C4_small_expert2_balance_top": "31.394", "valid_c4_small/C4_small_expert2_balance_bottom": "18.197", "valid_c4_small/C4_small_unused_expert2_count": "0.38", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.033", "valid_c4_small/C4_small_ppl": "16.37", "valid_c4_small/C4_small_wps": "52052.6", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "6750", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 08:36:53 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 6750 updates
2023-02-02 08:37:00 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 9 @ 6750 updates, score 4.213) (writing took 7.531755591277033 seconds)
2023-02-02 08:39:53 | INFO | train_inner | {"epoch": 9, "loss": "4.024", "moe_gate_loss": "12.792", "overflow_expert1": "0.006", "overflow_expert2": "16.511", "entropy_gating": "0.394", "expert1_balance_top": "30.915", "expert1_balance_bottom": "17.775", "unused_expert1_count": "0.485", "expert2_balance_top": "32.003", "expert2_balance_bottom": "17.21", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.839", "ppl": "14.31", "wps": "9061.6", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "6760", "lr": "6.48e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "1", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "123853"}
2023-02-02 08:42:44 | INFO | train_inner | {"epoch": 9, "loss": "4.001", "moe_gate_loss": "12.8112", "overflow_expert1": "0.006", "overflow_expert2": "16.713", "entropy_gating": "0.394", "expert1_balance_top": "31.048", "expert1_balance_bottom": "17.645", "unused_expert1_count": "0.481", "expert2_balance_top": "32.088", "expert2_balance_bottom": "17.188", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.816", "ppl": "14.09", "wps": "15285", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6770", "lr": "6.46e-06", "gnorm": "1.222", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "124024"}
2023-02-02 08:45:36 | INFO | train_inner | {"epoch": 9, "loss": "4.01", "moe_gate_loss": "12.7959", "overflow_expert1": "0.005", "overflow_expert2": "16.574", "entropy_gating": "0.393", "expert1_balance_top": "30.952", "expert1_balance_bottom": "17.729", "unused_expert1_count": "0.487", "expert2_balance_top": "31.962", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.825", "ppl": "14.17", "wps": "15292", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6780", "lr": "6.44e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "124195"}
2023-02-02 08:48:27 | INFO | train_inner | {"epoch": 9, "loss": "4.012", "moe_gate_loss": "12.7889", "overflow_expert1": "0.004", "overflow_expert2": "16.515", "entropy_gating": "0.393", "expert1_balance_top": "30.908", "expert1_balance_bottom": "17.76", "unused_expert1_count": "0.486", "expert2_balance_top": "31.994", "expert2_balance_bottom": "17.218", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.828", "ppl": "14.2", "wps": "15281.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6790", "lr": "6.42e-06", "gnorm": "1.219", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "124367"}
2023-02-02 08:51:19 | INFO | train_inner | {"epoch": 9, "loss": "4.055", "moe_gate_loss": "12.7917", "overflow_expert1": "0.003", "overflow_expert2": "16.551", "entropy_gating": "0.393", "expert1_balance_top": "30.922", "expert1_balance_bottom": "17.741", "unused_expert1_count": "0.484", "expert2_balance_top": "31.995", "expert2_balance_bottom": "17.198", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.871", "ppl": "14.63", "wps": "15277.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6800", "lr": "6.4e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "124539"}
2023-02-02 08:54:10 | INFO | train_inner | {"epoch": 9, "loss": "3.984", "moe_gate_loss": "12.8038", "overflow_expert1": "0.005", "overflow_expert2": "16.676", "entropy_gating": "0.393", "expert1_balance_top": "31.018", "expert1_balance_bottom": "17.678", "unused_expert1_count": "0.485", "expert2_balance_top": "32.028", "expert2_balance_bottom": "17.182", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.799", "ppl": "13.92", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6810", "lr": "6.38e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "124710"}
2023-02-02 08:57:02 | INFO | train_inner | {"epoch": 9, "loss": "4.059", "moe_gate_loss": "12.7923", "overflow_expert1": "0.004", "overflow_expert2": "16.502", "entropy_gating": "0.394", "expert1_balance_top": "30.925", "expert1_balance_bottom": "17.752", "unused_expert1_count": "0.487", "expert2_balance_top": "32.031", "expert2_balance_bottom": "17.204", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.875", "ppl": "14.67", "wps": "15280.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6820", "lr": "6.36e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "124882"}
2023-02-02 08:59:53 | INFO | train_inner | {"epoch": 9, "loss": "4.064", "moe_gate_loss": "12.7864", "overflow_expert1": "0.005", "overflow_expert2": "16.359", "entropy_gating": "0.393", "expert1_balance_top": "30.869", "expert1_balance_bottom": "17.791", "unused_expert1_count": "0.482", "expert2_balance_top": "31.929", "expert2_balance_bottom": "17.258", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.71", "wps": "15282.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6830", "lr": "6.34e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "125053"}
2023-02-02 09:02:45 | INFO | train_inner | {"epoch": 9, "loss": "4.044", "moe_gate_loss": "12.8125", "overflow_expert1": "0.006", "overflow_expert2": "16.66", "entropy_gating": "0.393", "expert1_balance_top": "31.074", "expert1_balance_bottom": "17.651", "unused_expert1_count": "0.485", "expert2_balance_top": "32.008", "expert2_balance_bottom": "17.215", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.859", "ppl": "14.51", "wps": "15279.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6840", "lr": "6.32e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "125225"}
2023-02-02 09:05:36 | INFO | train_inner | {"epoch": 9, "loss": "3.988", "moe_gate_loss": "12.8049", "overflow_expert1": "0.006", "overflow_expert2": "16.66", "entropy_gating": "0.393", "expert1_balance_top": "31.011", "expert1_balance_bottom": "17.675", "unused_expert1_count": "0.485", "expert2_balance_top": "32.05", "expert2_balance_bottom": "17.206", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.804", "ppl": "13.96", "wps": "15286.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6850", "lr": "6.3e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "125396"}
2023-02-02 09:08:28 | INFO | train_inner | {"epoch": 9, "loss": "3.998", "moe_gate_loss": "12.7849", "overflow_expert1": "0.004", "overflow_expert2": "16.367", "entropy_gating": "0.393", "expert1_balance_top": "30.882", "expert1_balance_bottom": "17.778", "unused_expert1_count": "0.485", "expert2_balance_top": "31.955", "expert2_balance_bottom": "17.241", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.814", "ppl": "14.06", "wps": "15285.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6860", "lr": "6.28e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "125568"}
2023-02-02 09:11:19 | INFO | train_inner | {"epoch": 9, "loss": "4.02", "moe_gate_loss": "12.793", "overflow_expert1": "0.005", "overflow_expert2": "16.54", "entropy_gating": "0.393", "expert1_balance_top": "30.916", "expert1_balance_bottom": "17.753", "unused_expert1_count": "0.489", "expert2_balance_top": "31.951", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.835", "ppl": "14.27", "wps": "15282.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6870", "lr": "6.26e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "125739"}
2023-02-02 09:14:11 | INFO | train_inner | {"epoch": 9, "loss": "4.065", "moe_gate_loss": "12.7978", "overflow_expert1": "0.008", "overflow_expert2": "16.53", "entropy_gating": "0.393", "expert1_balance_top": "30.964", "expert1_balance_bottom": "17.721", "unused_expert1_count": "0.487", "expert2_balance_top": "32.001", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.88", "ppl": "14.73", "wps": "15281.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6880", "lr": "6.24e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "125911"}
2023-02-02 09:17:02 | INFO | train_inner | {"epoch": 9, "loss": "4.027", "moe_gate_loss": "12.7935", "overflow_expert1": "0.007", "overflow_expert2": "16.455", "entropy_gating": "0.393", "expert1_balance_top": "30.912", "expert1_balance_bottom": "17.755", "unused_expert1_count": "0.489", "expert2_balance_top": "31.962", "expert2_balance_bottom": "17.227", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.843", "ppl": "14.35", "wps": "15276.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6890", "lr": "6.22e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "126082"}
2023-02-02 09:19:54 | INFO | train_inner | {"epoch": 9, "loss": "4.025", "moe_gate_loss": "12.802", "overflow_expert1": "0.006", "overflow_expert2": "16.714", "entropy_gating": "0.394", "expert1_balance_top": "30.994", "expert1_balance_bottom": "17.688", "unused_expert1_count": "0.484", "expert2_balance_top": "32.086", "expert2_balance_bottom": "17.159", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.84", "ppl": "14.32", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6900", "lr": "6.2e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "126254"}
2023-02-02 09:22:45 | INFO | train_inner | {"epoch": 9, "loss": "4.01", "moe_gate_loss": "12.794", "overflow_expert1": "0.004", "overflow_expert2": "16.614", "entropy_gating": "0.393", "expert1_balance_top": "30.959", "expert1_balance_bottom": "17.743", "unused_expert1_count": "0.485", "expert2_balance_top": "32.016", "expert2_balance_bottom": "17.185", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15283.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6910", "lr": "6.18e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "126425"}
2023-02-02 09:25:37 | INFO | train_inner | {"epoch": 9, "loss": "4.034", "moe_gate_loss": "12.799", "overflow_expert1": "0.005", "overflow_expert2": "16.484", "entropy_gating": "0.392", "expert1_balance_top": "30.979", "expert1_balance_bottom": "17.726", "unused_expert1_count": "0.487", "expert2_balance_top": "31.973", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.849", "ppl": "14.41", "wps": "15278.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6920", "lr": "6.16e-06", "gnorm": "1.218", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "126597"}
2023-02-02 09:28:29 | INFO | train_inner | {"epoch": 9, "loss": "4.007", "moe_gate_loss": "12.7997", "overflow_expert1": "0.008", "overflow_expert2": "16.541", "entropy_gating": "0.392", "expert1_balance_top": "30.966", "expert1_balance_bottom": "17.691", "unused_expert1_count": "0.486", "expert2_balance_top": "31.987", "expert2_balance_bottom": "17.2", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.822", "ppl": "14.15", "wps": "15274.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6930", "lr": "6.14e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "126769"}
2023-02-02 09:31:20 | INFO | train_inner | {"epoch": 9, "loss": "4.006", "moe_gate_loss": "12.8121", "overflow_expert1": "0.008", "overflow_expert2": "16.781", "entropy_gating": "0.392", "expert1_balance_top": "31.06", "expert1_balance_bottom": "17.657", "unused_expert1_count": "0.487", "expert2_balance_top": "32.082", "expert2_balance_bottom": "17.14", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.821", "ppl": "14.13", "wps": "15286", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6940", "lr": "6.12e-06", "gnorm": "1.222", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "126940"}
2023-02-02 09:34:12 | INFO | train_inner | {"epoch": 9, "loss": "4.038", "moe_gate_loss": "12.8053", "overflow_expert1": "0.006", "overflow_expert2": "16.618", "entropy_gating": "0.392", "expert1_balance_top": "31.024", "expert1_balance_bottom": "17.674", "unused_expert1_count": "0.486", "expert2_balance_top": "32.042", "expert2_balance_bottom": "17.189", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15285.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6950", "lr": "6.1e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "127112"}
2023-02-02 09:37:03 | INFO | train_inner | {"epoch": 9, "loss": "4.027", "moe_gate_loss": "12.7953", "overflow_expert1": "0.009", "overflow_expert2": "16.509", "entropy_gating": "0.393", "expert1_balance_top": "30.93", "expert1_balance_bottom": "17.746", "unused_expert1_count": "0.486", "expert2_balance_top": "32.004", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15283.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6960", "lr": "6.08e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "127283"}
2023-02-02 09:39:55 | INFO | train_inner | {"epoch": 9, "loss": "4.031", "moe_gate_loss": "12.7917", "overflow_expert1": "0.005", "overflow_expert2": "16.398", "entropy_gating": "0.393", "expert1_balance_top": "30.926", "expert1_balance_bottom": "17.756", "unused_expert1_count": "0.486", "expert2_balance_top": "31.944", "expert2_balance_bottom": "17.267", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15283.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6970", "lr": "6.06e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "127455"}
2023-02-02 09:42:46 | INFO | train_inner | {"epoch": 9, "loss": "4.107", "moe_gate_loss": "12.8051", "overflow_expert1": "0.005", "overflow_expert2": "16.721", "entropy_gating": "0.393", "expert1_balance_top": "31.03", "expert1_balance_bottom": "17.674", "unused_expert1_count": "0.483", "expert2_balance_top": "32.09", "expert2_balance_bottom": "17.163", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.922", "ppl": "15.16", "wps": "15274.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6980", "lr": "6.04e-06", "gnorm": "1.228", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "127626"}
2023-02-02 09:45:38 | INFO | train_inner | {"epoch": 9, "loss": "4.05", "moe_gate_loss": "12.7871", "overflow_expert1": "0.002", "overflow_expert2": "16.484", "entropy_gating": "0.392", "expert1_balance_top": "30.902", "expert1_balance_bottom": "17.756", "unused_expert1_count": "0.485", "expert2_balance_top": "31.968", "expert2_balance_bottom": "17.196", "unused_expert2_count": "0.436", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.866", "ppl": "14.58", "wps": "15284.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "6990", "lr": "6.02e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "127798"}
2023-02-02 09:48:29 | INFO | train_inner | {"epoch": 9, "loss": "3.995", "moe_gate_loss": "12.7976", "overflow_expert1": "0.006", "overflow_expert2": "16.534", "entropy_gating": "0.392", "expert1_balance_top": "30.964", "expert1_balance_bottom": "17.734", "unused_expert1_count": "0.484", "expert2_balance_top": "32.045", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.81", "ppl": "14.03", "wps": "15272.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7000", "lr": "6e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "127969"}
2023-02-02 09:50:19 | INFO | valid_c4_small/C4_small | {"epoch": 9, "valid_c4_small/C4_small_loss": "4.213", "valid_c4_small/C4_small_moe_gate_loss": "12.5065", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.904", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.984", "valid_c4_small/C4_small_expert1_balance_bottom": "18.907", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.48", "valid_c4_small/C4_small_expert2_balance_bottom": "18.24", "valid_c4_small/C4_small_unused_expert2_count": "0.377", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.032", "valid_c4_small/C4_small_ppl": "16.36", "valid_c4_small/C4_small_wps": "52033.9", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "7000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 09:50:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 7000 updates
2023-02-02 09:50:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 9 @ 7000 updates, score 4.213) (writing took 7.532360018230975 seconds)
2023-02-02 09:53:19 | INFO | train_inner | {"epoch": 9, "loss": "4.033", "moe_gate_loss": "12.807", "overflow_expert1": "0.005", "overflow_expert2": "16.718", "entropy_gating": "0.393", "expert1_balance_top": "31.014", "expert1_balance_bottom": "17.685", "unused_expert1_count": "0.486", "expert2_balance_top": "32.089", "expert2_balance_bottom": "17.167", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.848", "ppl": "14.4", "wps": "9059.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "7010", "lr": "5.98e-06", "gnorm": "1.218", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "128259"}
2023-02-02 09:56:10 | INFO | train_inner | {"epoch": 9, "loss": "4.029", "moe_gate_loss": "12.7954", "overflow_expert1": "0.005", "overflow_expert2": "16.509", "entropy_gating": "0.393", "expert1_balance_top": "30.952", "expert1_balance_bottom": "17.729", "unused_expert1_count": "0.489", "expert2_balance_top": "32", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7020", "lr": "5.96e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "128430"}
2023-02-02 09:59:19 | INFO | train_inner | {"epoch": 9, "loss": "4.026", "moe_gate_loss": "12.7914", "overflow_expert1": "0.004", "overflow_expert2": "16.592", "entropy_gating": "0.394", "expert1_balance_top": "30.926", "expert1_balance_bottom": "17.777", "unused_expert1_count": "0.487", "expert2_balance_top": "32.05", "expert2_balance_bottom": "17.204", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "13899.2", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "7030", "lr": "5.94e-06", "gnorm": "1.225", "clip": "100", "loss_scale": "1", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "128619"}
2023-02-02 10:02:10 | INFO | train_inner | {"epoch": 9, "loss": "3.983", "moe_gate_loss": "12.8122", "overflow_expert1": "0.01", "overflow_expert2": "16.785", "entropy_gating": "0.392", "expert1_balance_top": "31.045", "expert1_balance_bottom": "17.64", "unused_expert1_count": "0.488", "expert2_balance_top": "32.145", "expert2_balance_bottom": "17.131", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.798", "ppl": "13.91", "wps": "15292.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7040", "lr": "5.92e-06", "gnorm": "1.218", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "128790"}
2023-02-02 10:05:02 | INFO | train_inner | {"epoch": 9, "loss": "4.025", "moe_gate_loss": "12.7932", "overflow_expert1": "0.005", "overflow_expert2": "16.515", "entropy_gating": "0.392", "expert1_balance_top": "30.939", "expert1_balance_bottom": "17.768", "unused_expert1_count": "0.485", "expert2_balance_top": "32.016", "expert2_balance_bottom": "17.201", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.84", "ppl": "14.32", "wps": "15289.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7050", "lr": "5.9e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "128962"}
2023-02-02 10:07:53 | INFO | train_inner | {"epoch": 9, "loss": "4.042", "moe_gate_loss": "12.7952", "overflow_expert1": "0.004", "overflow_expert2": "16.503", "entropy_gating": "0.392", "expert1_balance_top": "30.948", "expert1_balance_bottom": "17.751", "unused_expert1_count": "0.486", "expert2_balance_top": "31.973", "expert2_balance_bottom": "17.239", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15279.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7060", "lr": "5.88e-06", "gnorm": "1.218", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "129133"}
2023-02-02 10:10:45 | INFO | train_inner | {"epoch": 9, "loss": "3.996", "moe_gate_loss": "12.7996", "overflow_expert1": "0.008", "overflow_expert2": "16.543", "entropy_gating": "0.392", "expert1_balance_top": "30.989", "expert1_balance_bottom": "17.739", "unused_expert1_count": "0.489", "expert2_balance_top": "32.058", "expert2_balance_bottom": "17.231", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.811", "ppl": "14.04", "wps": "15280.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7070", "lr": "5.86e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "129305"}
2023-02-02 10:13:36 | INFO | train_inner | {"epoch": 9, "loss": "4.01", "moe_gate_loss": "12.7942", "overflow_expert1": "0.006", "overflow_expert2": "16.507", "entropy_gating": "0.393", "expert1_balance_top": "30.95", "expert1_balance_bottom": "17.769", "unused_expert1_count": "0.487", "expert2_balance_top": "32.013", "expert2_balance_bottom": "17.225", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.825", "ppl": "14.17", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7080", "lr": "5.84e-06", "gnorm": "1.219", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "129476"}
2023-02-02 10:16:28 | INFO | train_inner | {"epoch": 9, "loss": "3.989", "moe_gate_loss": "12.8037", "overflow_expert1": "0.004", "overflow_expert2": "16.529", "entropy_gating": "0.392", "expert1_balance_top": "31.005", "expert1_balance_bottom": "17.699", "unused_expert1_count": "0.487", "expert2_balance_top": "31.997", "expert2_balance_bottom": "17.24", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.804", "ppl": "13.97", "wps": "15287.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7090", "lr": "5.82e-06", "gnorm": "1.199", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "129648"}
2023-02-02 10:19:20 | INFO | train_inner | {"epoch": 9, "loss": "3.981", "moe_gate_loss": "12.7964", "overflow_expert1": "0.005", "overflow_expert2": "16.55", "entropy_gating": "0.392", "expert1_balance_top": "30.981", "expert1_balance_bottom": "17.722", "unused_expert1_count": "0.485", "expert2_balance_top": "32.031", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.797", "ppl": "13.9", "wps": "15275.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7100", "lr": "5.8e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "129819"}
2023-02-02 10:22:11 | INFO | train_inner | {"epoch": 9, "loss": "3.967", "moe_gate_loss": "12.7934", "overflow_expert1": "0.008", "overflow_expert2": "16.531", "entropy_gating": "0.392", "expert1_balance_top": "30.911", "expert1_balance_bottom": "17.753", "unused_expert1_count": "0.484", "expert2_balance_top": "31.984", "expert2_balance_bottom": "17.224", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.782", "ppl": "13.76", "wps": "15285", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7110", "lr": "5.78e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "129991"}
2023-02-02 10:25:03 | INFO | train_inner | {"epoch": 9, "loss": "4.025", "moe_gate_loss": "12.8003", "overflow_expert1": "0.006", "overflow_expert2": "16.595", "entropy_gating": "0.393", "expert1_balance_top": "30.956", "expert1_balance_bottom": "17.711", "unused_expert1_count": "0.488", "expert2_balance_top": "32.02", "expert2_balance_bottom": "17.184", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.841", "ppl": "14.33", "wps": "15280.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7120", "lr": "5.76e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "130163"}
2023-02-02 10:27:54 | INFO | train_inner | {"epoch": 9, "loss": "4.031", "moe_gate_loss": "12.7901", "overflow_expert1": "0.006", "overflow_expert2": "16.423", "entropy_gating": "0.392", "expert1_balance_top": "30.913", "expert1_balance_bottom": "17.755", "unused_expert1_count": "0.489", "expert2_balance_top": "31.958", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15284.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7130", "lr": "5.74e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "130334"}
2023-02-02 10:30:46 | INFO | train_inner | {"epoch": 9, "loss": "4.041", "moe_gate_loss": "12.7827", "overflow_expert1": "0.004", "overflow_expert2": "16.413", "entropy_gating": "0.393", "expert1_balance_top": "30.861", "expert1_balance_bottom": "17.822", "unused_expert1_count": "0.485", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.252", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.856", "ppl": "14.48", "wps": "15284.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7140", "lr": "5.72e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "130506"}
2023-02-02 10:33:37 | INFO | train_inner | {"epoch": 9, "loss": "4.045", "moe_gate_loss": "12.7888", "overflow_expert1": "0.008", "overflow_expert2": "16.456", "entropy_gating": "0.392", "expert1_balance_top": "30.903", "expert1_balance_bottom": "17.793", "unused_expert1_count": "0.488", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.861", "ppl": "14.53", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7150", "lr": "5.7e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "130677"}
2023-02-02 10:36:29 | INFO | train_inner | {"epoch": 9, "loss": "4.026", "moe_gate_loss": "12.7916", "overflow_expert1": "0.005", "overflow_expert2": "16.444", "entropy_gating": "0.392", "expert1_balance_top": "30.923", "expert1_balance_bottom": "17.763", "unused_expert1_count": "0.49", "expert2_balance_top": "32.003", "expert2_balance_bottom": "17.243", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7160", "lr": "5.68e-06", "gnorm": "1.218", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "130848"}
2023-02-02 10:39:20 | INFO | train_inner | {"epoch": 9, "loss": "4.078", "moe_gate_loss": "12.7908", "overflow_expert1": "0.004", "overflow_expert2": "16.468", "entropy_gating": "0.393", "expert1_balance_top": "30.915", "expert1_balance_bottom": "17.76", "unused_expert1_count": "0.486", "expert2_balance_top": "31.99", "expert2_balance_bottom": "17.253", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.894", "ppl": "14.87", "wps": "15283", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7170", "lr": "5.66e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "131020"}
2023-02-02 10:42:12 | INFO | train_inner | {"epoch": 9, "loss": "4.08", "moe_gate_loss": "12.7749", "overflow_expert1": "0.002", "overflow_expert2": "16.209", "entropy_gating": "0.392", "expert1_balance_top": "30.816", "expert1_balance_bottom": "17.837", "unused_expert1_count": "0.49", "expert2_balance_top": "31.853", "expert2_balance_bottom": "17.293", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.896", "ppl": "14.89", "wps": "15286.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7180", "lr": "5.64e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "131192"}
2023-02-02 10:45:03 | INFO | train_inner | {"epoch": 9, "loss": "4.04", "moe_gate_loss": "12.7802", "overflow_expert1": "0.002", "overflow_expert2": "16.279", "entropy_gating": "0.392", "expert1_balance_top": "30.853", "expert1_balance_bottom": "17.83", "unused_expert1_count": "0.486", "expert2_balance_top": "31.948", "expert2_balance_bottom": "17.281", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.855", "ppl": "14.47", "wps": "15287.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7190", "lr": "5.62e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "131363"}
2023-02-02 10:47:54 | INFO | train_inner | {"epoch": 9, "loss": "4.079", "moe_gate_loss": "12.7841", "overflow_expert1": "0.006", "overflow_expert2": "16.353", "entropy_gating": "0.393", "expert1_balance_top": "30.87", "expert1_balance_bottom": "17.806", "unused_expert1_count": "0.488", "expert2_balance_top": "32.023", "expert2_balance_bottom": "17.242", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.895", "ppl": "14.87", "wps": "15291.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7200", "lr": "5.6e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "131534"}
2023-02-02 10:50:46 | INFO | train_inner | {"epoch": 9, "loss": "4.015", "moe_gate_loss": "12.7938", "overflow_expert1": "0.007", "overflow_expert2": "16.563", "entropy_gating": "0.393", "expert1_balance_top": "30.911", "expert1_balance_bottom": "17.754", "unused_expert1_count": "0.487", "expert2_balance_top": "32.031", "expert2_balance_bottom": "17.198", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.83", "ppl": "14.22", "wps": "15287.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7210", "lr": "5.58e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "131706"}
2023-02-02 10:53:38 | INFO | train_inner | {"epoch": 9, "loss": "4.037", "moe_gate_loss": "12.7846", "overflow_expert1": "0.006", "overflow_expert2": "16.406", "entropy_gating": "0.392", "expert1_balance_top": "30.864", "expert1_balance_bottom": "17.816", "unused_expert1_count": "0.489", "expert2_balance_top": "31.97", "expert2_balance_bottom": "17.259", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15282.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7220", "lr": "5.56e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "131877"}
2023-02-02 10:56:29 | INFO | train_inner | {"epoch": 9, "loss": "4.03", "moe_gate_loss": "12.7905", "overflow_expert1": "0.006", "overflow_expert2": "16.502", "entropy_gating": "0.392", "expert1_balance_top": "30.913", "expert1_balance_bottom": "17.765", "unused_expert1_count": "0.487", "expert2_balance_top": "32.011", "expert2_balance_bottom": "17.21", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7230", "lr": "5.54e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "132049"}
2023-02-02 10:59:21 | INFO | train_inner | {"epoch": 9, "loss": "4.035", "moe_gate_loss": "12.7837", "overflow_expert1": "0.004", "overflow_expert2": "16.438", "entropy_gating": "0.392", "expert1_balance_top": "30.874", "expert1_balance_bottom": "17.805", "unused_expert1_count": "0.488", "expert2_balance_top": "31.971", "expert2_balance_bottom": "17.219", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.851", "ppl": "14.43", "wps": "15280.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7240", "lr": "5.52e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "132221"}
2023-02-02 11:02:12 | INFO | train_inner | {"epoch": 9, "loss": "4.041", "moe_gate_loss": "12.7776", "overflow_expert1": "0.006", "overflow_expert2": "16.33", "entropy_gating": "0.393", "expert1_balance_top": "30.829", "expert1_balance_bottom": "17.858", "unused_expert1_count": "0.488", "expert2_balance_top": "31.955", "expert2_balance_bottom": "17.271", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15282", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7250", "lr": "5.5e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "132392"}
2023-02-02 11:04:02 | INFO | valid_c4_small/C4_small | {"epoch": 9, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.5038", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.724", "valid_c4_small/C4_small_entropy_gating": "0.422", "valid_c4_small/C4_small_expert1_balance_top": "30.944", "valid_c4_small/C4_small_expert1_balance_bottom": "18.953", "valid_c4_small/C4_small_unused_expert1_count": "0.458", "valid_c4_small/C4_small_expert2_balance_top": "31.434", "valid_c4_small/C4_small_expert2_balance_bottom": "18.264", "valid_c4_small/C4_small_unused_expert2_count": "0.386", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.34", "valid_c4_small/C4_small_wps": "51992.9", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "7250", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 11:04:02 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 7250 updates
2023-02-02 11:04:09 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 9 @ 7250 updates, score 4.211) (writing took 7.572475892025977 seconds)
2023-02-02 11:07:02 | INFO | train_inner | {"epoch": 9, "loss": "4.069", "moe_gate_loss": "12.7805", "overflow_expert1": "0.004", "overflow_expert2": "16.291", "entropy_gating": "0.393", "expert1_balance_top": "30.842", "expert1_balance_bottom": "17.827", "unused_expert1_count": "0.489", "expert2_balance_top": "31.965", "expert2_balance_bottom": "17.285", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.885", "ppl": "14.77", "wps": "9052.9", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "7260", "lr": "5.48e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "1", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "132682"}
2023-02-02 11:09:53 | INFO | train_inner | {"epoch": 9, "loss": "4.046", "moe_gate_loss": "12.8124", "overflow_expert1": "0.007", "overflow_expert2": "16.776", "entropy_gating": "0.393", "expert1_balance_top": "31.035", "expert1_balance_bottom": "17.644", "unused_expert1_count": "0.49", "expert2_balance_top": "32.076", "expert2_balance_bottom": "17.149", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.861", "ppl": "14.53", "wps": "15280.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7270", "lr": "5.46e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "132853"}
2023-02-02 11:12:45 | INFO | train_inner | {"epoch": 9, "loss": "4.041", "moe_gate_loss": "12.7871", "overflow_expert1": "0.006", "overflow_expert2": "16.401", "entropy_gating": "0.392", "expert1_balance_top": "30.881", "expert1_balance_bottom": "17.793", "unused_expert1_count": "0.483", "expert2_balance_top": "31.964", "expert2_balance_bottom": "17.264", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.856", "ppl": "14.48", "wps": "15282.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7280", "lr": "5.44e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "133025"}
2023-02-02 11:15:36 | INFO | train_inner | {"epoch": 9, "loss": "4.008", "moe_gate_loss": "12.7975", "overflow_expert1": "0.005", "overflow_expert2": "16.69", "entropy_gating": "0.394", "expert1_balance_top": "30.962", "expert1_balance_bottom": "17.717", "unused_expert1_count": "0.488", "expert2_balance_top": "32.082", "expert2_balance_bottom": "17.153", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15278.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7290", "lr": "5.42e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "133196"}
2023-02-02 11:18:28 | INFO | train_inner | {"epoch": 9, "loss": "4.053", "moe_gate_loss": "12.7966", "overflow_expert1": "0.004", "overflow_expert2": "16.605", "entropy_gating": "0.394", "expert1_balance_top": "30.965", "expert1_balance_bottom": "17.734", "unused_expert1_count": "0.486", "expert2_balance_top": "32.052", "expert2_balance_bottom": "17.18", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.869", "ppl": "14.61", "wps": "15279.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7300", "lr": "5.4e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "133368"}
2023-02-02 11:21:19 | INFO | train_inner | {"epoch": 9, "loss": "4.032", "moe_gate_loss": "12.802", "overflow_expert1": "0.006", "overflow_expert2": "16.566", "entropy_gating": "0.392", "expert1_balance_top": "31.006", "expert1_balance_bottom": "17.715", "unused_expert1_count": "0.488", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.198", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.847", "ppl": "14.39", "wps": "15283", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7310", "lr": "5.38e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "133539"}
2023-02-02 11:24:11 | INFO | train_inner | {"epoch": 9, "loss": "4.036", "moe_gate_loss": "12.7827", "overflow_expert1": "0.006", "overflow_expert2": "16.334", "entropy_gating": "0.393", "expert1_balance_top": "30.844", "expert1_balance_bottom": "17.832", "unused_expert1_count": "0.487", "expert2_balance_top": "31.93", "expert2_balance_bottom": "17.272", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.851", "ppl": "14.43", "wps": "15288.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7320", "lr": "5.36e-06", "gnorm": "1.191", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "133711"}
2023-02-02 11:27:02 | INFO | train_inner | {"epoch": 9, "loss": "4.071", "moe_gate_loss": "12.7778", "overflow_expert1": "0.004", "overflow_expert2": "16.25", "entropy_gating": "0.392", "expert1_balance_top": "30.843", "expert1_balance_bottom": "17.847", "unused_expert1_count": "0.488", "expert2_balance_top": "31.909", "expert2_balance_bottom": "17.297", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.887", "ppl": "14.8", "wps": "15283.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7330", "lr": "5.34e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "133882"}
2023-02-02 11:29:54 | INFO | train_inner | {"epoch": 9, "loss": "4.038", "moe_gate_loss": "12.78", "overflow_expert1": "0.006", "overflow_expert2": "16.277", "entropy_gating": "0.392", "expert1_balance_top": "30.828", "expert1_balance_bottom": "17.838", "unused_expert1_count": "0.485", "expert2_balance_top": "31.904", "expert2_balance_bottom": "17.278", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15284.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7340", "lr": "5.32e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "134054"}
2023-02-02 11:32:43 | INFO | valid_c4_small/C4_small | {"epoch": 9, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.4937", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.737", "valid_c4_small/C4_small_entropy_gating": "0.422", "valid_c4_small/C4_small_expert1_balance_top": "30.835", "valid_c4_small/C4_small_expert1_balance_bottom": "18.982", "valid_c4_small/C4_small_unused_expert1_count": "0.456", "valid_c4_small/C4_small_expert2_balance_top": "31.403", "valid_c4_small/C4_small_expert2_balance_bottom": "18.241", "valid_c4_small/C4_small_unused_expert2_count": "0.384", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.33", "valid_c4_small/C4_small_wps": "51973.6", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "7343", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 11:32:43 | INFO | fairseq_cli.train | end of epoch 9 (average epoch stats below)
2023-02-02 11:32:43 | INFO | train | {"epoch": 9, "train_loss": "4.027", "train_moe_gate_loss": "12.7949", "train_overflow_expert1": "0.005", "train_overflow_expert2": "16.557", "train_entropy_gating": "0.393", "train_expert1_balance_top": "30.946", "train_expert1_balance_bottom": "17.732", "train_unused_expert1_count": "0.486", "train_expert2_balance_top": "32.016", "train_expert2_balance_bottom": "17.198", "train_unused_expert2_count": "0.447", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.842", "train_ppl": "14.34", "train_wps": "14768.9", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "7343", "train_lr": "5.314e-06", "train_gnorm": "1.209", "train_clip": "100", "train_loss_scale": "1", "train_train_wall": "13577", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "134223"}
2023-02-02 11:32:43 | INFO | fairseq.trainer | begin training epoch 10
2023-02-02 11:34:43 | INFO | train_inner | {"epoch": 10, "loss": "4.055", "moe_gate_loss": "12.7786", "overflow_expert1": "0.006", "overflow_expert2": "16.308", "entropy_gating": "0.393", "expert1_balance_top": "30.826", "expert1_balance_bottom": "17.85", "unused_expert1_count": "0.489", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.27", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.871", "ppl": "14.63", "wps": "9064.9", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "7350", "lr": "5.3e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "1", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "134343"}
2023-02-02 11:37:35 | INFO | train_inner | {"epoch": 10, "loss": "4.058", "moe_gate_loss": "12.7856", "overflow_expert1": "0.007", "overflow_expert2": "16.545", "entropy_gating": "0.394", "expert1_balance_top": "30.867", "expert1_balance_bottom": "17.809", "unused_expert1_count": "0.486", "expert2_balance_top": "32.056", "expert2_balance_bottom": "17.2", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.873", "ppl": "14.65", "wps": "15278.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7360", "lr": "5.28e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "134515"}
2023-02-02 11:40:26 | INFO | train_inner | {"epoch": 10, "loss": "3.992", "moe_gate_loss": "12.789", "overflow_expert1": "0.006", "overflow_expert2": "16.923", "entropy_gating": "0.395", "expert1_balance_top": "30.892", "expert1_balance_bottom": "17.718", "unused_expert1_count": "0.488", "expert2_balance_top": "32.212", "expert2_balance_bottom": "17.026", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.808", "ppl": "14", "wps": "15279.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7370", "lr": "5.26e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "134686"}
2023-02-02 11:43:18 | INFO | train_inner | {"epoch": 10, "loss": "4.001", "moe_gate_loss": "12.7937", "overflow_expert1": "0.005", "overflow_expert2": "16.895", "entropy_gating": "0.393", "expert1_balance_top": "30.928", "expert1_balance_bottom": "17.672", "unused_expert1_count": "0.49", "expert2_balance_top": "32.2", "expert2_balance_bottom": "17.006", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.817", "ppl": "14.09", "wps": "15275.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7380", "lr": "5.24e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "134858"}
2023-02-02 11:46:10 | INFO | train_inner | {"epoch": 10, "loss": "3.984", "moe_gate_loss": "12.7973", "overflow_expert1": "0.004", "overflow_expert2": "16.831", "entropy_gating": "0.392", "expert1_balance_top": "30.991", "expert1_balance_bottom": "17.651", "unused_expert1_count": "0.488", "expert2_balance_top": "32.086", "expert2_balance_bottom": "17.058", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.799", "ppl": "13.92", "wps": "15275.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7390", "lr": "5.22e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "135029"}
2023-02-02 11:49:01 | INFO | train_inner | {"epoch": 10, "loss": "3.965", "moe_gate_loss": "12.7961", "overflow_expert1": "0.005", "overflow_expert2": "16.874", "entropy_gating": "0.393", "expert1_balance_top": "30.966", "expert1_balance_bottom": "17.666", "unused_expert1_count": "0.483", "expert2_balance_top": "32.11", "expert2_balance_bottom": "17.033", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.78", "ppl": "13.74", "wps": "15285.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7400", "lr": "5.2e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "135201"}
2023-02-02 11:51:52 | INFO | train_inner | {"epoch": 10, "loss": "3.954", "moe_gate_loss": "12.788", "overflow_expert1": "0.004", "overflow_expert2": "16.52", "entropy_gating": "0.392", "expert1_balance_top": "30.916", "expert1_balance_bottom": "17.726", "unused_expert1_count": "0.489", "expert2_balance_top": "32.005", "expert2_balance_bottom": "17.168", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.77", "ppl": "13.64", "wps": "15291.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7410", "lr": "5.18e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "135372"}
2023-02-02 11:54:44 | INFO | train_inner | {"epoch": 10, "loss": "4.031", "moe_gate_loss": "12.7946", "overflow_expert1": "0.003", "overflow_expert2": "16.531", "entropy_gating": "0.392", "expert1_balance_top": "30.936", "expert1_balance_bottom": "17.709", "unused_expert1_count": "0.485", "expert2_balance_top": "32.045", "expert2_balance_bottom": "17.167", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15275.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7420", "lr": "5.16e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "135544"}
2023-02-02 11:57:35 | INFO | train_inner | {"epoch": 10, "loss": "4.003", "moe_gate_loss": "12.7883", "overflow_expert1": "0.004", "overflow_expert2": "16.555", "entropy_gating": "0.393", "expert1_balance_top": "30.902", "expert1_balance_bottom": "17.73", "unused_expert1_count": "0.488", "expert2_balance_top": "32.022", "expert2_balance_bottom": "17.172", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.818", "ppl": "14.11", "wps": "15291.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7430", "lr": "5.14e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "135715"}
2023-02-02 12:00:27 | INFO | train_inner | {"epoch": 10, "loss": "4.007", "moe_gate_loss": "12.7847", "overflow_expert1": "0.003", "overflow_expert2": "16.528", "entropy_gating": "0.393", "expert1_balance_top": "30.875", "expert1_balance_bottom": "17.754", "unused_expert1_count": "0.487", "expert2_balance_top": "32.01", "expert2_balance_bottom": "17.152", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.822", "ppl": "14.14", "wps": "15283.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7440", "lr": "5.12e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "135887"}
2023-02-02 12:03:19 | INFO | train_inner | {"epoch": 10, "loss": "3.979", "moe_gate_loss": "12.7912", "overflow_expert1": "0.004", "overflow_expert2": "16.587", "entropy_gating": "0.392", "expert1_balance_top": "30.924", "expert1_balance_bottom": "17.732", "unused_expert1_count": "0.485", "expert2_balance_top": "32.027", "expert2_balance_bottom": "17.148", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.794", "ppl": "13.87", "wps": "15276.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7450", "lr": "5.1e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "136059"}
2023-02-02 12:06:10 | INFO | train_inner | {"epoch": 10, "loss": "4.013", "moe_gate_loss": "12.7947", "overflow_expert1": "0.006", "overflow_expert2": "16.528", "entropy_gating": "0.392", "expert1_balance_top": "30.934", "expert1_balance_bottom": "17.714", "unused_expert1_count": "0.486", "expert2_balance_top": "32.005", "expert2_balance_bottom": "17.16", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.829", "ppl": "14.21", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7460", "lr": "5.08e-06", "gnorm": "1.229", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "136230"}
2023-02-02 12:09:02 | INFO | train_inner | {"epoch": 10, "loss": "4.002", "moe_gate_loss": "12.7871", "overflow_expert1": "0.003", "overflow_expert2": "16.517", "entropy_gating": "0.393", "expert1_balance_top": "30.897", "expert1_balance_bottom": "17.755", "unused_expert1_count": "0.483", "expert2_balance_top": "31.961", "expert2_balance_bottom": "17.177", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.817", "ppl": "14.1", "wps": "15292.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7470", "lr": "5.06e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "136401"}
2023-02-02 12:11:53 | INFO | train_inner | {"epoch": 10, "loss": "3.986", "moe_gate_loss": "12.8019", "overflow_expert1": "0.005", "overflow_expert2": "16.672", "entropy_gating": "0.393", "expert1_balance_top": "31.004", "expert1_balance_bottom": "17.67", "unused_expert1_count": "0.488", "expert2_balance_top": "32.04", "expert2_balance_bottom": "17.146", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.801", "ppl": "13.94", "wps": "15285", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7480", "lr": "5.04e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "136573"}
2023-02-02 12:14:45 | INFO | train_inner | {"epoch": 10, "loss": "4.042", "moe_gate_loss": "12.7908", "overflow_expert1": "0.007", "overflow_expert2": "16.474", "entropy_gating": "0.393", "expert1_balance_top": "30.9", "expert1_balance_bottom": "17.744", "unused_expert1_count": "0.485", "expert2_balance_top": "31.999", "expert2_balance_bottom": "17.208", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.858", "ppl": "14.5", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7490", "lr": "5.02e-06", "gnorm": "1.22", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "136744"}
2023-02-02 12:17:36 | INFO | train_inner | {"epoch": 10, "loss": "4.015", "moe_gate_loss": "12.7887", "overflow_expert1": "0.005", "overflow_expert2": "16.446", "entropy_gating": "0.392", "expert1_balance_top": "30.901", "expert1_balance_bottom": "17.758", "unused_expert1_count": "0.485", "expert2_balance_top": "31.95", "expert2_balance_bottom": "17.209", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.831", "ppl": "14.23", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7500", "lr": "5e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "136916"}
2023-02-02 12:19:26 | INFO | valid_c4_small/C4_small | {"epoch": 10, "valid_c4_small/C4_small_loss": "4.214", "valid_c4_small/C4_small_moe_gate_loss": "12.4925", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.861", "valid_c4_small/C4_small_entropy_gating": "0.422", "valid_c4_small/C4_small_expert1_balance_top": "30.806", "valid_c4_small/C4_small_expert1_balance_bottom": "19.006", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.45", "valid_c4_small/C4_small_expert2_balance_bottom": "18.159", "valid_c4_small/C4_small_unused_expert2_count": "0.381", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.034", "valid_c4_small/C4_small_ppl": "16.38", "valid_c4_small/C4_small_wps": "51963", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "7500", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 12:19:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 7500 updates
2023-02-02 12:19:33 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 10 @ 7500 updates, score 4.214) (writing took 7.195588703267276 seconds)
2023-02-02 12:22:26 | INFO | train_inner | {"epoch": 10, "loss": "4.015", "moe_gate_loss": "12.7989", "overflow_expert1": "0.006", "overflow_expert2": "16.584", "entropy_gating": "0.392", "expert1_balance_top": "30.968", "expert1_balance_bottom": "17.699", "unused_expert1_count": "0.491", "expert2_balance_top": "31.976", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.83", "ppl": "14.22", "wps": "9054.4", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "7510", "lr": "4.98e-06", "gnorm": "1.235", "clip": "100", "loss_scale": "1", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "137205"}
2023-02-02 12:25:17 | INFO | train_inner | {"epoch": 10, "loss": "4.055", "moe_gate_loss": "12.8146", "overflow_expert1": "0.006", "overflow_expert2": "16.906", "entropy_gating": "0.393", "expert1_balance_top": "31.067", "expert1_balance_bottom": "17.615", "unused_expert1_count": "0.487", "expert2_balance_top": "32.138", "expert2_balance_bottom": "17.083", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.87", "ppl": "14.62", "wps": "15280.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7520", "lr": "4.96e-06", "gnorm": "1.248", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "137377"}
2023-02-02 12:28:09 | INFO | train_inner | {"epoch": 10, "loss": "4.022", "moe_gate_loss": "12.7953", "overflow_expert1": "0.005", "overflow_expert2": "16.552", "entropy_gating": "0.393", "expert1_balance_top": "30.937", "expert1_balance_bottom": "17.739", "unused_expert1_count": "0.49", "expert2_balance_top": "32.012", "expert2_balance_bottom": "17.217", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.837", "ppl": "14.29", "wps": "15273.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7530", "lr": "4.94e-06", "gnorm": "1.226", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "137549"}
2023-02-02 12:31:00 | INFO | train_inner | {"epoch": 10, "loss": "4.01", "moe_gate_loss": "12.7841", "overflow_expert1": "0.002", "overflow_expert2": "16.313", "entropy_gating": "0.393", "expert1_balance_top": "30.88", "expert1_balance_bottom": "17.786", "unused_expert1_count": "0.49", "expert2_balance_top": "31.937", "expert2_balance_bottom": "17.286", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7540", "lr": "4.92e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "137720"}
2023-02-02 12:33:52 | INFO | train_inner | {"epoch": 10, "loss": "3.959", "moe_gate_loss": "12.8039", "overflow_expert1": "0.004", "overflow_expert2": "16.599", "entropy_gating": "0.392", "expert1_balance_top": "31.008", "expert1_balance_bottom": "17.672", "unused_expert1_count": "0.49", "expert2_balance_top": "32.054", "expert2_balance_bottom": "17.195", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.775", "ppl": "13.69", "wps": "15293.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7550", "lr": "4.9e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "137891"}
2023-02-02 12:36:43 | INFO | train_inner | {"epoch": 10, "loss": "4.041", "moe_gate_loss": "12.8025", "overflow_expert1": "0.007", "overflow_expert2": "16.565", "entropy_gating": "0.392", "expert1_balance_top": "30.97", "expert1_balance_bottom": "17.698", "unused_expert1_count": "0.486", "expert2_balance_top": "32.031", "expert2_balance_bottom": "17.195", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15281.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7560", "lr": "4.88e-06", "gnorm": "1.226", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "138063"}
2023-02-02 12:39:35 | INFO | train_inner | {"epoch": 10, "loss": "4.013", "moe_gate_loss": "12.7857", "overflow_expert1": "0.005", "overflow_expert2": "16.348", "entropy_gating": "0.392", "expert1_balance_top": "30.862", "expert1_balance_bottom": "17.797", "unused_expert1_count": "0.487", "expert2_balance_top": "31.911", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.829", "ppl": "14.21", "wps": "15274.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7570", "lr": "4.86e-06", "gnorm": "1.22", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "138235"}
2023-02-02 12:42:26 | INFO | train_inner | {"epoch": 10, "loss": "4.013", "moe_gate_loss": "12.7819", "overflow_expert1": "0.003", "overflow_expert2": "16.311", "entropy_gating": "0.393", "expert1_balance_top": "30.837", "expert1_balance_bottom": "17.807", "unused_expert1_count": "0.49", "expert2_balance_top": "31.929", "expert2_balance_bottom": "17.269", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.828", "ppl": "14.21", "wps": "15276.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7580", "lr": "4.84e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "138406"}
2023-02-02 12:45:18 | INFO | train_inner | {"epoch": 10, "loss": "4", "moe_gate_loss": "12.8097", "overflow_expert1": "0.005", "overflow_expert2": "16.649", "entropy_gating": "0.392", "expert1_balance_top": "31.038", "expert1_balance_bottom": "17.654", "unused_expert1_count": "0.488", "expert2_balance_top": "32.063", "expert2_balance_bottom": "17.185", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.815", "ppl": "14.07", "wps": "15281.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7590", "lr": "4.82e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "138578"}
2023-02-02 12:48:09 | INFO | train_inner | {"epoch": 10, "loss": "4.007", "moe_gate_loss": "12.7876", "overflow_expert1": "0.007", "overflow_expert2": "16.481", "entropy_gating": "0.393", "expert1_balance_top": "30.866", "expert1_balance_bottom": "17.778", "unused_expert1_count": "0.486", "expert2_balance_top": "32.039", "expert2_balance_bottom": "17.219", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.15", "wps": "15274.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7600", "lr": "4.8e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "138749"}
2023-02-02 12:51:01 | INFO | train_inner | {"epoch": 10, "loss": "4.032", "moe_gate_loss": "12.7877", "overflow_expert1": "0.003", "overflow_expert2": "16.469", "entropy_gating": "0.392", "expert1_balance_top": "30.885", "expert1_balance_bottom": "17.779", "unused_expert1_count": "0.49", "expert2_balance_top": "31.987", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.847", "ppl": "14.39", "wps": "15278.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7610", "lr": "4.78e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "138921"}
2023-02-02 12:53:53 | INFO | train_inner | {"epoch": 10, "loss": "4.022", "moe_gate_loss": "12.7842", "overflow_expert1": "0.003", "overflow_expert2": "16.419", "entropy_gating": "0.392", "expert1_balance_top": "30.864", "expert1_balance_bottom": "17.79", "unused_expert1_count": "0.486", "expert2_balance_top": "31.959", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.837", "ppl": "14.29", "wps": "15280.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7620", "lr": "4.76e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "139092"}
2023-02-02 12:56:44 | INFO | train_inner | {"epoch": 10, "loss": "3.963", "moe_gate_loss": "12.7988", "overflow_expert1": "0.006", "overflow_expert2": "16.554", "entropy_gating": "0.392", "expert1_balance_top": "30.971", "expert1_balance_bottom": "17.723", "unused_expert1_count": "0.484", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.214", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.779", "ppl": "13.72", "wps": "15279.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7630", "lr": "4.74e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "139264"}
2023-02-02 12:59:36 | INFO | train_inner | {"epoch": 10, "loss": "4.044", "moe_gate_loss": "12.7899", "overflow_expert1": "0.005", "overflow_expert2": "16.511", "entropy_gating": "0.393", "expert1_balance_top": "30.893", "expert1_balance_bottom": "17.767", "unused_expert1_count": "0.489", "expert2_balance_top": "32.024", "expert2_balance_bottom": "17.2", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.859", "ppl": "14.51", "wps": "15276.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7640", "lr": "4.72e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "139436"}
2023-02-02 13:02:27 | INFO | train_inner | {"epoch": 10, "loss": "4.045", "moe_gate_loss": "12.7966", "overflow_expert1": "0.004", "overflow_expert2": "16.481", "entropy_gating": "0.392", "expert1_balance_top": "30.939", "expert1_balance_bottom": "17.753", "unused_expert1_count": "0.485", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.238", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "15273.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7650", "lr": "4.7e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "139607"}
2023-02-02 13:05:19 | INFO | train_inner | {"epoch": 10, "loss": "4.038", "moe_gate_loss": "12.7918", "overflow_expert1": "0.005", "overflow_expert2": "16.412", "entropy_gating": "0.392", "expert1_balance_top": "30.926", "expert1_balance_bottom": "17.744", "unused_expert1_count": "0.489", "expert2_balance_top": "31.965", "expert2_balance_bottom": "17.273", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15279.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7660", "lr": "4.68e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "139779"}
2023-02-02 13:08:10 | INFO | train_inner | {"epoch": 10, "loss": "3.964", "moe_gate_loss": "12.803", "overflow_expert1": "0.007", "overflow_expert2": "16.542", "entropy_gating": "0.392", "expert1_balance_top": "30.996", "expert1_balance_bottom": "17.698", "unused_expert1_count": "0.488", "expert2_balance_top": "32.007", "expert2_balance_bottom": "17.244", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.779", "ppl": "13.73", "wps": "15281.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7670", "lr": "4.66e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "139950"}
2023-02-02 13:11:02 | INFO | train_inner | {"epoch": 10, "loss": "4.03", "moe_gate_loss": "12.787", "overflow_expert1": "0.005", "overflow_expert2": "16.442", "entropy_gating": "0.392", "expert1_balance_top": "30.877", "expert1_balance_bottom": "17.79", "unused_expert1_count": "0.49", "expert2_balance_top": "31.965", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.845", "ppl": "14.37", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7680", "lr": "4.64e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "140122"}
2023-02-02 13:13:53 | INFO | train_inner | {"epoch": 10, "loss": "4.007", "moe_gate_loss": "12.7843", "overflow_expert1": "0.004", "overflow_expert2": "16.431", "entropy_gating": "0.392", "expert1_balance_top": "30.872", "expert1_balance_bottom": "17.804", "unused_expert1_count": "0.487", "expert2_balance_top": "31.949", "expert2_balance_bottom": "17.234", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.15", "wps": "15294.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7690", "lr": "4.62e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "140293"}
2023-02-02 13:16:45 | INFO | train_inner | {"epoch": 10, "loss": "4.073", "moe_gate_loss": "12.7978", "overflow_expert1": "0.009", "overflow_expert2": "16.449", "entropy_gating": "0.393", "expert1_balance_top": "30.949", "expert1_balance_bottom": "17.737", "unused_expert1_count": "0.487", "expert2_balance_top": "31.985", "expert2_balance_bottom": "17.227", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.888", "ppl": "14.8", "wps": "15286.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7700", "lr": "4.6e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "140465"}
2023-02-02 13:19:36 | INFO | train_inner | {"epoch": 10, "loss": "3.994", "moe_gate_loss": "12.7874", "overflow_expert1": "0.006", "overflow_expert2": "16.418", "entropy_gating": "0.392", "expert1_balance_top": "30.875", "expert1_balance_bottom": "17.779", "unused_expert1_count": "0.486", "expert2_balance_top": "31.955", "expert2_balance_bottom": "17.235", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.809", "ppl": "14.02", "wps": "15291.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7710", "lr": "4.58e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "140636"}
2023-02-02 13:22:28 | INFO | train_inner | {"epoch": 10, "loss": "4.01", "moe_gate_loss": "12.8013", "overflow_expert1": "0.006", "overflow_expert2": "16.632", "entropy_gating": "0.393", "expert1_balance_top": "30.986", "expert1_balance_bottom": "17.713", "unused_expert1_count": "0.485", "expert2_balance_top": "32.025", "expert2_balance_bottom": "17.189", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15288.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7720", "lr": "4.56e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "140808"}
2023-02-02 13:25:19 | INFO | train_inner | {"epoch": 10, "loss": "4.01", "moe_gate_loss": "12.7839", "overflow_expert1": "0.003", "overflow_expert2": "16.427", "entropy_gating": "0.393", "expert1_balance_top": "30.863", "expert1_balance_bottom": "17.801", "unused_expert1_count": "0.49", "expert2_balance_top": "31.952", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.825", "ppl": "14.17", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7730", "lr": "4.54e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "140979"}
2023-02-02 13:28:11 | INFO | train_inner | {"epoch": 10, "loss": "4.011", "moe_gate_loss": "12.7965", "overflow_expert1": "0.007", "overflow_expert2": "16.407", "entropy_gating": "0.392", "expert1_balance_top": "30.946", "expert1_balance_bottom": "17.744", "unused_expert1_count": "0.487", "expert2_balance_top": "31.956", "expert2_balance_bottom": "17.247", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15282.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7740", "lr": "4.52e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "141151"}
2023-02-02 13:31:02 | INFO | train_inner | {"epoch": 10, "loss": "4.01", "moe_gate_loss": "12.7966", "overflow_expert1": "0.006", "overflow_expert2": "16.506", "entropy_gating": "0.392", "expert1_balance_top": "30.943", "expert1_balance_bottom": "17.722", "unused_expert1_count": "0.487", "expert2_balance_top": "31.967", "expert2_balance_bottom": "17.209", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15278.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7750", "lr": "4.5e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "141322"}
2023-02-02 13:32:52 | INFO | valid_c4_small/C4_small | {"epoch": 10, "valid_c4_small/C4_small_loss": "4.212", "valid_c4_small/C4_small_moe_gate_loss": "12.4903", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.901", "valid_c4_small/C4_small_entropy_gating": "0.422", "valid_c4_small/C4_small_expert1_balance_top": "30.794", "valid_c4_small/C4_small_expert1_balance_bottom": "19.019", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.481", "valid_c4_small/C4_small_expert2_balance_bottom": "18.152", "valid_c4_small/C4_small_unused_expert2_count": "0.38", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.032", "valid_c4_small/C4_small_ppl": "16.36", "valid_c4_small/C4_small_wps": "52000", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "7750", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 13:32:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 7750 updates
2023-02-02 13:32:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 10 @ 7750 updates, score 4.212) (writing took 7.020045221783221 seconds)
2023-02-02 13:35:52 | INFO | train_inner | {"epoch": 10, "loss": "4.014", "moe_gate_loss": "12.8146", "overflow_expert1": "0.009", "overflow_expert2": "16.828", "entropy_gating": "0.392", "expert1_balance_top": "31.065", "expert1_balance_bottom": "17.635", "unused_expert1_count": "0.482", "expert2_balance_top": "32.119", "expert2_balance_bottom": "17.118", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.829", "ppl": "14.21", "wps": "9063.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "7760", "lr": "4.48e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "141612"}
2023-02-02 13:38:43 | INFO | train_inner | {"epoch": 10, "loss": "3.985", "moe_gate_loss": "12.7953", "overflow_expert1": "0.006", "overflow_expert2": "16.463", "entropy_gating": "0.392", "expert1_balance_top": "30.943", "expert1_balance_bottom": "17.737", "unused_expert1_count": "0.488", "expert2_balance_top": "31.987", "expert2_balance_bottom": "17.224", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.801", "ppl": "13.94", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7770", "lr": "4.46e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "141783"}
2023-02-02 13:41:35 | INFO | train_inner | {"epoch": 10, "loss": "4.049", "moe_gate_loss": "12.7853", "overflow_expert1": "0.006", "overflow_expert2": "16.34", "entropy_gating": "0.392", "expert1_balance_top": "30.857", "expert1_balance_bottom": "17.802", "unused_expert1_count": "0.487", "expert2_balance_top": "31.932", "expert2_balance_bottom": "17.273", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.864", "ppl": "14.57", "wps": "15284.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7780", "lr": "4.44e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "141955"}
2023-02-02 13:44:26 | INFO | train_inner | {"epoch": 10, "loss": "4.065", "moe_gate_loss": "12.7925", "overflow_expert1": "0.005", "overflow_expert2": "16.512", "entropy_gating": "0.392", "expert1_balance_top": "30.914", "expert1_balance_bottom": "17.737", "unused_expert1_count": "0.489", "expert2_balance_top": "31.998", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.881", "ppl": "14.73", "wps": "15277.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7790", "lr": "4.42e-06", "gnorm": "1.221", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "142126"}
2023-02-02 13:47:18 | INFO | train_inner | {"epoch": 10, "loss": "4.056", "moe_gate_loss": "12.7955", "overflow_expert1": "0.005", "overflow_expert2": "16.563", "entropy_gating": "0.392", "expert1_balance_top": "30.946", "expert1_balance_bottom": "17.733", "unused_expert1_count": "0.485", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.204", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7800", "lr": "4.4e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "142298"}
2023-02-02 13:50:09 | INFO | train_inner | {"epoch": 10, "loss": "4.018", "moe_gate_loss": "12.7906", "overflow_expert1": "0.005", "overflow_expert2": "16.525", "entropy_gating": "0.391", "expert1_balance_top": "30.901", "expert1_balance_bottom": "17.763", "unused_expert1_count": "0.486", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.183", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.833", "ppl": "14.25", "wps": "15271.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7810", "lr": "4.38e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "142469"}
2023-02-02 13:53:01 | INFO | train_inner | {"epoch": 10, "loss": "4.005", "moe_gate_loss": "12.8011", "overflow_expert1": "0.005", "overflow_expert2": "16.569", "entropy_gating": "0.392", "expert1_balance_top": "30.956", "expert1_balance_bottom": "17.715", "unused_expert1_count": "0.484", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.215", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.13", "wps": "15286.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7820", "lr": "4.36e-06", "gnorm": "1.215", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "142641"}
2023-02-02 13:55:52 | INFO | train_inner | {"epoch": 10, "loss": "4.026", "moe_gate_loss": "12.7903", "overflow_expert1": "0.004", "overflow_expert2": "16.487", "entropy_gating": "0.393", "expert1_balance_top": "30.913", "expert1_balance_bottom": "17.763", "unused_expert1_count": "0.489", "expert2_balance_top": "31.993", "expert2_balance_bottom": "17.235", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15280.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7830", "lr": "4.34e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "142812"}
2023-02-02 13:58:44 | INFO | train_inner | {"epoch": 10, "loss": "4.018", "moe_gate_loss": "12.7884", "overflow_expert1": "0.005", "overflow_expert2": "16.419", "entropy_gating": "0.393", "expert1_balance_top": "30.884", "expert1_balance_bottom": "17.779", "unused_expert1_count": "0.488", "expert2_balance_top": "31.973", "expert2_balance_bottom": "17.24", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.834", "ppl": "14.26", "wps": "15278.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7840", "lr": "4.32e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "142984"}
2023-02-02 14:01:36 | INFO | train_inner | {"epoch": 10, "loss": "4.014", "moe_gate_loss": "12.7887", "overflow_expert1": "0.007", "overflow_expert2": "16.42", "entropy_gating": "0.392", "expert1_balance_top": "30.883", "expert1_balance_bottom": "17.804", "unused_expert1_count": "0.486", "expert2_balance_top": "31.969", "expert2_balance_bottom": "17.252", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.83", "ppl": "14.22", "wps": "15279.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7850", "lr": "4.3e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "143155"}
2023-02-02 14:04:27 | INFO | train_inner | {"epoch": 10, "loss": "3.985", "moe_gate_loss": "12.8044", "overflow_expert1": "0.007", "overflow_expert2": "16.646", "entropy_gating": "0.391", "expert1_balance_top": "31.006", "expert1_balance_bottom": "17.685", "unused_expert1_count": "0.488", "expert2_balance_top": "32.052", "expert2_balance_bottom": "17.19", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.8", "ppl": "13.93", "wps": "15285.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7860", "lr": "4.28e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "143327"}
2023-02-02 14:07:19 | INFO | train_inner | {"epoch": 10, "loss": "3.997", "moe_gate_loss": "12.7907", "overflow_expert1": "0.005", "overflow_expert2": "16.411", "entropy_gating": "0.391", "expert1_balance_top": "30.917", "expert1_balance_bottom": "17.769", "unused_expert1_count": "0.485", "expert2_balance_top": "32.005", "expert2_balance_bottom": "17.272", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.813", "ppl": "14.05", "wps": "15280.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7870", "lr": "4.26e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "143499"}
2023-02-02 14:10:10 | INFO | train_inner | {"epoch": 10, "loss": "4.044", "moe_gate_loss": "12.7909", "overflow_expert1": "0.004", "overflow_expert2": "16.405", "entropy_gating": "0.391", "expert1_balance_top": "30.901", "expert1_balance_bottom": "17.787", "unused_expert1_count": "0.489", "expert2_balance_top": "31.937", "expert2_balance_bottom": "17.279", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.859", "ppl": "14.51", "wps": "15275.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7880", "lr": "4.24e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "143670"}
2023-02-02 14:13:02 | INFO | train_inner | {"epoch": 10, "loss": "3.964", "moe_gate_loss": "12.7942", "overflow_expert1": "0.006", "overflow_expert2": "16.474", "entropy_gating": "0.392", "expert1_balance_top": "30.945", "expert1_balance_bottom": "17.744", "unused_expert1_count": "0.488", "expert2_balance_top": "31.981", "expert2_balance_bottom": "17.262", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.78", "ppl": "13.73", "wps": "15273.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7890", "lr": "4.22e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "143842"}
2023-02-02 14:15:53 | INFO | train_inner | {"epoch": 10, "loss": "3.988", "moe_gate_loss": "12.8056", "overflow_expert1": "0.006", "overflow_expert2": "16.613", "entropy_gating": "0.392", "expert1_balance_top": "30.997", "expert1_balance_bottom": "17.69", "unused_expert1_count": "0.485", "expert2_balance_top": "32.035", "expert2_balance_bottom": "17.216", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.803", "ppl": "13.96", "wps": "15290.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7900", "lr": "4.2e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "144013"}
2023-02-02 14:18:45 | INFO | train_inner | {"epoch": 10, "loss": "3.991", "moe_gate_loss": "12.787", "overflow_expert1": "0.004", "overflow_expert2": "16.398", "entropy_gating": "0.391", "expert1_balance_top": "30.891", "expert1_balance_bottom": "17.791", "unused_expert1_count": "0.486", "expert2_balance_top": "31.966", "expert2_balance_bottom": "17.267", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.806", "ppl": "13.99", "wps": "15260.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7910", "lr": "4.18e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "144185"}
2023-02-02 14:21:37 | INFO | train_inner | {"epoch": 10, "loss": "4.001", "moe_gate_loss": "12.7921", "overflow_expert1": "0.006", "overflow_expert2": "16.438", "entropy_gating": "0.391", "expert1_balance_top": "30.928", "expert1_balance_bottom": "17.759", "unused_expert1_count": "0.483", "expert2_balance_top": "31.967", "expert2_balance_bottom": "17.264", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.816", "ppl": "14.09", "wps": "15273.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7920", "lr": "4.16e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "144357"}
2023-02-02 14:24:45 | INFO | train_inner | {"epoch": 10, "loss": "3.995", "moe_gate_loss": "12.7786", "overflow_expert1": "0.005", "overflow_expert2": "16.297", "entropy_gating": "0.391", "expert1_balance_top": "30.825", "expert1_balance_bottom": "17.844", "unused_expert1_count": "0.488", "expert2_balance_top": "31.911", "expert2_balance_bottom": "17.282", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.811", "ppl": "14.03", "wps": "13897.8", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "7930", "lr": "4.14e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "2", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "144545"}
2023-02-02 14:27:37 | INFO | train_inner | {"epoch": 10, "loss": "4.018", "moe_gate_loss": "12.8058", "overflow_expert1": "0.006", "overflow_expert2": "16.599", "entropy_gating": "0.392", "expert1_balance_top": "30.987", "expert1_balance_bottom": "17.686", "unused_expert1_count": "0.487", "expert2_balance_top": "31.994", "expert2_balance_bottom": "17.182", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.833", "ppl": "14.25", "wps": "15275.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7940", "lr": "4.12e-06", "gnorm": "1.23", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "144717"}
2023-02-02 14:30:29 | INFO | train_inner | {"epoch": 10, "loss": "4.009", "moe_gate_loss": "12.778", "overflow_expert1": "0.004", "overflow_expert2": "16.211", "entropy_gating": "0.392", "expert1_balance_top": "30.834", "expert1_balance_bottom": "17.835", "unused_expert1_count": "0.485", "expert2_balance_top": "31.868", "expert2_balance_bottom": "17.315", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.825", "ppl": "14.17", "wps": "15275.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7950", "lr": "4.1e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "144888"}
2023-02-02 14:33:20 | INFO | train_inner | {"epoch": 10, "loss": "4.042", "moe_gate_loss": "12.7798", "overflow_expert1": "0.004", "overflow_expert2": "16.394", "entropy_gating": "0.393", "expert1_balance_top": "30.833", "expert1_balance_bottom": "17.842", "unused_expert1_count": "0.485", "expert2_balance_top": "31.99", "expert2_balance_bottom": "17.252", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15284.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7960", "lr": "4.08e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "145060"}
2023-02-02 14:36:12 | INFO | train_inner | {"epoch": 10, "loss": "4.043", "moe_gate_loss": "12.799", "overflow_expert1": "0.008", "overflow_expert2": "16.602", "entropy_gating": "0.391", "expert1_balance_top": "30.953", "expert1_balance_bottom": "17.743", "unused_expert1_count": "0.49", "expert2_balance_top": "32.058", "expert2_balance_bottom": "17.185", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.858", "ppl": "14.5", "wps": "15283.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7970", "lr": "4.06e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "145232"}
2023-02-02 14:39:03 | INFO | train_inner | {"epoch": 10, "loss": "4.029", "moe_gate_loss": "12.7759", "overflow_expert1": "0.004", "overflow_expert2": "16.276", "entropy_gating": "0.392", "expert1_balance_top": "30.802", "expert1_balance_bottom": "17.854", "unused_expert1_count": "0.489", "expert2_balance_top": "31.908", "expert2_balance_bottom": "17.276", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15276.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7980", "lr": "4.04e-06", "gnorm": "1.213", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "145403"}
2023-02-02 14:41:55 | INFO | train_inner | {"epoch": 10, "loss": "4.084", "moe_gate_loss": "12.7915", "overflow_expert1": "0.005", "overflow_expert2": "16.48", "entropy_gating": "0.392", "expert1_balance_top": "30.907", "expert1_balance_bottom": "17.769", "unused_expert1_count": "0.489", "expert2_balance_top": "31.952", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.899", "ppl": "14.92", "wps": "15289", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "7990", "lr": "4.02e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "145575"}
2023-02-02 14:44:46 | INFO | train_inner | {"epoch": 10, "loss": "4.044", "moe_gate_loss": "12.7781", "overflow_expert1": "0.003", "overflow_expert2": "16.449", "entropy_gating": "0.392", "expert1_balance_top": "30.819", "expert1_balance_bottom": "17.828", "unused_expert1_count": "0.485", "expert2_balance_top": "31.979", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "15283.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8000", "lr": "4e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "145746"}
2023-02-02 14:46:36 | INFO | valid_c4_small/C4_small | {"epoch": 10, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.4957", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.902", "valid_c4_small/C4_small_entropy_gating": "0.422", "valid_c4_small/C4_small_expert1_balance_top": "30.831", "valid_c4_small/C4_small_expert1_balance_bottom": "19.026", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.5", "valid_c4_small/C4_small_expert2_balance_bottom": "18.175", "valid_c4_small/C4_small_unused_expert2_count": "0.384", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.031", "valid_c4_small/C4_small_ppl": "16.35", "valid_c4_small/C4_small_wps": "52074.8", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "8000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 14:46:36 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 8000 updates
2023-02-02 14:46:43 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 10 @ 8000 updates, score 4.211) (writing took 6.997248543892056 seconds)
2023-02-02 14:49:35 | INFO | train_inner | {"epoch": 10, "loss": "4.058", "moe_gate_loss": "12.7768", "overflow_expert1": "0.003", "overflow_expert2": "16.307", "entropy_gating": "0.392", "expert1_balance_top": "30.804", "expert1_balance_bottom": "17.854", "unused_expert1_count": "0.483", "expert2_balance_top": "31.944", "expert2_balance_bottom": "17.273", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.873", "ppl": "14.66", "wps": "9074.3", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "8010", "lr": "3.98e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "146035"}
2023-02-02 14:52:27 | INFO | train_inner | {"epoch": 10, "loss": "4.039", "moe_gate_loss": "12.7772", "overflow_expert1": "0.008", "overflow_expert2": "16.21", "entropy_gating": "0.392", "expert1_balance_top": "30.805", "expert1_balance_bottom": "17.85", "unused_expert1_count": "0.487", "expert2_balance_top": "31.939", "expert2_balance_bottom": "17.3", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.855", "ppl": "14.47", "wps": "15283.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8020", "lr": "3.96e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "146206"}
2023-02-02 14:55:18 | INFO | train_inner | {"epoch": 10, "loss": "4.025", "moe_gate_loss": "12.7906", "overflow_expert1": "0.005", "overflow_expert2": "16.422", "entropy_gating": "0.392", "expert1_balance_top": "30.896", "expert1_balance_bottom": "17.776", "unused_expert1_count": "0.486", "expert2_balance_top": "31.964", "expert2_balance_bottom": "17.232", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.841", "ppl": "14.33", "wps": "15288.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8030", "lr": "3.94e-06", "gnorm": "1.199", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "146378"}
2023-02-02 14:58:10 | INFO | train_inner | {"epoch": 10, "loss": "4.038", "moe_gate_loss": "12.7828", "overflow_expert1": "0.007", "overflow_expert2": "16.372", "entropy_gating": "0.392", "expert1_balance_top": "30.833", "expert1_balance_bottom": "17.826", "unused_expert1_count": "0.489", "expert2_balance_top": "31.933", "expert2_balance_bottom": "17.274", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15283.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8040", "lr": "3.92e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "146549"}
2023-02-02 15:01:01 | INFO | train_inner | {"epoch": 10, "loss": "4.012", "moe_gate_loss": "12.7897", "overflow_expert1": "0.006", "overflow_expert2": "16.476", "entropy_gating": "0.392", "expert1_balance_top": "30.902", "expert1_balance_bottom": "17.778", "unused_expert1_count": "0.487", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.235", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.827", "ppl": "14.19", "wps": "15284.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8050", "lr": "3.9e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "146721"}
2023-02-02 15:03:52 | INFO | train_inner | {"epoch": 10, "loss": "4.024", "moe_gate_loss": "12.7786", "overflow_expert1": "0.002", "overflow_expert2": "16.366", "entropy_gating": "0.392", "expert1_balance_top": "30.833", "expert1_balance_bottom": "17.842", "unused_expert1_count": "0.484", "expert2_balance_top": "31.943", "expert2_balance_bottom": "17.26", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.84", "ppl": "14.32", "wps": "15292.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8060", "lr": "3.88e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "146892"}
2023-02-02 15:06:44 | INFO | train_inner | {"epoch": 10, "loss": "4.052", "moe_gate_loss": "12.777", "overflow_expert1": "0.006", "overflow_expert2": "16.338", "entropy_gating": "0.393", "expert1_balance_top": "30.819", "expert1_balance_bottom": "17.862", "unused_expert1_count": "0.485", "expert2_balance_top": "31.927", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.868", "ppl": "14.6", "wps": "15292.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8070", "lr": "3.86e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "147064"}
2023-02-02 15:09:35 | INFO | train_inner | {"epoch": 10, "loss": "4.039", "moe_gate_loss": "12.7902", "overflow_expert1": "0.006", "overflow_expert2": "16.412", "entropy_gating": "0.392", "expert1_balance_top": "30.899", "expert1_balance_bottom": "17.782", "unused_expert1_count": "0.487", "expert2_balance_top": "31.96", "expert2_balance_bottom": "17.238", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.855", "ppl": "14.47", "wps": "15287.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8080", "lr": "3.84e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "147235"}
2023-02-02 15:12:27 | INFO | train_inner | {"epoch": 10, "loss": "4.044", "moe_gate_loss": "12.7997", "overflow_expert1": "0.006", "overflow_expert2": "16.578", "entropy_gating": "0.393", "expert1_balance_top": "30.951", "expert1_balance_bottom": "17.734", "unused_expert1_count": "0.487", "expert2_balance_top": "32.05", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.859", "ppl": "14.52", "wps": "15288.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8090", "lr": "3.82e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "147407"}
2023-02-02 15:15:18 | INFO | train_inner | {"epoch": 10, "loss": "4.025", "moe_gate_loss": "12.7827", "overflow_expert1": "0.005", "overflow_expert2": "16.354", "entropy_gating": "0.392", "expert1_balance_top": "30.841", "expert1_balance_bottom": "17.816", "unused_expert1_count": "0.485", "expert2_balance_top": "31.93", "expert2_balance_bottom": "17.268", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.84", "ppl": "14.32", "wps": "15287.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8100", "lr": "3.8e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "147578"}
2023-02-02 15:18:10 | INFO | train_inner | {"epoch": 10, "loss": "4.024", "moe_gate_loss": "12.7958", "overflow_expert1": "0.005", "overflow_expert2": "16.595", "entropy_gating": "0.392", "expert1_balance_top": "30.952", "expert1_balance_bottom": "17.747", "unused_expert1_count": "0.486", "expert2_balance_top": "32.024", "expert2_balance_bottom": "17.203", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.839", "ppl": "14.31", "wps": "15283.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8110", "lr": "3.78e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "147750"}
2023-02-02 15:21:01 | INFO | train_inner | {"epoch": 10, "loss": "4.016", "moe_gate_loss": "12.803", "overflow_expert1": "0.004", "overflow_expert2": "16.635", "entropy_gating": "0.392", "expert1_balance_top": "31", "expert1_balance_bottom": "17.705", "unused_expert1_count": "0.481", "expert2_balance_top": "32.015", "expert2_balance_bottom": "17.187", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.831", "ppl": "14.23", "wps": "15294.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8120", "lr": "3.76e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "147921"}
2023-02-02 15:23:53 | INFO | train_inner | {"epoch": 10, "loss": "4.03", "moe_gate_loss": "12.7874", "overflow_expert1": "0.005", "overflow_expert2": "16.464", "entropy_gating": "0.392", "expert1_balance_top": "30.891", "expert1_balance_bottom": "17.807", "unused_expert1_count": "0.488", "expert2_balance_top": "31.985", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15281.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8130", "lr": "3.74e-06", "gnorm": "1.191", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "148093"}
2023-02-02 15:26:44 | INFO | train_inner | {"epoch": 10, "loss": "4.041", "moe_gate_loss": "12.781", "overflow_expert1": "0.005", "overflow_expert2": "16.305", "entropy_gating": "0.392", "expert1_balance_top": "30.833", "expert1_balance_bottom": "17.847", "unused_expert1_count": "0.488", "expert2_balance_top": "31.919", "expert2_balance_bottom": "17.261", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.856", "ppl": "14.48", "wps": "15295.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8140", "lr": "3.72e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "148264"}
2023-02-02 15:29:36 | INFO | train_inner | {"epoch": 10, "loss": "4.064", "moe_gate_loss": "12.776", "overflow_expert1": "0.003", "overflow_expert2": "16.208", "entropy_gating": "0.392", "expert1_balance_top": "30.81", "expert1_balance_bottom": "17.861", "unused_expert1_count": "0.486", "expert2_balance_top": "31.898", "expert2_balance_bottom": "17.319", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.88", "ppl": "14.72", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8150", "lr": "3.7e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "148436"}
2023-02-02 15:32:27 | INFO | train_inner | {"epoch": 10, "loss": "4.041", "moe_gate_loss": "12.779", "overflow_expert1": "0.007", "overflow_expert2": "16.21", "entropy_gating": "0.392", "expert1_balance_top": "30.807", "expert1_balance_bottom": "17.847", "unused_expert1_count": "0.489", "expert2_balance_top": "31.889", "expert2_balance_bottom": "17.311", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.857", "ppl": "14.49", "wps": "15290.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8160", "lr": "3.68e-06", "gnorm": "1.188", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "148607"}
2023-02-02 15:34:25 | INFO | valid_c4_small/C4_small | {"epoch": 10, "valid_c4_small/C4_small_loss": "4.21", "valid_c4_small/C4_small_moe_gate_loss": "12.4956", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.691", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.848", "valid_c4_small/C4_small_expert1_balance_bottom": "19.017", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.375", "valid_c4_small/C4_small_expert2_balance_bottom": "18.269", "valid_c4_small/C4_small_unused_expert2_count": "0.386", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.34", "valid_c4_small/C4_small_wps": "52045.8", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "8160", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 15:34:25 | INFO | fairseq_cli.train | end of epoch 10 (average epoch stats below)
2023-02-02 15:34:25 | INFO | train | {"epoch": 10, "train_loss": "4.018", "train_moe_gate_loss": "12.7911", "train_overflow_expert1": "0.005", "train_overflow_expert2": "16.491", "train_entropy_gating": "0.392", "train_expert1_balance_top": "30.91", "train_expert1_balance_bottom": "17.759", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "31.993", "train_expert2_balance_bottom": "17.216", "train_unused_expert2_count": "0.447", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.834", "train_ppl": "14.26", "train_wps": "14768.9", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "8160", "train_lr": "3.68e-06", "train_gnorm": "1.208", "train_clip": "100", "train_loss_scale": "1", "train_train_wall": "13576", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "148725"}
2023-02-02 15:34:25 | INFO | fairseq.trainer | begin training epoch 11
2023-02-02 15:37:16 | INFO | train_inner | {"epoch": 11, "loss": "4.064", "moe_gate_loss": "12.7769", "overflow_expert1": "0.006", "overflow_expert2": "16.258", "entropy_gating": "0.393", "expert1_balance_top": "30.814", "expert1_balance_bottom": "17.856", "unused_expert1_count": "0.489", "expert2_balance_top": "31.92", "expert2_balance_bottom": "17.292", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.72", "wps": "9069.7", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "8170", "lr": "3.66e-06", "gnorm": "1.188", "clip": "100", "loss_scale": "1", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "148896"}
2023-02-02 15:40:08 | INFO | train_inner | {"epoch": 11, "loss": "4.008", "moe_gate_loss": "12.7819", "overflow_expert1": "0.007", "overflow_expert2": "16.485", "entropy_gating": "0.393", "expert1_balance_top": "30.824", "expert1_balance_bottom": "17.826", "unused_expert1_count": "0.486", "expert2_balance_top": "32.058", "expert2_balance_bottom": "17.219", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.15", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8180", "lr": "3.64e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "149067"}
2023-02-02 15:42:59 | INFO | train_inner | {"epoch": 11, "loss": "4", "moe_gate_loss": "12.7835", "overflow_expert1": "0.004", "overflow_expert2": "16.82", "entropy_gating": "0.393", "expert1_balance_top": "30.85", "expert1_balance_bottom": "17.759", "unused_expert1_count": "0.486", "expert2_balance_top": "32.186", "expert2_balance_bottom": "17.088", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.815", "ppl": "14.08", "wps": "15280.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8190", "lr": "3.62e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "149239"}
2023-02-02 15:45:51 | INFO | train_inner | {"epoch": 11, "loss": "3.977", "moe_gate_loss": "12.7894", "overflow_expert1": "0.005", "overflow_expert2": "16.802", "entropy_gating": "0.393", "expert1_balance_top": "30.894", "expert1_balance_bottom": "17.724", "unused_expert1_count": "0.485", "expert2_balance_top": "32.127", "expert2_balance_bottom": "17.076", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.792", "ppl": "13.86", "wps": "15287.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8200", "lr": "3.6e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "149411"}
2023-02-02 15:48:42 | INFO | train_inner | {"epoch": 11, "loss": "3.976", "moe_gate_loss": "12.7946", "overflow_expert1": "0.004", "overflow_expert2": "16.786", "entropy_gating": "0.393", "expert1_balance_top": "30.961", "expert1_balance_bottom": "17.683", "unused_expert1_count": "0.488", "expert2_balance_top": "32.06", "expert2_balance_bottom": "17.082", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.791", "ppl": "13.85", "wps": "15292.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8210", "lr": "3.58e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "149582"}
2023-02-02 15:51:33 | INFO | train_inner | {"epoch": 11, "loss": "3.95", "moe_gate_loss": "12.7851", "overflow_expert1": "0.003", "overflow_expert2": "16.662", "entropy_gating": "0.392", "expert1_balance_top": "30.881", "expert1_balance_bottom": "17.744", "unused_expert1_count": "0.486", "expert2_balance_top": "31.997", "expert2_balance_bottom": "17.11", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.766", "ppl": "13.6", "wps": "15291.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8220", "lr": "3.56e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "149753"}
2023-02-02 15:54:25 | INFO | train_inner | {"epoch": 11, "loss": "3.978", "moe_gate_loss": "12.7889", "overflow_expert1": "0.003", "overflow_expert2": "16.575", "entropy_gating": "0.392", "expert1_balance_top": "30.9", "expert1_balance_bottom": "17.725", "unused_expert1_count": "0.487", "expert2_balance_top": "31.997", "expert2_balance_bottom": "17.152", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.794", "ppl": "13.87", "wps": "15278.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8230", "lr": "3.54e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "149925"}
2023-02-02 15:57:16 | INFO | train_inner | {"epoch": 11, "loss": "4.023", "moe_gate_loss": "12.7917", "overflow_expert1": "0.005", "overflow_expert2": "16.467", "entropy_gating": "0.392", "expert1_balance_top": "30.921", "expert1_balance_bottom": "17.727", "unused_expert1_count": "0.488", "expert2_balance_top": "31.993", "expert2_balance_bottom": "17.187", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.838", "ppl": "14.3", "wps": "15291.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8240", "lr": "3.52e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "150096"}
2023-02-02 16:00:08 | INFO | train_inner | {"epoch": 11, "loss": "4.003", "moe_gate_loss": "12.7792", "overflow_expert1": "0.003", "overflow_expert2": "16.395", "entropy_gating": "0.392", "expert1_balance_top": "30.823", "expert1_balance_bottom": "17.792", "unused_expert1_count": "0.488", "expert2_balance_top": "31.987", "expert2_balance_bottom": "17.217", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.819", "ppl": "14.11", "wps": "15291.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8250", "lr": "3.5e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "150268"}
2023-02-02 16:01:57 | INFO | valid_c4_small/C4_small | {"epoch": 11, "valid_c4_small/C4_small_loss": "4.214", "valid_c4_small/C4_small_moe_gate_loss": "12.4939", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.822", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.817", "valid_c4_small/C4_small_expert1_balance_bottom": "19.015", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.49", "valid_c4_small/C4_small_expert2_balance_bottom": "18.158", "valid_c4_small/C4_small_unused_expert2_count": "0.387", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.034", "valid_c4_small/C4_small_ppl": "16.38", "valid_c4_small/C4_small_wps": "52084.3", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "8250", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 16:01:57 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 8250 updates
2023-02-02 16:02:04 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 11 @ 8250 updates, score 4.214) (writing took 6.881244448013604 seconds)
2023-02-02 16:04:57 | INFO | train_inner | {"epoch": 11, "loss": "4.004", "moe_gate_loss": "12.7866", "overflow_expert1": "0.003", "overflow_expert2": "16.572", "entropy_gating": "0.392", "expert1_balance_top": "30.872", "expert1_balance_bottom": "17.742", "unused_expert1_count": "0.483", "expert2_balance_top": "32.019", "expert2_balance_bottom": "17.148", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.819", "ppl": "14.11", "wps": "9065.7", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "8260", "lr": "3.48e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "1", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "150557"}
2023-02-02 16:07:49 | INFO | train_inner | {"epoch": 11, "loss": "3.961", "moe_gate_loss": "12.7943", "overflow_expert1": "0.005", "overflow_expert2": "16.655", "entropy_gating": "0.392", "expert1_balance_top": "30.927", "expert1_balance_bottom": "17.713", "unused_expert1_count": "0.486", "expert2_balance_top": "32.055", "expert2_balance_bottom": "17.137", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.777", "ppl": "13.71", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8270", "lr": "3.46e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "150728"}
2023-02-02 16:10:40 | INFO | train_inner | {"epoch": 11, "loss": "4", "moe_gate_loss": "12.7835", "overflow_expert1": "0.004", "overflow_expert2": "16.467", "entropy_gating": "0.392", "expert1_balance_top": "30.857", "expert1_balance_bottom": "17.772", "unused_expert1_count": "0.486", "expert2_balance_top": "31.992", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.816", "ppl": "14.08", "wps": "15292.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8280", "lr": "3.44e-06", "gnorm": "1.226", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "150900"}
2023-02-02 16:13:31 | INFO | train_inner | {"epoch": 11, "loss": "3.995", "moe_gate_loss": "12.7893", "overflow_expert1": "0.004", "overflow_expert2": "16.606", "entropy_gating": "0.392", "expert1_balance_top": "30.898", "expert1_balance_bottom": "17.762", "unused_expert1_count": "0.486", "expert2_balance_top": "32.001", "expert2_balance_bottom": "17.147", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.811", "ppl": "14.03", "wps": "15290.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8290", "lr": "3.42e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "151071"}
2023-02-02 16:16:23 | INFO | train_inner | {"epoch": 11, "loss": "4.008", "moe_gate_loss": "12.798", "overflow_expert1": "0.006", "overflow_expert2": "16.64", "entropy_gating": "0.392", "expert1_balance_top": "30.964", "expert1_balance_bottom": "17.7", "unused_expert1_count": "0.487", "expert2_balance_top": "32.043", "expert2_balance_bottom": "17.156", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8300", "lr": "3.4e-06", "gnorm": "1.218", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "151243"}
2023-02-02 16:19:14 | INFO | train_inner | {"epoch": 11, "loss": "4.008", "moe_gate_loss": "12.782", "overflow_expert1": "0.006", "overflow_expert2": "16.352", "entropy_gating": "0.392", "expert1_balance_top": "30.83", "expert1_balance_bottom": "17.801", "unused_expert1_count": "0.487", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8310", "lr": "3.38e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "151414"}
2023-02-02 16:22:06 | INFO | train_inner | {"epoch": 11, "loss": "3.996", "moe_gate_loss": "12.7959", "overflow_expert1": "0.005", "overflow_expert2": "16.52", "entropy_gating": "0.392", "expert1_balance_top": "30.934", "expert1_balance_bottom": "17.733", "unused_expert1_count": "0.488", "expert2_balance_top": "31.972", "expert2_balance_bottom": "17.199", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.812", "ppl": "14.04", "wps": "15290.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8320", "lr": "3.36e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "151586"}
2023-02-02 16:24:57 | INFO | train_inner | {"epoch": 11, "loss": "4.064", "moe_gate_loss": "12.8019", "overflow_expert1": "0.005", "overflow_expert2": "16.573", "entropy_gating": "0.393", "expert1_balance_top": "30.978", "expert1_balance_bottom": "17.696", "unused_expert1_count": "0.488", "expert2_balance_top": "31.997", "expert2_balance_bottom": "17.183", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.879", "ppl": "14.71", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8330", "lr": "3.34e-06", "gnorm": "1.246", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "151757"}
2023-02-02 16:27:49 | INFO | train_inner | {"epoch": 11, "loss": "3.992", "moe_gate_loss": "12.8012", "overflow_expert1": "0.004", "overflow_expert2": "16.762", "entropy_gating": "0.392", "expert1_balance_top": "30.971", "expert1_balance_bottom": "17.691", "unused_expert1_count": "0.487", "expert2_balance_top": "32.097", "expert2_balance_bottom": "17.114", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.807", "ppl": "14", "wps": "15291.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8340", "lr": "3.32e-06", "gnorm": "1.216", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "151929"}
2023-02-02 16:30:40 | INFO | train_inner | {"epoch": 11, "loss": "4.015", "moe_gate_loss": "12.785", "overflow_expert1": "0.003", "overflow_expert2": "16.44", "entropy_gating": "0.392", "expert1_balance_top": "30.85", "expert1_balance_bottom": "17.79", "unused_expert1_count": "0.489", "expert2_balance_top": "31.981", "expert2_balance_bottom": "17.216", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.831", "ppl": "14.23", "wps": "15282.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8350", "lr": "3.3e-06", "gnorm": "1.23", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "152100"}
2023-02-02 16:33:32 | INFO | train_inner | {"epoch": 11, "loss": "4.007", "moe_gate_loss": "12.7902", "overflow_expert1": "0.003", "overflow_expert2": "16.49", "entropy_gating": "0.393", "expert1_balance_top": "30.902", "expert1_balance_bottom": "17.76", "unused_expert1_count": "0.486", "expert2_balance_top": "32.034", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.822", "ppl": "14.14", "wps": "15281.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8360", "lr": "3.28e-06", "gnorm": "1.227", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "152272"}
2023-02-02 16:36:23 | INFO | train_inner | {"epoch": 11, "loss": "3.982", "moe_gate_loss": "12.8064", "overflow_expert1": "0.006", "overflow_expert2": "16.592", "entropy_gating": "0.391", "expert1_balance_top": "31.02", "expert1_balance_bottom": "17.68", "unused_expert1_count": "0.485", "expert2_balance_top": "32.017", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.797", "ppl": "13.9", "wps": "15291.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8370", "lr": "3.26e-06", "gnorm": "1.228", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "152443"}
2023-02-02 16:39:15 | INFO | train_inner | {"epoch": 11, "loss": "4.028", "moe_gate_loss": "12.7809", "overflow_expert1": "0.005", "overflow_expert2": "16.321", "entropy_gating": "0.392", "expert1_balance_top": "30.818", "expert1_balance_bottom": "17.822", "unused_expert1_count": "0.484", "expert2_balance_top": "31.943", "expert2_balance_bottom": "17.274", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15288.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8380", "lr": "3.24e-06", "gnorm": "1.221", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "152615"}
2023-02-02 16:42:06 | INFO | train_inner | {"epoch": 11, "loss": "3.985", "moe_gate_loss": "12.7886", "overflow_expert1": "0.005", "overflow_expert2": "16.455", "entropy_gating": "0.392", "expert1_balance_top": "30.886", "expert1_balance_bottom": "17.798", "unused_expert1_count": "0.485", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.801", "ppl": "13.94", "wps": "15293.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8390", "lr": "3.22e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "152786"}
2023-02-02 16:44:57 | INFO | train_inner | {"epoch": 11, "loss": "4", "moe_gate_loss": "12.7879", "overflow_expert1": "0.005", "overflow_expert2": "16.395", "entropy_gating": "0.393", "expert1_balance_top": "30.866", "expert1_balance_bottom": "17.784", "unused_expert1_count": "0.489", "expert2_balance_top": "31.957", "expert2_balance_bottom": "17.244", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.816", "ppl": "14.08", "wps": "15289.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8400", "lr": "3.2e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "152957"}
2023-02-02 16:47:49 | INFO | train_inner | {"epoch": 11, "loss": "4.02", "moe_gate_loss": "12.7868", "overflow_expert1": "0.004", "overflow_expert2": "16.358", "entropy_gating": "0.392", "expert1_balance_top": "30.863", "expert1_balance_bottom": "17.793", "unused_expert1_count": "0.484", "expert2_balance_top": "31.97", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15300", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8410", "lr": "3.18e-06", "gnorm": "1.219", "clip": "100", "loss_scale": "1", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "153129"}
2023-02-02 16:50:40 | INFO | train_inner | {"epoch": 11, "loss": "3.99", "moe_gate_loss": "12.7818", "overflow_expert1": "0.006", "overflow_expert2": "16.311", "entropy_gating": "0.392", "expert1_balance_top": "30.843", "expert1_balance_bottom": "17.822", "unused_expert1_count": "0.485", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.254", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.805", "ppl": "13.98", "wps": "15297.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8420", "lr": "3.16e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "153300"}
2023-02-02 16:53:32 | INFO | train_inner | {"epoch": 11, "loss": "4.036", "moe_gate_loss": "12.788", "overflow_expert1": "0.003", "overflow_expert2": "16.437", "entropy_gating": "0.392", "expert1_balance_top": "30.877", "expert1_balance_bottom": "17.789", "unused_expert1_count": "0.486", "expert2_balance_top": "31.96", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.851", "ppl": "14.43", "wps": "15286.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8430", "lr": "3.14e-06", "gnorm": "1.223", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "153472"}
2023-02-02 16:56:23 | INFO | train_inner | {"epoch": 11, "loss": "3.989", "moe_gate_loss": "12.7849", "overflow_expert1": "0.003", "overflow_expert2": "16.453", "entropy_gating": "0.392", "expert1_balance_top": "30.863", "expert1_balance_bottom": "17.783", "unused_expert1_count": "0.485", "expert2_balance_top": "31.94", "expert2_balance_bottom": "17.21", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.805", "ppl": "13.98", "wps": "15287.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8440", "lr": "3.12e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "153643"}
2023-02-02 16:59:15 | INFO | train_inner | {"epoch": 11, "loss": "3.994", "moe_gate_loss": "12.7934", "overflow_expert1": "0.005", "overflow_expert2": "16.539", "entropy_gating": "0.393", "expert1_balance_top": "30.925", "expert1_balance_bottom": "17.752", "unused_expert1_count": "0.489", "expert2_balance_top": "31.996", "expert2_balance_bottom": "17.205", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.81", "ppl": "14.02", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8450", "lr": "3.1e-06", "gnorm": "1.191", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "153815"}
2023-02-02 17:02:06 | INFO | train_inner | {"epoch": 11, "loss": "4.024", "moe_gate_loss": "12.7791", "overflow_expert1": "0.004", "overflow_expert2": "16.371", "entropy_gating": "0.393", "expert1_balance_top": "30.796", "expert1_balance_bottom": "17.84", "unused_expert1_count": "0.489", "expert2_balance_top": "31.979", "expert2_balance_bottom": "17.233", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.839", "ppl": "14.31", "wps": "15283.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8460", "lr": "3.08e-06", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "153986"}
2023-02-02 17:04:58 | INFO | train_inner | {"epoch": 11, "loss": "4.057", "moe_gate_loss": "12.8016", "overflow_expert1": "0.006", "overflow_expert2": "16.555", "entropy_gating": "0.392", "expert1_balance_top": "30.973", "expert1_balance_bottom": "17.721", "unused_expert1_count": "0.487", "expert2_balance_top": "31.995", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15278", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8470", "lr": "3.06e-06", "gnorm": "1.22", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "154158"}
2023-02-02 17:07:49 | INFO | train_inner | {"epoch": 11, "loss": "3.998", "moe_gate_loss": "12.7985", "overflow_expert1": "0.006", "overflow_expert2": "16.506", "entropy_gating": "0.392", "expert1_balance_top": "30.949", "expert1_balance_bottom": "17.724", "unused_expert1_count": "0.488", "expert2_balance_top": "31.985", "expert2_balance_bottom": "17.222", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.814", "ppl": "14.06", "wps": "15286.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8480", "lr": "3.04e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "154329"}
2023-02-02 17:10:41 | INFO | train_inner | {"epoch": 11, "loss": "3.984", "moe_gate_loss": "12.7837", "overflow_expert1": "0.003", "overflow_expert2": "16.264", "entropy_gating": "0.392", "expert1_balance_top": "30.866", "expert1_balance_bottom": "17.795", "unused_expert1_count": "0.488", "expert2_balance_top": "31.896", "expert2_balance_bottom": "17.301", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.8", "ppl": "13.93", "wps": "15294.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8490", "lr": "3.02e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "154501"}
2023-02-02 17:13:32 | INFO | train_inner | {"epoch": 11, "loss": "4.02", "moe_gate_loss": "12.7799", "overflow_expert1": "0.005", "overflow_expert2": "16.254", "entropy_gating": "0.392", "expert1_balance_top": "30.814", "expert1_balance_bottom": "17.832", "unused_expert1_count": "0.49", "expert2_balance_top": "31.909", "expert2_balance_bottom": "17.286", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.835", "ppl": "14.27", "wps": "15290.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8500", "lr": "3e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "154672"}
2023-02-02 17:15:22 | INFO | valid_c4_small/C4_small | {"epoch": 11, "valid_c4_small/C4_small_loss": "4.213", "valid_c4_small/C4_small_moe_gate_loss": "12.4904", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.674", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.801", "valid_c4_small/C4_small_expert1_balance_bottom": "19.045", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.385", "valid_c4_small/C4_small_expert2_balance_bottom": "18.24", "valid_c4_small/C4_small_unused_expert2_count": "0.385", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.033", "valid_c4_small/C4_small_ppl": "16.37", "valid_c4_small/C4_small_wps": "52020.5", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "8500", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 17:15:22 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 8500 updates
2023-02-02 17:15:28 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 11 @ 8500 updates, score 4.213) (writing took 6.811738966032863 seconds)
2023-02-02 17:18:21 | INFO | train_inner | {"epoch": 11, "loss": "4.014", "moe_gate_loss": "12.7932", "overflow_expert1": "0.01", "overflow_expert2": "16.433", "entropy_gating": "0.392", "expert1_balance_top": "30.904", "expert1_balance_bottom": "17.783", "unused_expert1_count": "0.485", "expert2_balance_top": "31.943", "expert2_balance_bottom": "17.224", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.83", "ppl": "14.22", "wps": "9063.9", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "8510", "lr": "2.98e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "2", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "154961"}
2023-02-02 17:21:13 | INFO | train_inner | {"epoch": 11, "loss": "4.037", "moe_gate_loss": "12.7782", "overflow_expert1": "0.004", "overflow_expert2": "16.265", "entropy_gating": "0.392", "expert1_balance_top": "30.813", "expert1_balance_bottom": "17.826", "unused_expert1_count": "0.49", "expert2_balance_top": "31.896", "expert2_balance_bottom": "17.266", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15271.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8520", "lr": "2.96e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "155133"}
2023-02-02 17:24:05 | INFO | train_inner | {"epoch": 11, "loss": "3.981", "moe_gate_loss": "12.7906", "overflow_expert1": "0.006", "overflow_expert2": "16.41", "entropy_gating": "0.392", "expert1_balance_top": "30.892", "expert1_balance_bottom": "17.77", "unused_expert1_count": "0.484", "expert2_balance_top": "31.957", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.797", "ppl": "13.9", "wps": "15263.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8530", "lr": "2.94e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "155305"}
2023-02-02 17:26:56 | INFO | train_inner | {"epoch": 11, "loss": "4.021", "moe_gate_loss": "12.7899", "overflow_expert1": "0.004", "overflow_expert2": "16.477", "entropy_gating": "0.393", "expert1_balance_top": "30.897", "expert1_balance_bottom": "17.769", "unused_expert1_count": "0.483", "expert2_balance_top": "31.979", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15271.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8540", "lr": "2.92e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "155476"}
2023-02-02 17:29:48 | INFO | train_inner | {"epoch": 11, "loss": "4.009", "moe_gate_loss": "12.7859", "overflow_expert1": "0.004", "overflow_expert2": "16.436", "entropy_gating": "0.392", "expert1_balance_top": "30.866", "expert1_balance_bottom": "17.801", "unused_expert1_count": "0.486", "expert2_balance_top": "31.958", "expert2_balance_bottom": "17.233", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15265.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8550", "lr": "2.9e-06", "gnorm": "1.221", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "155648"}
2023-02-02 17:32:40 | INFO | train_inner | {"epoch": 11, "loss": "3.98", "moe_gate_loss": "12.7933", "overflow_expert1": "0.007", "overflow_expert2": "16.404", "entropy_gating": "0.392", "expert1_balance_top": "30.903", "expert1_balance_bottom": "17.756", "unused_expert1_count": "0.486", "expert2_balance_top": "31.979", "expert2_balance_bottom": "17.251", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.796", "ppl": "13.89", "wps": "15274.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8560", "lr": "2.88e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "155820"}
2023-02-02 17:35:31 | INFO | train_inner | {"epoch": 11, "loss": "4.007", "moe_gate_loss": "12.7946", "overflow_expert1": "0.006", "overflow_expert2": "16.397", "entropy_gating": "0.392", "expert1_balance_top": "30.932", "expert1_balance_bottom": "17.75", "unused_expert1_count": "0.487", "expert2_balance_top": "31.922", "expert2_balance_bottom": "17.246", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.823", "ppl": "14.15", "wps": "15280.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8570", "lr": "2.86e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "155991"}
2023-02-02 17:38:23 | INFO | train_inner | {"epoch": 11, "loss": "4.021", "moe_gate_loss": "12.8071", "overflow_expert1": "0.009", "overflow_expert2": "16.546", "entropy_gating": "0.392", "expert1_balance_top": "31.006", "expert1_balance_bottom": "17.697", "unused_expert1_count": "0.486", "expert2_balance_top": "32.006", "expert2_balance_bottom": "17.206", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15278.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8580", "lr": "2.84e-06", "gnorm": "1.211", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "156163"}
2023-02-02 17:41:14 | INFO | train_inner | {"epoch": 11, "loss": "3.992", "moe_gate_loss": "12.7893", "overflow_expert1": "0.006", "overflow_expert2": "16.355", "entropy_gating": "0.392", "expert1_balance_top": "30.883", "expert1_balance_bottom": "17.784", "unused_expert1_count": "0.487", "expert2_balance_top": "31.955", "expert2_balance_bottom": "17.264", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.807", "ppl": "14", "wps": "15280.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8590", "lr": "2.82e-06", "gnorm": "1.199", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "156334"}
2023-02-02 17:44:06 | INFO | train_inner | {"epoch": 11, "loss": "4.034", "moe_gate_loss": "12.782", "overflow_expert1": "0.006", "overflow_expert2": "16.272", "entropy_gating": "0.392", "expert1_balance_top": "30.835", "expert1_balance_bottom": "17.815", "unused_expert1_count": "0.488", "expert2_balance_top": "31.913", "expert2_balance_bottom": "17.278", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.85", "ppl": "14.42", "wps": "15281.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8600", "lr": "2.8e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "156506"}
2023-02-02 17:46:58 | INFO | train_inner | {"epoch": 11, "loss": "4.1", "moe_gate_loss": "12.7962", "overflow_expert1": "0.003", "overflow_expert2": "16.492", "entropy_gating": "0.392", "expert1_balance_top": "30.946", "expert1_balance_bottom": "17.711", "unused_expert1_count": "0.488", "expert2_balance_top": "31.974", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.915", "ppl": "15.09", "wps": "15267.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8610", "lr": "2.78e-06", "gnorm": "1.221", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "156678"}
2023-02-02 17:49:49 | INFO | train_inner | {"epoch": 11, "loss": "4.008", "moe_gate_loss": "12.7826", "overflow_expert1": "0.004", "overflow_expert2": "16.368", "entropy_gating": "0.392", "expert1_balance_top": "30.857", "expert1_balance_bottom": "17.814", "unused_expert1_count": "0.488", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.25", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15280.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8620", "lr": "2.76e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "156849"}
2023-02-02 17:52:41 | INFO | train_inner | {"epoch": 11, "loss": "4.029", "moe_gate_loss": "12.7921", "overflow_expert1": "0.005", "overflow_expert2": "16.55", "entropy_gating": "0.391", "expert1_balance_top": "30.891", "expert1_balance_bottom": "17.757", "unused_expert1_count": "0.482", "expert2_balance_top": "32.023", "expert2_balance_bottom": "17.185", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15275.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8630", "lr": "2.74e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "157021"}
2023-02-02 17:55:32 | INFO | train_inner | {"epoch": 11, "loss": "4.005", "moe_gate_loss": "12.7951", "overflow_expert1": "0.004", "overflow_expert2": "16.532", "entropy_gating": "0.392", "expert1_balance_top": "30.912", "expert1_balance_bottom": "17.753", "unused_expert1_count": "0.485", "expert2_balance_top": "32.014", "expert2_balance_bottom": "17.206", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.821", "ppl": "14.13", "wps": "15278.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8640", "lr": "2.72e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "157192"}
2023-02-02 17:58:24 | INFO | train_inner | {"epoch": 11, "loss": "4.031", "moe_gate_loss": "12.7851", "overflow_expert1": "0.004", "overflow_expert2": "16.394", "entropy_gating": "0.393", "expert1_balance_top": "30.867", "expert1_balance_bottom": "17.798", "unused_expert1_count": "0.488", "expert2_balance_top": "31.937", "expert2_balance_bottom": "17.243", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.846", "ppl": "14.38", "wps": "15275.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8650", "lr": "2.7e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "157364"}
2023-02-02 18:01:15 | INFO | train_inner | {"epoch": 11, "loss": "3.966", "moe_gate_loss": "12.7824", "overflow_expert1": "0.006", "overflow_expert2": "16.248", "entropy_gating": "0.392", "expert1_balance_top": "30.84", "expert1_balance_bottom": "17.84", "unused_expert1_count": "0.488", "expert2_balance_top": "31.925", "expert2_balance_bottom": "17.302", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.781", "ppl": "13.75", "wps": "15288.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8660", "lr": "2.68e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "157535"}
2023-02-02 18:04:07 | INFO | train_inner | {"epoch": 11, "loss": "3.981", "moe_gate_loss": "12.7968", "overflow_expert1": "0.006", "overflow_expert2": "16.533", "entropy_gating": "0.391", "expert1_balance_top": "30.925", "expert1_balance_bottom": "17.727", "unused_expert1_count": "0.485", "expert2_balance_top": "32.012", "expert2_balance_bottom": "17.201", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.797", "ppl": "13.9", "wps": "15292.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8670", "lr": "2.66e-06", "gnorm": "1.227", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "157707"}
2023-02-02 18:06:58 | INFO | train_inner | {"epoch": 11, "loss": "4.012", "moe_gate_loss": "12.7971", "overflow_expert1": "0.005", "overflow_expert2": "16.563", "entropy_gating": "0.392", "expert1_balance_top": "30.952", "expert1_balance_bottom": "17.743", "unused_expert1_count": "0.485", "expert2_balance_top": "32.032", "expert2_balance_bottom": "17.216", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.828", "ppl": "14.2", "wps": "15278.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8680", "lr": "2.64e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "157878"}
2023-02-02 18:09:50 | INFO | train_inner | {"epoch": 11, "loss": "4.032", "moe_gate_loss": "12.7813", "overflow_expert1": "0.004", "overflow_expert2": "16.35", "entropy_gating": "0.392", "expert1_balance_top": "30.828", "expert1_balance_bottom": "17.839", "unused_expert1_count": "0.485", "expert2_balance_top": "31.989", "expert2_balance_bottom": "17.254", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.847", "ppl": "14.39", "wps": "15275", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8690", "lr": "2.62e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "158050"}
2023-02-02 18:12:42 | INFO | train_inner | {"epoch": 11, "loss": "4.005", "moe_gate_loss": "12.7956", "overflow_expert1": "0.006", "overflow_expert2": "16.499", "entropy_gating": "0.391", "expert1_balance_top": "30.928", "expert1_balance_bottom": "17.757", "unused_expert1_count": "0.48", "expert2_balance_top": "31.998", "expert2_balance_bottom": "17.241", "unused_expert2_count": "0.441", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.13", "wps": "15277.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8700", "lr": "2.6e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "158222"}
2023-02-02 18:15:33 | INFO | train_inner | {"epoch": 11, "loss": "3.97", "moe_gate_loss": "12.7799", "overflow_expert1": "0.005", "overflow_expert2": "16.323", "entropy_gating": "0.391", "expert1_balance_top": "30.838", "expert1_balance_bottom": "17.833", "unused_expert1_count": "0.488", "expert2_balance_top": "31.965", "expert2_balance_bottom": "17.277", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.785", "ppl": "13.79", "wps": "15280.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8710", "lr": "2.58e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "158393"}
2023-02-02 18:18:25 | INFO | train_inner | {"epoch": 11, "loss": "3.972", "moe_gate_loss": "12.8043", "overflow_expert1": "0.006", "overflow_expert2": "16.631", "entropy_gating": "0.392", "expert1_balance_top": "30.978", "expert1_balance_bottom": "17.701", "unused_expert1_count": "0.487", "expert2_balance_top": "32.063", "expert2_balance_bottom": "17.202", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.787", "ppl": "13.81", "wps": "15274.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8720", "lr": "2.56e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "158565"}
2023-02-02 18:21:17 | INFO | train_inner | {"epoch": 11, "loss": "3.987", "moe_gate_loss": "12.7858", "overflow_expert1": "0.004", "overflow_expert2": "16.423", "entropy_gating": "0.391", "expert1_balance_top": "30.883", "expert1_balance_bottom": "17.801", "unused_expert1_count": "0.484", "expert2_balance_top": "31.992", "expert2_balance_bottom": "17.242", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.803", "ppl": "13.96", "wps": "15262.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8730", "lr": "2.54e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "158736"}
2023-02-02 18:24:08 | INFO | train_inner | {"epoch": 11, "loss": "3.998", "moe_gate_loss": "12.7842", "overflow_expert1": "0.004", "overflow_expert2": "16.337", "entropy_gating": "0.391", "expert1_balance_top": "30.856", "expert1_balance_bottom": "17.812", "unused_expert1_count": "0.486", "expert2_balance_top": "31.93", "expert2_balance_bottom": "17.277", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.814", "ppl": "14.06", "wps": "15273.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8740", "lr": "2.52e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "158908"}
2023-02-02 18:27:00 | INFO | train_inner | {"epoch": 11, "loss": "3.957", "moe_gate_loss": "12.785", "overflow_expert1": "0.007", "overflow_expert2": "16.426", "entropy_gating": "0.391", "expert1_balance_top": "30.834", "expert1_balance_bottom": "17.802", "unused_expert1_count": "0.487", "expert2_balance_top": "31.989", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.772", "ppl": "13.66", "wps": "15275.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8750", "lr": "2.5e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "159080"}
2023-02-02 18:28:49 | INFO | valid_c4_small/C4_small | {"epoch": 11, "valid_c4_small/C4_small_loss": "4.212", "valid_c4_small/C4_small_moe_gate_loss": "12.4903", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.797", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.784", "valid_c4_small/C4_small_expert1_balance_bottom": "19.038", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.492", "valid_c4_small/C4_small_expert2_balance_bottom": "18.222", "valid_c4_small/C4_small_unused_expert2_count": "0.381", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.032", "valid_c4_small/C4_small_ppl": "16.35", "valid_c4_small/C4_small_wps": "52035.2", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "8750", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 18:28:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 8750 updates
2023-02-02 18:28:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 11 @ 8750 updates, score 4.212) (writing took 6.874961091671139 seconds)
2023-02-02 18:31:49 | INFO | train_inner | {"epoch": 11, "loss": "4", "moe_gate_loss": "12.8014", "overflow_expert1": "0.006", "overflow_expert2": "16.595", "entropy_gating": "0.392", "expert1_balance_top": "30.959", "expert1_balance_bottom": "17.715", "unused_expert1_count": "0.486", "expert2_balance_top": "32.01", "expert2_balance_bottom": "17.203", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.815", "ppl": "14.08", "wps": "9066.5", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "8760", "lr": "2.48e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "159369"}
2023-02-02 18:34:41 | INFO | train_inner | {"epoch": 11, "loss": "4.021", "moe_gate_loss": "12.7786", "overflow_expert1": "0.004", "overflow_expert2": "16.273", "entropy_gating": "0.392", "expert1_balance_top": "30.821", "expert1_balance_bottom": "17.834", "unused_expert1_count": "0.484", "expert2_balance_top": "31.93", "expert2_balance_bottom": "17.291", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15271.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8770", "lr": "2.46e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "159541"}
2023-02-02 18:37:32 | INFO | train_inner | {"epoch": 11, "loss": "4.037", "moe_gate_loss": "12.7794", "overflow_expert1": "0.005", "overflow_expert2": "16.32", "entropy_gating": "0.392", "expert1_balance_top": "30.827", "expert1_balance_bottom": "17.837", "unused_expert1_count": "0.488", "expert2_balance_top": "31.953", "expert2_balance_bottom": "17.275", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15281.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8780", "lr": "2.44e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "159712"}
2023-02-02 18:40:24 | INFO | train_inner | {"epoch": 11, "loss": "4.057", "moe_gate_loss": "12.7929", "overflow_expert1": "0.008", "overflow_expert2": "16.475", "entropy_gating": "0.392", "expert1_balance_top": "30.916", "expert1_balance_bottom": "17.765", "unused_expert1_count": "0.486", "expert2_balance_top": "32.017", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.872", "ppl": "14.64", "wps": "15275.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8790", "lr": "2.42e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "159884"}
2023-02-02 18:43:15 | INFO | train_inner | {"epoch": 11, "loss": "4.029", "moe_gate_loss": "12.7774", "overflow_expert1": "0.005", "overflow_expert2": "16.336", "entropy_gating": "0.392", "expert1_balance_top": "30.798", "expert1_balance_bottom": "17.849", "unused_expert1_count": "0.488", "expert2_balance_top": "31.935", "expert2_balance_bottom": "17.254", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.844", "ppl": "14.36", "wps": "15280.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8800", "lr": "2.4e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "160055"}
2023-02-02 18:46:07 | INFO | train_inner | {"epoch": 11, "loss": "4.069", "moe_gate_loss": "12.7854", "overflow_expert1": "0.004", "overflow_expert2": "16.409", "entropy_gating": "0.392", "expert1_balance_top": "30.864", "expert1_balance_bottom": "17.804", "unused_expert1_count": "0.488", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.244", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.884", "ppl": "14.77", "wps": "15277.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8810", "lr": "2.38e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "160227"}
2023-02-02 18:48:58 | INFO | train_inner | {"epoch": 11, "loss": "4.037", "moe_gate_loss": "12.7728", "overflow_expert1": "0.003", "overflow_expert2": "16.266", "entropy_gating": "0.392", "expert1_balance_top": "30.777", "expert1_balance_bottom": "17.869", "unused_expert1_count": "0.487", "expert2_balance_top": "31.923", "expert2_balance_bottom": "17.283", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15289.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8820", "lr": "2.36e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "160398"}
2023-02-02 18:51:50 | INFO | train_inner | {"epoch": 11, "loss": "4.037", "moe_gate_loss": "12.7784", "overflow_expert1": "0.003", "overflow_expert2": "16.275", "entropy_gating": "0.392", "expert1_balance_top": "30.82", "expert1_balance_bottom": "17.86", "unused_expert1_count": "0.488", "expert2_balance_top": "31.946", "expert2_balance_bottom": "17.287", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8830", "lr": "2.34e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "160570"}
2023-02-02 18:54:41 | INFO | train_inner | {"epoch": 11, "loss": "4.052", "moe_gate_loss": "12.7752", "overflow_expert1": "0.009", "overflow_expert2": "16.169", "entropy_gating": "0.393", "expert1_balance_top": "30.773", "expert1_balance_bottom": "17.871", "unused_expert1_count": "0.489", "expert2_balance_top": "31.905", "expert2_balance_bottom": "17.31", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.868", "ppl": "14.6", "wps": "15293.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8840", "lr": "2.32e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "160741"}
2023-02-02 18:57:33 | INFO | train_inner | {"epoch": 11, "loss": "4.03", "moe_gate_loss": "12.7861", "overflow_expert1": "0.005", "overflow_expert2": "16.351", "entropy_gating": "0.392", "expert1_balance_top": "30.863", "expert1_balance_bottom": "17.807", "unused_expert1_count": "0.49", "expert2_balance_top": "31.945", "expert2_balance_bottom": "17.254", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.845", "ppl": "14.37", "wps": "15282.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8850", "lr": "2.3e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "160913"}
2023-02-02 19:00:24 | INFO | train_inner | {"epoch": 11, "loss": "4.001", "moe_gate_loss": "12.7858", "overflow_expert1": "0.006", "overflow_expert2": "16.356", "entropy_gating": "0.392", "expert1_balance_top": "30.851", "expert1_balance_bottom": "17.818", "unused_expert1_count": "0.486", "expert2_balance_top": "31.954", "expert2_balance_bottom": "17.258", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.816", "ppl": "14.09", "wps": "15284.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8860", "lr": "2.28e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "161084"}
2023-02-02 19:03:16 | INFO | train_inner | {"epoch": 11, "loss": "4.037", "moe_gate_loss": "12.7886", "overflow_expert1": "0.005", "overflow_expert2": "16.5", "entropy_gating": "0.392", "expert1_balance_top": "30.883", "expert1_balance_bottom": "17.777", "unused_expert1_count": "0.487", "expert2_balance_top": "32.004", "expert2_balance_bottom": "17.21", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15289.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8870", "lr": "2.26e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "161256"}
2023-02-02 19:06:07 | INFO | train_inner | {"epoch": 11, "loss": "4.01", "moe_gate_loss": "12.7745", "overflow_expert1": "0.003", "overflow_expert2": "16.366", "entropy_gating": "0.392", "expert1_balance_top": "30.797", "expert1_balance_bottom": "17.866", "unused_expert1_count": "0.489", "expert2_balance_top": "31.967", "expert2_balance_bottom": "17.252", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15284.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8880", "lr": "2.24e-06", "gnorm": "1.181", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "161427"}
2023-02-02 19:08:59 | INFO | train_inner | {"epoch": 11, "loss": "4.045", "moe_gate_loss": "12.7751", "overflow_expert1": "0.006", "overflow_expert2": "16.268", "entropy_gating": "0.391", "expert1_balance_top": "30.784", "expert1_balance_bottom": "17.874", "unused_expert1_count": "0.483", "expert2_balance_top": "31.924", "expert2_balance_bottom": "17.291", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "15291.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8890", "lr": "2.22e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "161599"}
2023-02-02 19:11:50 | INFO | train_inner | {"epoch": 11, "loss": "4.029", "moe_gate_loss": "12.785", "overflow_expert1": "0.005", "overflow_expert2": "16.383", "entropy_gating": "0.392", "expert1_balance_top": "30.845", "expert1_balance_bottom": "17.818", "unused_expert1_count": "0.488", "expert2_balance_top": "31.952", "expert2_balance_bottom": "17.261", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.845", "ppl": "14.37", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8900", "lr": "2.2e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "161770"}
2023-02-02 19:14:42 | INFO | train_inner | {"epoch": 11, "loss": "4.054", "moe_gate_loss": "12.7938", "overflow_expert1": "0.006", "overflow_expert2": "16.484", "entropy_gating": "0.392", "expert1_balance_top": "30.91", "expert1_balance_bottom": "17.774", "unused_expert1_count": "0.487", "expert2_balance_top": "32", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.87", "ppl": "14.62", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8910", "lr": "2.18e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "161941"}
2023-02-02 19:17:33 | INFO | train_inner | {"epoch": 11, "loss": "4.038", "moe_gate_loss": "12.7817", "overflow_expert1": "0.005", "overflow_expert2": "16.32", "entropy_gating": "0.392", "expert1_balance_top": "30.826", "expert1_balance_bottom": "17.836", "unused_expert1_count": "0.489", "expert2_balance_top": "31.925", "expert2_balance_bottom": "17.268", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.854", "ppl": "14.46", "wps": "15290.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8920", "lr": "2.16e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "162113"}
2023-02-02 19:20:25 | INFO | train_inner | {"epoch": 11, "loss": "3.998", "moe_gate_loss": "12.7963", "overflow_expert1": "0.005", "overflow_expert2": "16.621", "entropy_gating": "0.393", "expert1_balance_top": "30.942", "expert1_balance_bottom": "17.742", "unused_expert1_count": "0.488", "expert2_balance_top": "32.059", "expert2_balance_bottom": "17.183", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.813", "ppl": "14.06", "wps": "15272.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8930", "lr": "2.14e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "162285"}
2023-02-02 19:23:16 | INFO | train_inner | {"epoch": 11, "loss": "4.017", "moe_gate_loss": "12.8059", "overflow_expert1": "0.005", "overflow_expert2": "16.661", "entropy_gating": "0.391", "expert1_balance_top": "31.015", "expert1_balance_bottom": "17.692", "unused_expert1_count": "0.486", "expert2_balance_top": "32.03", "expert2_balance_bottom": "17.181", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.832", "ppl": "14.24", "wps": "15287.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8940", "lr": "2.12e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "162456"}
2023-02-02 19:26:08 | INFO | train_inner | {"epoch": 11, "loss": "4.022", "moe_gate_loss": "12.7771", "overflow_expert1": "0.005", "overflow_expert2": "16.248", "entropy_gating": "0.392", "expert1_balance_top": "30.812", "expert1_balance_bottom": "17.86", "unused_expert1_count": "0.491", "expert2_balance_top": "31.885", "expert2_balance_bottom": "17.292", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.838", "ppl": "14.3", "wps": "15288.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8950", "lr": "2.1e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "162628"}
2023-02-02 19:28:59 | INFO | train_inner | {"epoch": 11, "loss": "4.047", "moe_gate_loss": "12.782", "overflow_expert1": "0.005", "overflow_expert2": "16.265", "entropy_gating": "0.392", "expert1_balance_top": "30.843", "expert1_balance_bottom": "17.839", "unused_expert1_count": "0.488", "expert2_balance_top": "31.894", "expert2_balance_bottom": "17.284", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.862", "ppl": "14.54", "wps": "15286.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8960", "lr": "2.08e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "162799"}
2023-02-02 19:31:51 | INFO | train_inner | {"epoch": 11, "loss": "4.051", "moe_gate_loss": "12.7749", "overflow_expert1": "0.005", "overflow_expert2": "16.156", "entropy_gating": "0.392", "expert1_balance_top": "30.802", "expert1_balance_bottom": "17.881", "unused_expert1_count": "0.487", "expert2_balance_top": "31.882", "expert2_balance_bottom": "17.335", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.866", "ppl": "14.58", "wps": "15283", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8970", "lr": "2.06e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "162971"}
2023-02-02 19:36:05 | INFO | valid_c4_small/C4_small | {"epoch": 11, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.4917", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.64", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.787", "valid_c4_small/C4_small_expert1_balance_bottom": "19.04", "valid_c4_small/C4_small_unused_expert1_count": "0.452", "valid_c4_small/C4_small_expert2_balance_top": "31.375", "valid_c4_small/C4_small_expert2_balance_bottom": "18.28", "valid_c4_small/C4_small_unused_expert2_count": "0.383", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.03", "valid_c4_small/C4_small_ppl": "16.34", "valid_c4_small/C4_small_wps": "52019", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "8978", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 19:36:05 | INFO | fairseq_cli.train | end of epoch 11 (average epoch stats below)
2023-02-02 19:36:05 | INFO | train | {"epoch": 11, "train_loss": "4.013", "train_moe_gate_loss": "12.7878", "train_overflow_expert1": "0.005", "train_overflow_expert2": "16.441", "train_entropy_gating": "0.392", "train_expert1_balance_top": "30.878", "train_expert1_balance_bottom": "17.783", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "31.977", "train_expert2_balance_bottom": "17.227", "train_unused_expert2_count": "0.448", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.828", "train_ppl": "14.2", "train_wps": "14787.8", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "8978", "train_lr": "2.044e-06", "train_gnorm": "1.205", "train_clip": "100", "train_loss_scale": "4", "train_train_wall": "13577", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "163225"}
2023-02-02 19:36:05 | INFO | fairseq.trainer | begin training epoch 12
2023-02-02 19:36:40 | INFO | train_inner | {"epoch": 12, "loss": "4.044", "moe_gate_loss": "12.7757", "overflow_expert1": "0.007", "overflow_expert2": "16.186", "entropy_gating": "0.392", "expert1_balance_top": "30.778", "expert1_balance_bottom": "17.874", "unused_expert1_count": "0.489", "expert2_balance_top": "31.903", "expert2_balance_bottom": "17.298", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "9069.4", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "8980", "lr": "2.04e-06", "gnorm": "1.19", "clip": "100", "loss_scale": "4", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "163260"}
2023-02-02 19:39:31 | INFO | train_inner | {"epoch": 12, "loss": "4.06", "moe_gate_loss": "12.7799", "overflow_expert1": "0.005", "overflow_expert2": "16.292", "entropy_gating": "0.392", "expert1_balance_top": "30.827", "expert1_balance_bottom": "17.828", "unused_expert1_count": "0.483", "expert2_balance_top": "31.923", "expert2_balance_bottom": "17.292", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.876", "ppl": "14.68", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "8990", "lr": "2.02e-06", "gnorm": "1.186", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "163431"}
2023-02-02 19:42:23 | INFO | train_inner | {"epoch": 12, "loss": "3.995", "moe_gate_loss": "12.7812", "overflow_expert1": "0.007", "overflow_expert2": "16.405", "entropy_gating": "0.392", "expert1_balance_top": "30.815", "expert1_balance_bottom": "17.839", "unused_expert1_count": "0.487", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.245", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.81", "ppl": "14.03", "wps": "15281.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9000", "lr": "2e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "163603"}
2023-02-02 19:44:12 | INFO | valid_c4_small/C4_small | {"epoch": 12, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.4825", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.836", "valid_c4_small/C4_small_entropy_gating": "0.422", "valid_c4_small/C4_small_expert1_balance_top": "30.693", "valid_c4_small/C4_small_expert1_balance_bottom": "19.113", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.565", "valid_c4_small/C4_small_expert2_balance_bottom": "18.184", "valid_c4_small/C4_small_unused_expert2_count": "0.385", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.031", "valid_c4_small/C4_small_ppl": "16.35", "valid_c4_small/C4_small_wps": "52075.1", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "9000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 19:44:12 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 9000 updates
2023-02-02 19:44:19 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 12 @ 9000 updates, score 4.211) (writing took 6.920142002869397 seconds)
2023-02-02 19:47:12 | INFO | train_inner | {"epoch": 12, "loss": "3.992", "moe_gate_loss": "12.7828", "overflow_expert1": "0.006", "overflow_expert2": "16.7", "entropy_gating": "0.393", "expert1_balance_top": "30.847", "expert1_balance_bottom": "17.795", "unused_expert1_count": "0.482", "expert2_balance_top": "32.138", "expert2_balance_bottom": "17.149", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.807", "ppl": "14", "wps": "9073.3", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "9010", "lr": "1.98e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "163892"}
2023-02-02 19:50:03 | INFO | train_inner | {"epoch": 12, "loss": "3.995", "moe_gate_loss": "12.7838", "overflow_expert1": "0.003", "overflow_expert2": "16.687", "entropy_gating": "0.393", "expert1_balance_top": "30.849", "expert1_balance_bottom": "17.782", "unused_expert1_count": "0.485", "expert2_balance_top": "32.121", "expert2_balance_bottom": "17.138", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.81", "ppl": "14.03", "wps": "15273", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9020", "lr": "1.96e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "164063"}
2023-02-02 19:52:55 | INFO | train_inner | {"epoch": 12, "loss": "3.941", "moe_gate_loss": "12.795", "overflow_expert1": "0.006", "overflow_expert2": "16.818", "entropy_gating": "0.392", "expert1_balance_top": "30.946", "expert1_balance_bottom": "17.713", "unused_expert1_count": "0.486", "expert2_balance_top": "32.107", "expert2_balance_bottom": "17.115", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.757", "ppl": "13.52", "wps": "15279.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9030", "lr": "1.94e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "164235"}
2023-02-02 19:55:46 | INFO | train_inner | {"epoch": 12, "loss": "3.96", "moe_gate_loss": "12.7789", "overflow_expert1": "0.003", "overflow_expert2": "16.561", "entropy_gating": "0.392", "expert1_balance_top": "30.824", "expert1_balance_bottom": "17.794", "unused_expert1_count": "0.488", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.156", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.775", "ppl": "13.69", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9040", "lr": "1.92e-06", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "164406"}
2023-02-02 19:58:38 | INFO | train_inner | {"epoch": 12, "loss": "3.975", "moe_gate_loss": "12.7864", "overflow_expert1": "0.003", "overflow_expert2": "16.511", "entropy_gating": "0.392", "expert1_balance_top": "30.866", "expert1_balance_bottom": "17.751", "unused_expert1_count": "0.49", "expert2_balance_top": "31.971", "expert2_balance_bottom": "17.178", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.79", "ppl": "13.84", "wps": "15286.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9050", "lr": "1.9e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "164578"}
2023-02-02 20:01:29 | INFO | train_inner | {"epoch": 12, "loss": "4.014", "moe_gate_loss": "12.7825", "overflow_expert1": "0.005", "overflow_expert2": "16.395", "entropy_gating": "0.392", "expert1_balance_top": "30.838", "expert1_balance_bottom": "17.781", "unused_expert1_count": "0.487", "expert2_balance_top": "31.953", "expert2_balance_bottom": "17.207", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.83", "ppl": "14.22", "wps": "15292.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9060", "lr": "1.88e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "164749"}
2023-02-02 20:04:21 | INFO | train_inner | {"epoch": 12, "loss": "4.002", "moe_gate_loss": "12.7781", "overflow_expert1": "0.003", "overflow_expert2": "16.325", "entropy_gating": "0.392", "expert1_balance_top": "30.813", "expert1_balance_bottom": "17.806", "unused_expert1_count": "0.489", "expert2_balance_top": "31.928", "expert2_balance_bottom": "17.218", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.818", "ppl": "14.1", "wps": "15290.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9070", "lr": "1.86e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "164921"}
2023-02-02 20:07:12 | INFO | train_inner | {"epoch": 12, "loss": "3.99", "moe_gate_loss": "12.785", "overflow_expert1": "0.004", "overflow_expert2": "16.397", "entropy_gating": "0.392", "expert1_balance_top": "30.863", "expert1_balance_bottom": "17.765", "unused_expert1_count": "0.484", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.806", "ppl": "13.99", "wps": "15290.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9080", "lr": "1.84e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "165092"}
2023-02-02 20:10:04 | INFO | train_inner | {"epoch": 12, "loss": "3.95", "moe_gate_loss": "12.7897", "overflow_expert1": "0.004", "overflow_expert2": "16.498", "entropy_gating": "0.392", "expert1_balance_top": "30.895", "expert1_balance_bottom": "17.744", "unused_expert1_count": "0.485", "expert2_balance_top": "31.994", "expert2_balance_bottom": "17.183", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.766", "ppl": "13.6", "wps": "15290.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9090", "lr": "1.82e-06", "gnorm": "1.214", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "165263"}
2023-02-02 20:12:55 | INFO | train_inner | {"epoch": 12, "loss": "3.994", "moe_gate_loss": "12.7778", "overflow_expert1": "0.003", "overflow_expert2": "16.325", "entropy_gating": "0.392", "expert1_balance_top": "30.811", "expert1_balance_bottom": "17.806", "unused_expert1_count": "0.486", "expert2_balance_top": "31.936", "expert2_balance_bottom": "17.242", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.81", "ppl": "14.02", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9100", "lr": "1.8e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "165435"}
2023-02-02 20:15:47 | INFO | train_inner | {"epoch": 12, "loss": "3.997", "moe_gate_loss": "12.795", "overflow_expert1": "0.004", "overflow_expert2": "16.556", "entropy_gating": "0.392", "expert1_balance_top": "30.945", "expert1_balance_bottom": "17.733", "unused_expert1_count": "0.483", "expert2_balance_top": "31.974", "expert2_balance_bottom": "17.194", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.812", "ppl": "14.05", "wps": "15283.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9110", "lr": "1.78e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "165607"}
2023-02-02 20:18:38 | INFO | train_inner | {"epoch": 12, "loss": "4.025", "moe_gate_loss": "12.7901", "overflow_expert1": "0.005", "overflow_expert2": "16.451", "entropy_gating": "0.392", "expert1_balance_top": "30.891", "expert1_balance_bottom": "17.768", "unused_expert1_count": "0.483", "expert2_balance_top": "31.964", "expert2_balance_bottom": "17.214", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.84", "ppl": "14.32", "wps": "15286.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9120", "lr": "1.76e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "165778"}
2023-02-02 20:21:29 | INFO | train_inner | {"epoch": 12, "loss": "4.006", "moe_gate_loss": "12.7843", "overflow_expert1": "0.007", "overflow_expert2": "16.376", "entropy_gating": "0.392", "expert1_balance_top": "30.843", "expert1_balance_bottom": "17.804", "unused_expert1_count": "0.488", "expert2_balance_top": "31.951", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.822", "ppl": "14.14", "wps": "15294.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9130", "lr": "1.74e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "165949"}
2023-02-02 20:24:21 | INFO | train_inner | {"epoch": 12, "loss": "3.982", "moe_gate_loss": "12.7876", "overflow_expert1": "0.005", "overflow_expert2": "16.438", "entropy_gating": "0.392", "expert1_balance_top": "30.869", "expert1_balance_bottom": "17.785", "unused_expert1_count": "0.49", "expert2_balance_top": "31.937", "expert2_balance_bottom": "17.228", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.797", "ppl": "13.9", "wps": "15284.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9140", "lr": "1.72e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "166121"}
2023-02-02 20:27:13 | INFO | train_inner | {"epoch": 12, "loss": "4.074", "moe_gate_loss": "12.8082", "overflow_expert1": "0.005", "overflow_expert2": "16.64", "entropy_gating": "0.393", "expert1_balance_top": "31.011", "expert1_balance_bottom": "17.656", "unused_expert1_count": "0.49", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.165", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.889", "ppl": "14.81", "wps": "15283.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9150", "lr": "1.7e-06", "gnorm": "1.262", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "166292"}
2023-02-02 20:30:04 | INFO | train_inner | {"epoch": 12, "loss": "3.982", "moe_gate_loss": "12.7894", "overflow_expert1": "0.005", "overflow_expert2": "16.534", "entropy_gating": "0.392", "expert1_balance_top": "30.882", "expert1_balance_bottom": "17.778", "unused_expert1_count": "0.488", "expert2_balance_top": "32.004", "expert2_balance_bottom": "17.19", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.798", "ppl": "13.91", "wps": "15284.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9160", "lr": "1.68e-06", "gnorm": "1.204", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "166464"}
2023-02-02 20:32:56 | INFO | train_inner | {"epoch": 12, "loss": "4.008", "moe_gate_loss": "12.7799", "overflow_expert1": "0.003", "overflow_expert2": "16.408", "entropy_gating": "0.392", "expert1_balance_top": "30.801", "expert1_balance_bottom": "17.825", "unused_expert1_count": "0.49", "expert2_balance_top": "31.962", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.16", "wps": "15283", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9170", "lr": "1.66e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "166635"}
2023-02-02 20:35:47 | INFO | train_inner | {"epoch": 12, "loss": "3.989", "moe_gate_loss": "12.7938", "overflow_expert1": "0.003", "overflow_expert2": "16.566", "entropy_gating": "0.392", "expert1_balance_top": "30.917", "expert1_balance_bottom": "17.736", "unused_expert1_count": "0.488", "expert2_balance_top": "31.998", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.805", "ppl": "13.97", "wps": "15286.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9180", "lr": "1.64e-06", "gnorm": "1.209", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "166807"}
2023-02-02 20:38:39 | INFO | train_inner | {"epoch": 12, "loss": "3.999", "moe_gate_loss": "12.7997", "overflow_expert1": "0.006", "overflow_expert2": "16.607", "entropy_gating": "0.392", "expert1_balance_top": "30.938", "expert1_balance_bottom": "17.726", "unused_expert1_count": "0.487", "expert2_balance_top": "32.043", "expert2_balance_bottom": "17.184", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.815", "ppl": "14.07", "wps": "15274.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9190", "lr": "1.62e-06", "gnorm": "1.232", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "166979"}
2023-02-02 20:41:30 | INFO | train_inner | {"epoch": 12, "loss": "4.015", "moe_gate_loss": "12.7771", "overflow_expert1": "0.004", "overflow_expert2": "16.259", "entropy_gating": "0.392", "expert1_balance_top": "30.786", "expert1_balance_bottom": "17.839", "unused_expert1_count": "0.488", "expert2_balance_top": "31.901", "expert2_balance_bottom": "17.285", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.831", "ppl": "14.23", "wps": "15291.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9200", "lr": "1.6e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "167150"}
2023-02-02 20:44:22 | INFO | train_inner | {"epoch": 12, "loss": "4.012", "moe_gate_loss": "12.7849", "overflow_expert1": "0.005", "overflow_expert2": "16.354", "entropy_gating": "0.392", "expert1_balance_top": "30.85", "expert1_balance_bottom": "17.821", "unused_expert1_count": "0.485", "expert2_balance_top": "31.937", "expert2_balance_bottom": "17.247", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.827", "ppl": "14.19", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9210", "lr": "1.58e-06", "gnorm": "1.2", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "167321"}
2023-02-02 20:47:13 | INFO | train_inner | {"epoch": 12, "loss": "3.994", "moe_gate_loss": "12.7934", "overflow_expert1": "0.004", "overflow_expert2": "16.454", "entropy_gating": "0.392", "expert1_balance_top": "30.89", "expert1_balance_bottom": "17.762", "unused_expert1_count": "0.483", "expert2_balance_top": "31.982", "expert2_balance_bottom": "17.228", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.809", "ppl": "14.02", "wps": "15282.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9220", "lr": "1.56e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "167493"}
2023-02-02 20:50:04 | INFO | train_inner | {"epoch": 12, "loss": "3.997", "moe_gate_loss": "12.7831", "overflow_expert1": "0.005", "overflow_expert2": "16.354", "entropy_gating": "0.392", "expert1_balance_top": "30.83", "expert1_balance_bottom": "17.813", "unused_expert1_count": "0.485", "expert2_balance_top": "31.955", "expert2_balance_bottom": "17.248", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.813", "ppl": "14.05", "wps": "15294.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9230", "lr": "1.54e-06", "gnorm": "1.203", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "167664"}
2023-02-02 20:52:56 | INFO | train_inner | {"epoch": 12, "loss": "3.981", "moe_gate_loss": "12.7813", "overflow_expert1": "0.006", "overflow_expert2": "16.339", "entropy_gating": "0.392", "expert1_balance_top": "30.844", "expert1_balance_bottom": "17.83", "unused_expert1_count": "0.489", "expert2_balance_top": "31.954", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.796", "ppl": "13.89", "wps": "15292.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9240", "lr": "1.52e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "167836"}
2023-02-02 20:55:47 | INFO | train_inner | {"epoch": 12, "loss": "4.038", "moe_gate_loss": "12.7883", "overflow_expert1": "0.004", "overflow_expert2": "16.424", "entropy_gating": "0.392", "expert1_balance_top": "30.881", "expert1_balance_bottom": "17.79", "unused_expert1_count": "0.488", "expert2_balance_top": "31.973", "expert2_balance_bottom": "17.246", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15287.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9250", "lr": "1.5e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "168007"}
2023-02-02 20:57:37 | INFO | valid_c4_small/C4_small | {"epoch": 12, "valid_c4_small/C4_small_loss": "4.214", "valid_c4_small/C4_small_moe_gate_loss": "12.4928", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.697", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.798", "valid_c4_small/C4_small_expert1_balance_bottom": "19.032", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.403", "valid_c4_small/C4_small_expert2_balance_bottom": "18.24", "valid_c4_small/C4_small_unused_expert2_count": "0.386", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.034", "valid_c4_small/C4_small_ppl": "16.38", "valid_c4_small/C4_small_wps": "52051.2", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "9250", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 20:57:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 9250 updates
2023-02-02 20:57:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 12 @ 9250 updates, score 4.214) (writing took 6.884206750895828 seconds)
2023-02-02 21:00:36 | INFO | train_inner | {"epoch": 12, "loss": "3.961", "moe_gate_loss": "12.7928", "overflow_expert1": "0.005", "overflow_expert2": "16.491", "entropy_gating": "0.392", "expert1_balance_top": "30.914", "expert1_balance_bottom": "17.762", "unused_expert1_count": "0.484", "expert2_balance_top": "31.985", "expert2_balance_bottom": "17.215", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.776", "ppl": "13.7", "wps": "9070.8", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "9260", "lr": "1.48e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "8", "train_wall": "168", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "168296"}
2023-02-02 21:03:28 | INFO | train_inner | {"epoch": 12, "loss": "4.027", "moe_gate_loss": "12.7806", "overflow_expert1": "0.003", "overflow_expert2": "16.405", "entropy_gating": "0.393", "expert1_balance_top": "30.828", "expert1_balance_bottom": "17.81", "unused_expert1_count": "0.486", "expert2_balance_top": "31.953", "expert2_balance_bottom": "17.23", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9270", "lr": "1.46e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "168468"}
2023-02-02 21:06:19 | INFO | train_inner | {"epoch": 12, "loss": "4.046", "moe_gate_loss": "12.7775", "overflow_expert1": "0.005", "overflow_expert2": "16.333", "entropy_gating": "0.393", "expert1_balance_top": "30.779", "expert1_balance_bottom": "17.863", "unused_expert1_count": "0.481", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.238", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.862", "ppl": "14.54", "wps": "15288.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9280", "lr": "1.44e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "168639"}
2023-02-02 21:09:11 | INFO | train_inner | {"epoch": 12, "loss": "4.038", "moe_gate_loss": "12.7982", "overflow_expert1": "0.007", "overflow_expert2": "16.526", "entropy_gating": "0.392", "expert1_balance_top": "30.939", "expert1_balance_bottom": "17.748", "unused_expert1_count": "0.49", "expert2_balance_top": "31.96", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.853", "ppl": "14.45", "wps": "15280.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9290", "lr": "1.42e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "168811"}
2023-02-02 21:12:02 | INFO | train_inner | {"epoch": 12, "loss": "3.974", "moe_gate_loss": "12.7946", "overflow_expert1": "0.005", "overflow_expert2": "16.547", "entropy_gating": "0.392", "expert1_balance_top": "30.917", "expert1_balance_bottom": "17.746", "unused_expert1_count": "0.486", "expert2_balance_top": "32.018", "expert2_balance_bottom": "17.201", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.789", "ppl": "13.82", "wps": "15287.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9300", "lr": "1.4e-06", "gnorm": "1.194", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "168982"}
2023-02-02 21:14:54 | INFO | train_inner | {"epoch": 12, "loss": "3.99", "moe_gate_loss": "12.775", "overflow_expert1": "0.003", "overflow_expert2": "16.271", "entropy_gating": "0.392", "expert1_balance_top": "30.786", "expert1_balance_bottom": "17.851", "unused_expert1_count": "0.486", "expert2_balance_top": "31.925", "expert2_balance_bottom": "17.271", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.806", "ppl": "13.98", "wps": "15289.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9310", "lr": "1.38e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "169154"}
2023-02-02 21:17:45 | INFO | train_inner | {"epoch": 12, "loss": "4.012", "moe_gate_loss": "12.7808", "overflow_expert1": "0.004", "overflow_expert2": "16.305", "entropy_gating": "0.392", "expert1_balance_top": "30.809", "expert1_balance_bottom": "17.843", "unused_expert1_count": "0.481", "expert2_balance_top": "31.942", "expert2_balance_bottom": "17.256", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.827", "ppl": "14.19", "wps": "15292.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9320", "lr": "1.36e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "169325"}
2023-02-02 21:20:37 | INFO | train_inner | {"epoch": 12, "loss": "4.018", "moe_gate_loss": "12.7908", "overflow_expert1": "0.009", "overflow_expert2": "16.44", "entropy_gating": "0.392", "expert1_balance_top": "30.891", "expert1_balance_bottom": "17.785", "unused_expert1_count": "0.489", "expert2_balance_top": "31.982", "expert2_balance_bottom": "17.222", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.833", "ppl": "14.25", "wps": "15290.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9330", "lr": "1.34e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "169497"}
2023-02-02 21:23:28 | INFO | train_inner | {"epoch": 12, "loss": "4.048", "moe_gate_loss": "12.7758", "overflow_expert1": "0.005", "overflow_expert2": "16.23", "entropy_gating": "0.393", "expert1_balance_top": "30.773", "expert1_balance_bottom": "17.865", "unused_expert1_count": "0.489", "expert2_balance_top": "31.9", "expert2_balance_bottom": "17.278", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.864", "ppl": "14.56", "wps": "15288", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9340", "lr": "1.32e-06", "gnorm": "1.202", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "169668"}
2023-02-02 21:26:20 | INFO | train_inner | {"epoch": 12, "loss": "3.972", "moe_gate_loss": "12.7933", "overflow_expert1": "0.006", "overflow_expert2": "16.419", "entropy_gating": "0.393", "expert1_balance_top": "30.902", "expert1_balance_bottom": "17.765", "unused_expert1_count": "0.485", "expert2_balance_top": "31.945", "expert2_balance_bottom": "17.247", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.787", "ppl": "13.8", "wps": "15285.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9350", "lr": "1.3e-06", "gnorm": "1.206", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "169840"}
2023-02-02 21:29:11 | INFO | train_inner | {"epoch": 12, "loss": "4.004", "moe_gate_loss": "12.7846", "overflow_expert1": "0.002", "overflow_expert2": "16.43", "entropy_gating": "0.392", "expert1_balance_top": "30.864", "expert1_balance_bottom": "17.799", "unused_expert1_count": "0.487", "expert2_balance_top": "31.977", "expert2_balance_bottom": "17.222", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.819", "ppl": "14.12", "wps": "15285.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9360", "lr": "1.28e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "170011"}
2023-02-02 21:32:03 | INFO | train_inner | {"epoch": 12, "loss": "4.011", "moe_gate_loss": "12.7845", "overflow_expert1": "0.005", "overflow_expert2": "16.38", "entropy_gating": "0.392", "expert1_balance_top": "30.844", "expert1_balance_bottom": "17.822", "unused_expert1_count": "0.487", "expert2_balance_top": "31.957", "expert2_balance_bottom": "17.249", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.19", "wps": "15283.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9370", "lr": "1.26e-06", "gnorm": "1.212", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "170183"}
2023-02-02 21:34:54 | INFO | train_inner | {"epoch": 12, "loss": "3.988", "moe_gate_loss": "12.7911", "overflow_expert1": "0.006", "overflow_expert2": "16.51", "entropy_gating": "0.392", "expert1_balance_top": "30.883", "expert1_balance_bottom": "17.773", "unused_expert1_count": "0.488", "expert2_balance_top": "32.023", "expert2_balance_bottom": "17.211", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.803", "ppl": "13.96", "wps": "15279.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9380", "lr": "1.24e-06", "gnorm": "1.199", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "170354"}
2023-02-02 21:37:46 | INFO | train_inner | {"epoch": 12, "loss": "3.99", "moe_gate_loss": "12.7932", "overflow_expert1": "0.007", "overflow_expert2": "16.516", "entropy_gating": "0.392", "expert1_balance_top": "30.913", "expert1_balance_bottom": "17.762", "unused_expert1_count": "0.484", "expert2_balance_top": "32.004", "expert2_balance_bottom": "17.206", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.805", "ppl": "13.98", "wps": "15290.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9390", "lr": "1.22e-06", "gnorm": "1.198", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "170526"}
2023-02-02 21:40:37 | INFO | train_inner | {"epoch": 12, "loss": "4.035", "moe_gate_loss": "12.8006", "overflow_expert1": "0.007", "overflow_expert2": "16.556", "entropy_gating": "0.393", "expert1_balance_top": "30.953", "expert1_balance_bottom": "17.722", "unused_expert1_count": "0.486", "expert2_balance_top": "32.015", "expert2_balance_bottom": "17.196", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.85", "ppl": "14.42", "wps": "15298.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9400", "lr": "1.2e-06", "gnorm": "1.201", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "170697"}
2023-02-02 21:43:46 | INFO | train_inner | {"epoch": 12, "loss": "3.999", "moe_gate_loss": "12.7922", "overflow_expert1": "0.007", "overflow_expert2": "16.476", "entropy_gating": "0.393", "expert1_balance_top": "30.888", "expert1_balance_bottom": "17.768", "unused_expert1_count": "0.488", "expert2_balance_top": "32.003", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.814", "ppl": "14.07", "wps": "13907.4", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "9410", "lr": "1.18e-06", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "170885"}
2023-02-02 21:46:37 | INFO | train_inner | {"epoch": 12, "loss": "4.009", "moe_gate_loss": "12.7837", "overflow_expert1": "0.006", "overflow_expert2": "16.36", "entropy_gating": "0.392", "expert1_balance_top": "30.838", "expert1_balance_bottom": "17.808", "unused_expert1_count": "0.489", "expert2_balance_top": "31.948", "expert2_balance_bottom": "17.258", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.824", "ppl": "14.17", "wps": "15279", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9420", "lr": "1.16e-06", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "171057"}
2023-02-02 21:49:29 | INFO | train_inner | {"epoch": 12, "loss": "4.114", "moe_gate_loss": "12.7942", "overflow_expert1": "0.004", "overflow_expert2": "16.538", "entropy_gating": "0.393", "expert1_balance_top": "30.923", "expert1_balance_bottom": "17.741", "unused_expert1_count": "0.483", "expert2_balance_top": "32.033", "expert2_balance_bottom": "17.195", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.929", "ppl": "15.24", "wps": "15275.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9430", "lr": "1.14e-06", "gnorm": "1.197", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "171229"}
2023-02-02 21:52:20 | INFO | train_inner | {"epoch": 12, "loss": "4.022", "moe_gate_loss": "12.7781", "overflow_expert1": "0.002", "overflow_expert2": "16.302", "entropy_gating": "0.392", "expert1_balance_top": "30.814", "expert1_balance_bottom": "17.822", "unused_expert1_count": "0.485", "expert2_balance_top": "31.935", "expert2_balance_bottom": "17.263", "unused_expert2_count": "0.451", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.837", "ppl": "14.29", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9440", "lr": "1.12e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "171400"}
2023-02-02 21:55:12 | INFO | train_inner | {"epoch": 12, "loss": "3.996", "moe_gate_loss": "12.7901", "overflow_expert1": "0.005", "overflow_expert2": "16.431", "entropy_gating": "0.392", "expert1_balance_top": "30.89", "expert1_balance_bottom": "17.773", "unused_expert1_count": "0.487", "expert2_balance_top": "31.979", "expert2_balance_bottom": "17.229", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.811", "ppl": "14.04", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9450", "lr": "1.1e-06", "gnorm": "1.208", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "171572"}
2023-02-02 21:58:03 | INFO | train_inner | {"epoch": 12, "loss": "4.005", "moe_gate_loss": "12.7977", "overflow_expert1": "0.004", "overflow_expert2": "16.492", "entropy_gating": "0.393", "expert1_balance_top": "30.931", "expert1_balance_bottom": "17.739", "unused_expert1_count": "0.489", "expert2_balance_top": "32.012", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.455", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.13", "wps": "15288.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9460", "lr": "1.08e-06", "gnorm": "1.205", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "171743"}
2023-02-02 22:00:55 | INFO | train_inner | {"epoch": 12, "loss": "4.01", "moe_gate_loss": "12.7803", "overflow_expert1": "0.005", "overflow_expert2": "16.319", "entropy_gating": "0.393", "expert1_balance_top": "30.815", "expert1_balance_bottom": "17.826", "unused_expert1_count": "0.49", "expert2_balance_top": "31.937", "expert2_balance_bottom": "17.26", "unused_expert2_count": "0.456", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15293", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9470", "lr": "1.06e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "171914"}
2023-02-02 22:03:46 | INFO | train_inner | {"epoch": 12, "loss": "3.977", "moe_gate_loss": "12.7813", "overflow_expert1": "0.005", "overflow_expert2": "16.324", "entropy_gating": "0.393", "expert1_balance_top": "30.822", "expert1_balance_bottom": "17.835", "unused_expert1_count": "0.485", "expert2_balance_top": "31.945", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.453", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.792", "ppl": "13.85", "wps": "15288.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9480", "lr": "1.04e-06", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "172086"}
2023-02-02 22:06:37 | INFO | train_inner | {"epoch": 12, "loss": "3.992", "moe_gate_loss": "12.8006", "overflow_expert1": "0.008", "overflow_expert2": "16.606", "entropy_gating": "0.392", "expert1_balance_top": "30.935", "expert1_balance_bottom": "17.709", "unused_expert1_count": "0.488", "expert2_balance_top": "32.064", "expert2_balance_bottom": "17.16", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.808", "ppl": "14", "wps": "15300.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9490", "lr": "1.02e-06", "gnorm": "1.217", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "172257"}
2023-02-02 22:09:29 | INFO | train_inner | {"epoch": 12, "loss": "4.004", "moe_gate_loss": "12.7878", "overflow_expert1": "0.005", "overflow_expert2": "16.442", "entropy_gating": "0.392", "expert1_balance_top": "30.88", "expert1_balance_bottom": "17.791", "unused_expert1_count": "0.485", "expert2_balance_top": "31.979", "expert2_balance_bottom": "17.232", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.12", "wps": "15290.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9500", "lr": "1e-06", "gnorm": "1.196", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "172429"}
2023-02-02 22:11:18 | INFO | valid_c4_small/C4_small | {"epoch": 12, "valid_c4_small/C4_small_loss": "4.212", "valid_c4_small/C4_small_moe_gate_loss": "12.4919", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.679", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.799", "valid_c4_small/C4_small_expert1_balance_bottom": "19.048", "valid_c4_small/C4_small_unused_expert1_count": "0.454", "valid_c4_small/C4_small_expert2_balance_top": "31.448", "valid_c4_small/C4_small_expert2_balance_bottom": "18.249", "valid_c4_small/C4_small_unused_expert2_count": "0.386", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.032", "valid_c4_small/C4_small_ppl": "16.36", "valid_c4_small/C4_small_wps": "52079", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "9500", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 22:11:18 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 9500 updates
2023-02-02 22:11:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 12 @ 9500 updates, score 4.212) (writing took 6.84121078113094 seconds)
2023-02-02 22:14:18 | INFO | train_inner | {"epoch": 12, "loss": "4.028", "moe_gate_loss": "12.78", "overflow_expert1": "0.003", "overflow_expert2": "16.297", "entropy_gating": "0.392", "expert1_balance_top": "30.822", "expert1_balance_bottom": "17.845", "unused_expert1_count": "0.485", "expert2_balance_top": "31.945", "expert2_balance_bottom": "17.274", "unused_expert2_count": "0.443", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.843", "ppl": "14.35", "wps": "9075.9", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "9510", "lr": "9.8e-07", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "172718"}
2023-02-02 22:17:09 | INFO | train_inner | {"epoch": 12, "loss": "3.983", "moe_gate_loss": "12.7979", "overflow_expert1": "0.007", "overflow_expert2": "16.501", "entropy_gating": "0.392", "expert1_balance_top": "30.945", "expert1_balance_bottom": "17.731", "unused_expert1_count": "0.485", "expert2_balance_top": "31.98", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.798", "ppl": "13.91", "wps": "15283.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9520", "lr": "9.6e-07", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "172889"}
2023-02-02 22:20:01 | INFO | train_inner | {"epoch": 12, "loss": "4.003", "moe_gate_loss": "12.7859", "overflow_expert1": "0.007", "overflow_expert2": "16.392", "entropy_gating": "0.392", "expert1_balance_top": "30.858", "expert1_balance_bottom": "17.809", "unused_expert1_count": "0.486", "expert2_balance_top": "31.982", "expert2_balance_bottom": "17.248", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.819", "ppl": "14.11", "wps": "15285.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9530", "lr": "9.4e-07", "gnorm": "1.207", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "173061"}
2023-02-02 22:22:52 | INFO | train_inner | {"epoch": 12, "loss": "3.958", "moe_gate_loss": "12.7994", "overflow_expert1": "0.003", "overflow_expert2": "16.581", "entropy_gating": "0.392", "expert1_balance_top": "30.954", "expert1_balance_bottom": "17.716", "unused_expert1_count": "0.489", "expert2_balance_top": "32.033", "expert2_balance_bottom": "17.212", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.773", "ppl": "13.67", "wps": "15291", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9540", "lr": "9.2e-07", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "173232"}
2023-02-02 22:25:44 | INFO | train_inner | {"epoch": 12, "loss": "3.999", "moe_gate_loss": "12.7869", "overflow_expert1": "0.005", "overflow_expert2": "16.375", "entropy_gating": "0.392", "expert1_balance_top": "30.885", "expert1_balance_bottom": "17.784", "unused_expert1_count": "0.488", "expert2_balance_top": "31.978", "expert2_balance_bottom": "17.255", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.814", "ppl": "14.07", "wps": "15284.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9550", "lr": "9e-07", "gnorm": "1.197", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "173404"}
2023-02-02 22:28:35 | INFO | train_inner | {"epoch": 12, "loss": "3.931", "moe_gate_loss": "12.7861", "overflow_expert1": "0.006", "overflow_expert2": "16.337", "entropy_gating": "0.392", "expert1_balance_top": "30.85", "expert1_balance_bottom": "17.799", "unused_expert1_count": "0.486", "expert2_balance_top": "31.93", "expert2_balance_bottom": "17.273", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.747", "ppl": "13.42", "wps": "15290.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9560", "lr": "8.8e-07", "gnorm": "1.204", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "173575"}
2023-02-02 22:31:26 | INFO | train_inner | {"epoch": 12, "loss": "4.005", "moe_gate_loss": "12.7905", "overflow_expert1": "0.006", "overflow_expert2": "16.404", "entropy_gating": "0.392", "expert1_balance_top": "30.862", "expert1_balance_bottom": "17.783", "unused_expert1_count": "0.486", "expert2_balance_top": "31.977", "expert2_balance_bottom": "17.234", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.821", "ppl": "14.13", "wps": "15294.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9570", "lr": "8.6e-07", "gnorm": "1.213", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "173746"}
2023-02-02 22:34:18 | INFO | train_inner | {"epoch": 12, "loss": "4.036", "moe_gate_loss": "12.7863", "overflow_expert1": "0.005", "overflow_expert2": "16.359", "entropy_gating": "0.392", "expert1_balance_top": "30.861", "expert1_balance_bottom": "17.802", "unused_expert1_count": "0.489", "expert2_balance_top": "31.952", "expert2_balance_bottom": "17.257", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.852", "ppl": "14.44", "wps": "15289.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9580", "lr": "8.4e-07", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "173918"}
2023-02-02 22:37:09 | INFO | train_inner | {"epoch": 12, "loss": "3.977", "moe_gate_loss": "12.7744", "overflow_expert1": "0.004", "overflow_expert2": "16.226", "entropy_gating": "0.392", "expert1_balance_top": "30.781", "expert1_balance_bottom": "17.87", "unused_expert1_count": "0.484", "expert2_balance_top": "31.927", "expert2_balance_bottom": "17.291", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.793", "ppl": "13.86", "wps": "15294.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9590", "lr": "8.2e-07", "gnorm": "1.186", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "174089"}
2023-02-02 22:40:01 | INFO | train_inner | {"epoch": 12, "loss": "4.055", "moe_gate_loss": "12.7811", "overflow_expert1": "0.006", "overflow_expert2": "16.302", "entropy_gating": "0.392", "expert1_balance_top": "30.828", "expert1_balance_bottom": "17.836", "unused_expert1_count": "0.486", "expert2_balance_top": "31.934", "expert2_balance_bottom": "17.278", "unused_expert2_count": "0.449", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.87", "ppl": "14.62", "wps": "15296.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9600", "lr": "8e-07", "gnorm": "1.199", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "174261"}
2023-02-02 22:42:52 | INFO | train_inner | {"epoch": 12, "loss": "4.019", "moe_gate_loss": "12.7927", "overflow_expert1": "0.006", "overflow_expert2": "16.439", "entropy_gating": "0.392", "expert1_balance_top": "30.897", "expert1_balance_bottom": "17.76", "unused_expert1_count": "0.487", "expert2_balance_top": "31.972", "expert2_balance_bottom": "17.245", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.834", "ppl": "14.26", "wps": "15286", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9610", "lr": "7.8e-07", "gnorm": "1.21", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "174432"}
2023-02-02 22:45:44 | INFO | train_inner | {"epoch": 12, "loss": "4.072", "moe_gate_loss": "12.7803", "overflow_expert1": "0.005", "overflow_expert2": "16.299", "entropy_gating": "0.392", "expert1_balance_top": "30.814", "expert1_balance_bottom": "17.843", "unused_expert1_count": "0.487", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.275", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.888", "ppl": "14.8", "wps": "15290.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9620", "lr": "7.6e-07", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "174604"}
2023-02-02 22:48:35 | INFO | train_inner | {"epoch": 12, "loss": "4.052", "moe_gate_loss": "12.7759", "overflow_expert1": "0.004", "overflow_expert2": "16.252", "entropy_gating": "0.391", "expert1_balance_top": "30.788", "expert1_balance_bottom": "17.851", "unused_expert1_count": "0.487", "expert2_balance_top": "31.92", "expert2_balance_bottom": "17.276", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.867", "ppl": "14.6", "wps": "15288", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9630", "lr": "7.4e-07", "gnorm": "1.197", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "174775"}
2023-02-02 22:51:27 | INFO | train_inner | {"epoch": 12, "loss": "4.032", "moe_gate_loss": "12.7716", "overflow_expert1": "0.003", "overflow_expert2": "16.201", "entropy_gating": "0.392", "expert1_balance_top": "30.769", "expert1_balance_bottom": "17.885", "unused_expert1_count": "0.483", "expert2_balance_top": "31.9", "expert2_balance_bottom": "17.301", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.847", "ppl": "14.39", "wps": "15289.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9640", "lr": "7.2e-07", "gnorm": "1.194", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "174946"}
2023-02-02 22:54:18 | INFO | train_inner | {"epoch": 12, "loss": "4.05", "moe_gate_loss": "12.7762", "overflow_expert1": "0.004", "overflow_expert2": "16.262", "entropy_gating": "0.392", "expert1_balance_top": "30.778", "expert1_balance_bottom": "17.86", "unused_expert1_count": "0.487", "expert2_balance_top": "31.936", "expert2_balance_bottom": "17.285", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.865", "ppl": "14.57", "wps": "15290.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9650", "lr": "7e-07", "gnorm": "1.212", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "175118"}
2023-02-02 22:57:09 | INFO | train_inner | {"epoch": 12, "loss": "4.022", "moe_gate_loss": "12.7904", "overflow_expert1": "0.009", "overflow_expert2": "16.417", "entropy_gating": "0.393", "expert1_balance_top": "30.866", "expert1_balance_bottom": "17.797", "unused_expert1_count": "0.483", "expert2_balance_top": "31.983", "expert2_balance_bottom": "17.233", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.837", "ppl": "14.29", "wps": "15294.2", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9660", "lr": "6.8e-07", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "175289"}
2023-02-02 23:00:01 | INFO | train_inner | {"epoch": 12, "loss": "4.015", "moe_gate_loss": "12.7752", "overflow_expert1": "0.004", "overflow_expert2": "16.243", "entropy_gating": "0.392", "expert1_balance_top": "30.786", "expert1_balance_bottom": "17.861", "unused_expert1_count": "0.489", "expert2_balance_top": "31.918", "expert2_balance_bottom": "17.292", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.83", "ppl": "14.23", "wps": "15294.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9670", "lr": "6.6e-07", "gnorm": "1.192", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "175461"}
2023-02-02 23:02:52 | INFO | train_inner | {"epoch": 12, "loss": "4.021", "moe_gate_loss": "12.7883", "overflow_expert1": "0.007", "overflow_expert2": "16.432", "entropy_gating": "0.392", "expert1_balance_top": "30.871", "expert1_balance_bottom": "17.797", "unused_expert1_count": "0.489", "expert2_balance_top": "32.003", "expert2_balance_bottom": "17.236", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15288.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9680", "lr": "6.4e-07", "gnorm": "1.19", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "175632"}
2023-02-02 23:05:44 | INFO | train_inner | {"epoch": 12, "loss": "4.028", "moe_gate_loss": "12.7834", "overflow_expert1": "0.005", "overflow_expert2": "16.376", "entropy_gating": "0.392", "expert1_balance_top": "30.845", "expert1_balance_bottom": "17.807", "unused_expert1_count": "0.49", "expert2_balance_top": "31.959", "expert2_balance_bottom": "17.246", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.843", "ppl": "14.35", "wps": "15280.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9690", "lr": "6.2e-07", "gnorm": "1.2", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "175804"}
2023-02-02 23:08:35 | INFO | train_inner | {"epoch": 12, "loss": "4.02", "moe_gate_loss": "12.7717", "overflow_expert1": "0.005", "overflow_expert2": "16.219", "entropy_gating": "0.392", "expert1_balance_top": "30.757", "expert1_balance_bottom": "17.895", "unused_expert1_count": "0.487", "expert2_balance_top": "31.919", "expert2_balance_bottom": "17.296", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15293.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9700", "lr": "6e-07", "gnorm": "1.184", "clip": "100", "loss_scale": "8", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "175975"}
2023-02-02 23:11:44 | INFO | train_inner | {"epoch": 12, "loss": "4.062", "moe_gate_loss": "12.7758", "overflow_expert1": "0.003", "overflow_expert2": "16.265", "entropy_gating": "0.392", "expert1_balance_top": "30.793", "expert1_balance_bottom": "17.865", "unused_expert1_count": "0.486", "expert2_balance_top": "31.929", "expert2_balance_bottom": "17.278", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.878", "ppl": "14.7", "wps": "13905.3", "ups": "0.05", "wpb": "262144", "bsz": "128", "num_updates": "9710", "lr": "5.8e-07", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "182", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "176164"}
2023-02-02 23:14:35 | INFO | train_inner | {"epoch": 12, "loss": "4.03", "moe_gate_loss": "12.8084", "overflow_expert1": "0.008", "overflow_expert2": "16.679", "entropy_gating": "0.392", "expert1_balance_top": "30.981", "expert1_balance_bottom": "17.69", "unused_expert1_count": "0.486", "expert2_balance_top": "32.053", "expert2_balance_bottom": "17.16", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.845", "ppl": "14.37", "wps": "15292.5", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9720", "lr": "5.6e-07", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "176335"}
2023-02-02 23:17:26 | INFO | train_inner | {"epoch": 12, "loss": "4.026", "moe_gate_loss": "12.7796", "overflow_expert1": "0.005", "overflow_expert2": "16.279", "entropy_gating": "0.392", "expert1_balance_top": "30.807", "expert1_balance_bottom": "17.842", "unused_expert1_count": "0.48", "expert2_balance_top": "31.92", "expert2_balance_bottom": "17.27", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.842", "ppl": "14.34", "wps": "15303.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9730", "lr": "5.4e-07", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "176506"}
2023-02-02 23:20:18 | INFO | train_inner | {"epoch": 12, "loss": "4.016", "moe_gate_loss": "12.789", "overflow_expert1": "0.005", "overflow_expert2": "16.449", "entropy_gating": "0.392", "expert1_balance_top": "30.881", "expert1_balance_bottom": "17.788", "unused_expert1_count": "0.478", "expert2_balance_top": "31.978", "expert2_balance_bottom": "17.222", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.831", "ppl": "14.23", "wps": "15284", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9740", "lr": "5.2e-07", "gnorm": "1.195", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "176678"}
2023-02-02 23:23:09 | INFO | train_inner | {"epoch": 12, "loss": "4.005", "moe_gate_loss": "12.7924", "overflow_expert1": "0.004", "overflow_expert2": "16.504", "entropy_gating": "0.392", "expert1_balance_top": "30.915", "expert1_balance_bottom": "17.761", "unused_expert1_count": "0.486", "expert2_balance_top": "31.977", "expert2_balance_bottom": "17.218", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.821", "ppl": "14.13", "wps": "15294.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9750", "lr": "5e-07", "gnorm": "1.193", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "176849"}
2023-02-02 23:24:59 | INFO | valid_c4_small/C4_small | {"epoch": 12, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.4934", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.682", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.805", "valid_c4_small/C4_small_expert1_balance_bottom": "19.04", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.42", "valid_c4_small/C4_small_expert2_balance_bottom": "18.242", "valid_c4_small/C4_small_unused_expert2_count": "0.383", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.031", "valid_c4_small/C4_small_ppl": "16.35", "valid_c4_small/C4_small_wps": "52049.7", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "9750", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 23:24:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 9750 updates
2023-02-02 23:25:06 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 12 @ 9750 updates, score 4.211) (writing took 6.830440959427506 seconds)
2023-02-02 23:27:58 | INFO | train_inner | {"epoch": 12, "loss": "4.03", "moe_gate_loss": "12.7945", "overflow_expert1": "0.005", "overflow_expert2": "16.528", "entropy_gating": "0.391", "expert1_balance_top": "30.924", "expert1_balance_bottom": "17.76", "unused_expert1_count": "0.488", "expert2_balance_top": "31.999", "expert2_balance_bottom": "17.206", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.845", "ppl": "14.37", "wps": "9077.1", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "9760", "lr": "4.8e-07", "gnorm": "1.198", "clip": "100", "loss_scale": "4", "train_wall": "167", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "177138"}
2023-02-02 23:30:50 | INFO | train_inner | {"epoch": 12, "loss": "4.028", "moe_gate_loss": "12.7835", "overflow_expert1": "0.006", "overflow_expert2": "16.342", "entropy_gating": "0.392", "expert1_balance_top": "30.83", "expert1_balance_bottom": "17.831", "unused_expert1_count": "0.487", "expert2_balance_top": "31.915", "expert2_balance_bottom": "17.262", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.843", "ppl": "14.35", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9770", "lr": "4.6e-07", "gnorm": "1.192", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "177310"}
2023-02-02 23:33:41 | INFO | train_inner | {"epoch": 12, "loss": "4.044", "moe_gate_loss": "12.7735", "overflow_expert1": "0.003", "overflow_expert2": "16.221", "entropy_gating": "0.392", "expert1_balance_top": "30.784", "expert1_balance_bottom": "17.876", "unused_expert1_count": "0.485", "expert2_balance_top": "31.896", "expert2_balance_bottom": "17.295", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.86", "ppl": "14.52", "wps": "15286.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9780", "lr": "4.4e-07", "gnorm": "1.199", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "177481"}
2023-02-02 23:36:33 | INFO | train_inner | {"epoch": 12, "loss": "4.042", "moe_gate_loss": "12.7734", "overflow_expert1": "0.005", "overflow_expert2": "16.207", "entropy_gating": "0.392", "expert1_balance_top": "30.757", "expert1_balance_bottom": "17.881", "unused_expert1_count": "0.49", "expert2_balance_top": "31.908", "expert2_balance_bottom": "17.293", "unused_expert2_count": "0.452", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.858", "ppl": "14.5", "wps": "15293.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9790", "lr": "4.2e-07", "gnorm": "1.177", "clip": "100", "loss_scale": "4", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "177652"}
2023-02-02 23:39:39 | INFO | valid_c4_small/C4_small | {"epoch": 12, "valid_c4_small/C4_small_loss": "4.211", "valid_c4_small/C4_small_moe_gate_loss": "12.4918", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.663", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.794", "valid_c4_small/C4_small_expert1_balance_bottom": "19.045", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.409", "valid_c4_small/C4_small_expert2_balance_bottom": "18.247", "valid_c4_small/C4_small_unused_expert2_count": "0.384", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.031", "valid_c4_small/C4_small_ppl": "16.35", "valid_c4_small/C4_small_wps": "52046.1", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "9794", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-02 23:39:39 | INFO | fairseq_cli.train | end of epoch 12 (average epoch stats below)
2023-02-02 23:39:39 | INFO | train | {"epoch": 12, "train_loss": "4.01", "train_moe_gate_loss": "12.7861", "train_overflow_expert1": "0.005", "train_overflow_expert2": "16.415", "train_entropy_gating": "0.392", "train_expert1_balance_top": "30.858", "train_expert1_balance_bottom": "17.796", "train_unused_expert1_count": "0.486", "train_expert2_balance_top": "31.97", "train_expert2_balance_bottom": "17.233", "train_unused_expert2_count": "0.448", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.826", "train_ppl": "14.18", "train_wps": "14638.1", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "9794", "train_lr": "4.12e-07", "train_gnorm": "1.201", "train_clip": "100", "train_loss_scale": "2", "train_train_wall": "13575", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "177839"}
2023-02-02 23:39:39 | INFO | fairseq.trainer | begin training epoch 13
2023-02-02 23:41:21 | INFO | train_inner | {"epoch": 13, "loss": "4.041", "moe_gate_loss": "12.7804", "overflow_expert1": "0.006", "overflow_expert2": "16.305", "entropy_gating": "0.392", "expert1_balance_top": "30.806", "expert1_balance_bottom": "17.844", "unused_expert1_count": "0.487", "expert2_balance_top": "31.959", "expert2_balance_bottom": "17.26", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.856", "ppl": "14.48", "wps": "9073.1", "ups": "0.03", "wpb": "262144", "bsz": "128", "num_updates": "9800", "lr": "4e-07", "gnorm": "1.189", "clip": "100", "loss_scale": "2", "train_wall": "174", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "177941"}
2023-02-02 23:44:13 | INFO | train_inner | {"epoch": 13, "loss": "4.05", "moe_gate_loss": "12.7785", "overflow_expert1": "0.007", "overflow_expert2": "16.292", "entropy_gating": "0.392", "expert1_balance_top": "30.803", "expert1_balance_bottom": "17.849", "unused_expert1_count": "0.488", "expert2_balance_top": "31.941", "expert2_balance_bottom": "17.269", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.866", "ppl": "14.58", "wps": "15301.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9810", "lr": "3.8e-07", "gnorm": "1.191", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "178113"}
2023-02-02 23:47:04 | INFO | train_inner | {"epoch": 13, "loss": "3.98", "moe_gate_loss": "12.7747", "overflow_expert1": "0.005", "overflow_expert2": "16.284", "entropy_gating": "0.392", "expert1_balance_top": "30.773", "expert1_balance_bottom": "17.856", "unused_expert1_count": "0.485", "expert2_balance_top": "31.933", "expert2_balance_bottom": "17.265", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.796", "ppl": "13.89", "wps": "15294", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9820", "lr": "3.6e-07", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "178284"}
2023-02-02 23:49:56 | INFO | train_inner | {"epoch": 13, "loss": "3.982", "moe_gate_loss": "12.7791", "overflow_expert1": "0.005", "overflow_expert2": "16.354", "entropy_gating": "0.392", "expert1_balance_top": "30.801", "expert1_balance_bottom": "17.837", "unused_expert1_count": "0.49", "expert2_balance_top": "31.967", "expert2_balance_bottom": "17.254", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.798", "ppl": "13.91", "wps": "15290.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9830", "lr": "3.4e-07", "gnorm": "1.22", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "178456"}
2023-02-02 23:52:47 | INFO | train_inner | {"epoch": 13, "loss": "3.997", "moe_gate_loss": "12.7784", "overflow_expert1": "0.004", "overflow_expert2": "16.366", "entropy_gating": "0.392", "expert1_balance_top": "30.811", "expert1_balance_bottom": "17.839", "unused_expert1_count": "0.489", "expert2_balance_top": "31.981", "expert2_balance_bottom": "17.242", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.813", "ppl": "14.05", "wps": "15290", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9840", "lr": "3.2e-07", "gnorm": "1.207", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "178627"}
2023-02-02 23:55:38 | INFO | train_inner | {"epoch": 13, "loss": "3.937", "moe_gate_loss": "12.7855", "overflow_expert1": "0.005", "overflow_expert2": "16.509", "entropy_gating": "0.392", "expert1_balance_top": "30.86", "expert1_balance_bottom": "17.805", "unused_expert1_count": "0.487", "expert2_balance_top": "32.04", "expert2_balance_bottom": "17.21", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.753", "ppl": "13.48", "wps": "15294.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9850", "lr": "3e-07", "gnorm": "1.19", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "178798"}
2023-02-02 23:58:30 | INFO | train_inner | {"epoch": 13, "loss": "3.952", "moe_gate_loss": "12.7768", "overflow_expert1": "0.004", "overflow_expert2": "16.395", "entropy_gating": "0.392", "expert1_balance_top": "30.784", "expert1_balance_bottom": "17.84", "unused_expert1_count": "0.488", "expert2_balance_top": "31.999", "expert2_balance_bottom": "17.234", "unused_expert2_count": "0.44", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.768", "ppl": "13.62", "wps": "15296.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9860", "lr": "2.8e-07", "gnorm": "1.197", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "178970"}
2023-02-03 00:01:21 | INFO | train_inner | {"epoch": 13, "loss": "4.021", "moe_gate_loss": "12.7819", "overflow_expert1": "0.002", "overflow_expert2": "16.429", "entropy_gating": "0.392", "expert1_balance_top": "30.815", "expert1_balance_bottom": "17.82", "unused_expert1_count": "0.485", "expert2_balance_top": "32.006", "expert2_balance_bottom": "17.223", "unused_expert2_count": "0.442", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.836", "ppl": "14.28", "wps": "15296.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9870", "lr": "2.6e-07", "gnorm": "1.191", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "179141"}
2023-02-03 00:04:13 | INFO | train_inner | {"epoch": 13, "loss": "3.983", "moe_gate_loss": "12.7795", "overflow_expert1": "0.004", "overflow_expert2": "16.392", "entropy_gating": "0.392", "expert1_balance_top": "30.803", "expert1_balance_bottom": "17.835", "unused_expert1_count": "0.488", "expert2_balance_top": "31.984", "expert2_balance_bottom": "17.226", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.799", "ppl": "13.92", "wps": "15300.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9880", "lr": "2.4e-07", "gnorm": "1.198", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "179312"}
2023-02-03 00:07:04 | INFO | train_inner | {"epoch": 13, "loss": "4.004", "moe_gate_loss": "12.7729", "overflow_expert1": "0.002", "overflow_expert2": "16.315", "entropy_gating": "0.392", "expert1_balance_top": "30.756", "expert1_balance_bottom": "17.858", "unused_expert1_count": "0.483", "expert2_balance_top": "31.966", "expert2_balance_bottom": "17.24", "unused_expert2_count": "0.446", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.82", "ppl": "14.12", "wps": "15294.4", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9890", "lr": "2.2e-07", "gnorm": "1.194", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "179484"}
2023-02-03 00:09:55 | INFO | train_inner | {"epoch": 13, "loss": "3.97", "moe_gate_loss": "12.7821", "overflow_expert1": "0.004", "overflow_expert2": "16.409", "entropy_gating": "0.392", "expert1_balance_top": "30.833", "expert1_balance_bottom": "17.825", "unused_expert1_count": "0.488", "expert2_balance_top": "31.977", "expert2_balance_bottom": "17.237", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.785", "ppl": "13.79", "wps": "15284.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9900", "lr": "2e-07", "gnorm": "1.182", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "179655"}
2023-02-03 00:12:47 | INFO | train_inner | {"epoch": 13, "loss": "3.986", "moe_gate_loss": "12.785", "overflow_expert1": "0.006", "overflow_expert2": "16.496", "entropy_gating": "0.392", "expert1_balance_top": "30.835", "expert1_balance_bottom": "17.8", "unused_expert1_count": "0.489", "expert2_balance_top": "32.053", "expert2_balance_bottom": "17.191", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.802", "ppl": "13.95", "wps": "15293.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9910", "lr": "1.8e-07", "gnorm": "1.209", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "179827"}
2023-02-03 00:15:38 | INFO | train_inner | {"epoch": 13, "loss": "4", "moe_gate_loss": "12.7745", "overflow_expert1": "0.002", "overflow_expert2": "16.35", "entropy_gating": "0.392", "expert1_balance_top": "30.775", "expert1_balance_bottom": "17.853", "unused_expert1_count": "0.488", "expert2_balance_top": "31.955", "expert2_balance_bottom": "17.24", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.816", "ppl": "14.08", "wps": "15289.6", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9920", "lr": "1.6e-07", "gnorm": "1.191", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "179998"}
2023-02-03 00:18:30 | INFO | train_inner | {"epoch": 13, "loss": "3.969", "moe_gate_loss": "12.7955", "overflow_expert1": "0.004", "overflow_expert2": "16.57", "entropy_gating": "0.392", "expert1_balance_top": "30.942", "expert1_balance_bottom": "17.74", "unused_expert1_count": "0.489", "expert2_balance_top": "32.037", "expert2_balance_bottom": "17.204", "unused_expert2_count": "0.454", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.785", "ppl": "13.78", "wps": "15300.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9930", "lr": "1.4e-07", "gnorm": "1.206", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "180170"}
2023-02-03 00:21:21 | INFO | train_inner | {"epoch": 13, "loss": "4.021", "moe_gate_loss": "12.7769", "overflow_expert1": "0.006", "overflow_expert2": "16.313", "entropy_gating": "0.392", "expert1_balance_top": "30.79", "expert1_balance_bottom": "17.849", "unused_expert1_count": "0.486", "expert2_balance_top": "31.939", "expert2_balance_bottom": "17.253", "unused_expert2_count": "0.444", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.837", "ppl": "14.29", "wps": "15288.9", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9940", "lr": "1.2e-07", "gnorm": "1.183", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "180341"}
2023-02-03 00:24:13 | INFO | train_inner | {"epoch": 13, "loss": "4.024", "moe_gate_loss": "12.7855", "overflow_expert1": "0.006", "overflow_expert2": "16.462", "entropy_gating": "0.392", "expert1_balance_top": "30.837", "expert1_balance_bottom": "17.802", "unused_expert1_count": "0.487", "expert2_balance_top": "32.008", "expert2_balance_bottom": "17.206", "unused_expert2_count": "0.447", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.84", "ppl": "14.32", "wps": "15286.8", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9950", "lr": "1e-07", "gnorm": "1.193", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "180512"}
2023-02-03 00:27:04 | INFO | train_inner | {"epoch": 13, "loss": "4.011", "moe_gate_loss": "12.7895", "overflow_expert1": "0.006", "overflow_expert2": "16.486", "entropy_gating": "0.392", "expert1_balance_top": "30.866", "expert1_balance_bottom": "17.778", "unused_expert1_count": "0.487", "expert2_balance_top": "31.988", "expert2_balance_bottom": "17.221", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.826", "ppl": "14.18", "wps": "15289.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9960", "lr": "8e-08", "gnorm": "1.216", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "180684"}
2023-02-03 00:29:55 | INFO | train_inner | {"epoch": 13, "loss": "4.036", "moe_gate_loss": "12.807", "overflow_expert1": "0.006", "overflow_expert2": "16.7", "entropy_gating": "0.392", "expert1_balance_top": "31.001", "expert1_balance_bottom": "17.678", "unused_expert1_count": "0.489", "expert2_balance_top": "32.072", "expert2_balance_bottom": "17.157", "unused_expert2_count": "0.445", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.851", "ppl": "14.43", "wps": "15296", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9970", "lr": "6e-08", "gnorm": "1.214", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "180855"}
2023-02-03 00:32:47 | INFO | train_inner | {"epoch": 13, "loss": "4.002", "moe_gate_loss": "12.7866", "overflow_expert1": "0.004", "overflow_expert2": "16.462", "entropy_gating": "0.392", "expert1_balance_top": "30.857", "expert1_balance_bottom": "17.804", "unused_expert1_count": "0.485", "expert2_balance_top": "32.015", "expert2_balance_bottom": "17.217", "unused_expert2_count": "0.45", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.817", "ppl": "14.1", "wps": "15290.3", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9980", "lr": "4e-08", "gnorm": "1.2", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "181027"}
2023-02-03 00:35:38 | INFO | train_inner | {"epoch": 13, "loss": "3.999", "moe_gate_loss": "12.776", "overflow_expert1": "0.003", "overflow_expert2": "16.385", "entropy_gating": "0.392", "expert1_balance_top": "30.782", "expert1_balance_bottom": "17.848", "unused_expert1_count": "0.486", "expert2_balance_top": "31.973", "expert2_balance_bottom": "17.235", "unused_expert2_count": "0.439", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.814", "ppl": "14.07", "wps": "15284.1", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "9990", "lr": "2e-08", "gnorm": "1.184", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "181198"}
2023-02-03 00:38:30 | INFO | train_inner | {"epoch": 13, "loss": "3.945", "moe_gate_loss": "12.7969", "overflow_expert1": "0.004", "overflow_expert2": "16.619", "entropy_gating": "0.392", "expert1_balance_top": "30.934", "expert1_balance_bottom": "17.731", "unused_expert1_count": "0.489", "expert2_balance_top": "32.048", "expert2_balance_bottom": "17.182", "unused_expert2_count": "0.448", "all_to_all_cpu_time_ms": "0", "all_to_all_cuda_time_ms": "0", "inner_loss": "3.76", "ppl": "13.55", "wps": "15295.7", "ups": "0.06", "wpb": "262144", "bsz": "128", "num_updates": "10000", "lr": "0", "gnorm": "1.196", "clip": "100", "loss_scale": "2", "train_wall": "166", "cuda_gb_allocated": "8.7", "cuda_gb_reserved": "21.6", "cuda_gb_free": "15", "wall": "181370"}
2023-02-03 00:40:19 | INFO | valid_c4_small/C4_small | {"epoch": 13, "valid_c4_small/C4_small_loss": "4.212", "valid_c4_small/C4_small_moe_gate_loss": "12.4887", "valid_c4_small/C4_small_overflow_expert1": "0", "valid_c4_small/C4_small_overflow_expert2": "11.712", "valid_c4_small/C4_small_entropy_gating": "0.421", "valid_c4_small/C4_small_expert1_balance_top": "30.74", "valid_c4_small/C4_small_expert1_balance_bottom": "19.065", "valid_c4_small/C4_small_unused_expert1_count": "0.453", "valid_c4_small/C4_small_expert2_balance_top": "31.454", "valid_c4_small/C4_small_expert2_balance_bottom": "18.22", "valid_c4_small/C4_small_unused_expert2_count": "0.383", "valid_c4_small/C4_small_all_to_all_cpu_time_ms": "0", "valid_c4_small/C4_small_all_to_all_cuda_time_ms": "0", "valid_c4_small/C4_small_inner_loss": "4.032", "valid_c4_small/C4_small_ppl": "16.36", "valid_c4_small/C4_small_wps": "52114", "valid_c4_small/C4_small_wpb": "257832", "valid_c4_small/C4_small_bsz": "125.9", "valid_c4_small/C4_small_num_updates": "10000", "valid_c4_small/C4_small_best_loss": "4.207"}
2023-02-03 00:40:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 10000 updates
2023-02-03 00:40:26 | INFO | fairseq.checkpoint_utils | Saved checkpoint /gscratch/zlab/sg01/opt_ft/moe/moe/finetune.moe.c4.nexperts_16.init_opt.mu10000.wu0.bsz2.uf4.wd0.1.fp16adam.rs1234.lr2e-05.pat_10000.ngpu16/checkpoint_last-rank-0-shard0.pt (epoch 13 @ 10000 updates, score 4.212) (writing took 6.785431508440524 seconds)
2023-02-03 00:40:26 | INFO | fairseq_cli.train | end of epoch 13 (average epoch stats below)
2023-02-03 00:40:26 | INFO | train | {"epoch": 13, "train_loss": "3.995", "train_moe_gate_loss": "12.7831", "train_overflow_expert1": "0.004", "train_overflow_expert2": "16.426", "train_entropy_gating": "0.392", "train_expert1_balance_top": "30.833", "train_expert1_balance_bottom": "17.813", "train_unused_expert1_count": "0.487", "train_expert2_balance_top": "31.993", "train_expert2_balance_bottom": "17.227", "train_unused_expert2_count": "0.447", "train_all_to_all_cpu_time_ms": "0", "train_all_to_all_cuda_time_ms": "0", "train_inner_loss": "3.81", "train_ppl": "14.03", "train_wps": "14805.9", "train_ups": "0.06", "train_wpb": "262144", "train_bsz": "128", "train_num_updates": "10000", "train_lr": "0", "train_gnorm": "1.198", "train_clip": "100", "train_loss_scale": "2", "train_train_wall": "3414", "train_cuda_gb_allocated": "8.7", "train_cuda_gb_reserved": "21.6", "train_cuda_gb_free": "15", "train_wall": "181486"}
